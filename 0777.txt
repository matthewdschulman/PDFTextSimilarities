Impedance Control of VToL UA Vs with a Momentum-based
External Generalized Forces Estimator
Fabio Ruggiero
1
, Jonathan Cacace
1
, Hamid Sadeghian
2
, and Vincenzo Lippiello
1
AbstractÑ An estimator of external generalized forces (force
plus moments) acting on aerial platforms, and based on the
momentum of the mechanical system, is proposed for the
control of VToL UA Vs together with a hierarchical architec-
ture separating the translational and rotational dynamics of
the vehicle. The closed-loop system equations are shaped as
mechanical impedances, programmable through the controller
gains, and forced by the residuals given by the estimation
error. This arrangement allows the VToL UA Vs to perform
hovering and tracking tasks without a precise knowledge of
the vehicle dynamics and in presence of external disturbances
and unmodeled aerodynamic effects. Experiments are presented
to evaluate the performance of the proposed control design.
I. INTRODUCTION
The use of Vertical Take-Off and Landing (VToL) Un-
manned Aerial Vehicles (UA Vs) is growing day by day
as well as the interest of the robotic research community
towards such systems. These platforms are extensively em-
ployed in ÒpassiveÓ applications like inspection [1], [2],
surveillance, monitoring, remote sensing, and many others.
More recently, the UA Vs have been also employed in ÒactiveÓ
tasks like grasping [3] and manipulation [4], [5], [6], [7].
In both the aforementioned cases, high performance is
requested to control such aerial vehicles. A number of differ-
ent approaches tackle the issues related to the stabilization
and tracking of desired trajectories with the use of UA Vs.
Namely, backstepping [8], optical ßow [9], vision [10], port-
Hamiltonian [11], and several others. However, a hierarchical
architecture [12], [13] is often taken into account since it
is possible to highlight a time-scale separation between the
linear (slow time-scale) and rotational (fast time-scale) dy-
namics of the aerial vehicle. Several of the above mentioned
controllers implement an integral action to resist against
external disturbances, e.g., wind, unmodeled aerodynamic
effects, and so on. Recently, adaptive controls have been
employed to counteract such external disturbances [14],
[15], [16]. Finally, impedance control represents an effective
The research leading to these results has been supported by the ARCAS
and SHERPA collaborative projects, which both have received funding
from the European Community Seventh Framework Programme (FP7/2007-
2013) under grant agreements ICT-287617 and ICT-600958, respectively.
The authors are solely responsible for its content. It does not represent the
opinion of the European Community and the Community is not responsible
for any use that might be made of the information contained therein.
1
Fabio Ruggiero, Jonathan Cacace and Vincenzo Lippiello are with
the PRISMA Lab, Dipartimento di Ingegneria Elettrica e Tecnologie
dellÕInformazione, Universit` a degli Studi di Napoli Federico II, via Clau-
dio 21, 80125, Naples, Italy.
2
Hamid Sadeghian is with the Department of Biomedical Engineering,
Faculty of Engineering, University of Isfahan, Isfahan 8174673441, Iran.
Corresponding authorÕs email fabio.ruggiero@unina.it
approach to control actively the compliance of a robotic
system. However, it is usually necessary to have an esti-
mation of external interaction on the system. To this end,
suitable observers have been proposed to estimate collision
forces [17], [18].
In this paper, starting from the hierarchical architec-
ture presented in [13], a controller ensuring a closed-loop
impedance behaviour for both the translational and rotational
parts of a VToL UA V is proposed. In detail, the linear and
angular tracking errors act like mass-spring-damper mechan-
ical systems, in which the spring and damper coefÞcients are
imposed through the choice of PD based controllers gains.
The collision identiÞcation technique (based on the system
momentum) proposed in [17] has been suitably modiÞed and
adapted as an estimator of external generalized forces (forces
plus moments) acting on the aerial vehicle. The residual error
between the estimated external generalized forces and the
real ones is the forcing action of the closed-loop mass-spring-
damper systems. Several experiments have been performed
to prove the performance of the proposed controller design.
One among the beneÞts of the proposed controller is the
small number of parameters that have to be tuned: no integral
action is present and the gains of the estimator can be chosen
on the basis of closed-loop impedance behaviour. Moreover,
as it will be explained in the next sections, the estimator
perfectly recovers constant external disturbances, while it
recovers the time-varying ones on the basis of the chosen
closed-loop bandwidth of the impedance. As a drawback, in
case the frequency of the controller is too slow with respect
to the one of the external disturbances, the compensation of
the external generalized forces can worsen the performance
of the control design. Nevertheless, as underlined in [19],
even the use of adaptive or integral control actions may add
a further disturbance instead of reduce it.
The outline of the paper is as follows. In the next
section the modeling of the quadrotor is brießy revised.
Section III introduces the momentum-based estimator of
external generalized forces, while Section IV describes the
proposed controller. A sketch of the stability proof is given
in Section V, while Section VI provides experimental results.
Conclusion and future work are Þnally illustrated.
II. MODELING
Without loss of generality, the remainder of the paper takes
into account one of the most popular conÞguration of VToL
UA Vs, i.e., a quadrotor, which is a platform equipped with
four propellers aligned in the same direction and placed
either in cross or in plus conÞguration. The quadrotor is
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2093
x
y
z
O
x
b
y
b
z
b
O
b
Fig. 1. Quadrotor and related frames.
an underactuated mechanical system having six degrees of
freedom but only four control inputs.
Let ?
i
,O?x,y,z and ?
b
,O
b
?x
b
,y
b
,z
b
be the world-
Þxed inertia reference frame and the body-Þxed frame placed
at the UA V center of mass, respectively (see Fig. 1). The
absolute position of the UA V with respect to ?
i
is denoted
by p
b
=

x y z

T
, while the attitude is denoted by
the rotation matrix R
b
(?
b
) ? SO(3), i.e., the rotation of
?
b
with respect to ?
i
, which is also described through a
minimal representation by the roll-pitch-yaw Euler angles
?
b
=

? ? ?

T
. Let ú p
b
and ?
b
denote the linear and
angular velocities, respectively, with respect to ?
i
, while ú p
b
b
and?
b
b
are expressed with respect to ?
b
. Denoting with ú ?
b
the time derivative of?
b
, the following equations hold [20]
ú p
b
=R
b
(?
b
)ú p
b
b
, (1a)
?
b
=T
b
(?
b
)ú ?
b
, (1b)
?
b
b
=R
b
(?
b
)
T
?
b
=R
b
(?
b
)
T
T
b
(?
b
)ú ?
b
=Q(?
b
)ú ?
b
, (1c)
whereT
b
(?
b
) is the (3?3) transformation matrix between
the time derivative of ?
b
and the correspondent ?
b
, while
Q(?
b
) = R
b
(?
b
)
T
T
b
(?
b
) maps the time derivative of ?
b
into the UA V angular velocity expressed with respect to ?
b
.
The detailed expressions of R
b
(?
b
) and Q(?
b
) are given
in [13], [20] and they present a singularity at ? =±¹/2.
The dynamic equations of the UA V can be obtained by
using the Newton-Euler formulation [13]
m¬ p
b
b
+mS(?
b
b
)ú p
b
b
?mR
b
(?
b
)
T
g =f
b
b
, (2a)
I
b
ú ?
b
b
+S(?
b
b
)I
b
?
b
b
=?
b
b
, (2b)
where ¬ p
b
b
is the absolute linear acceleration of the UA V
expressed with respect to?
b
,m is the mass of the vehicle,I
b
is the (3?3) constant inertia matrix of the UA V expressed
with respect to ?
b
, ú ?
b
b
is the angular acceleration of the
UA V expressed with respect to ?
b
, S(á) denotes the skew-
symmetric matrix operator [20],g is the (3?1) gravity vector
g =

0 0 g

T
, withg = 9.81m/s
2
, andf
b
b
and?
b
b
are the
(3?1) force and torque input vectors, respectively, expressed
with respect to ?
b
.
Folding (1) and the relative time derivatives into (2) yields
the following dynamic model
m¬ p
b
?mg =R
b
(?
b
)f
b
b
, (3a)
M(?
b
)¬ ?
b
+C(?
b
, ú ?
b
)ú ?
b
=Q(?
b
)
T
?
b
b
, (3b)
where M(?
b
) = Q(?
b
)
T
I
b
Q(?
b
) is the (3? 3) positive
deÞnite inertia matrix (provided that ? 6= ±¹/2), and
C(?
b
, ú ?
b
) =Q
T
S(Qú ?
b
)I
b
Q+Q
T
I
b
ú
Q is the (3?3) Cori-
olis matrix, in which the dependencies have been dropped
and
ú
Q(?
b
) represents the time derivative of Q(?
b
).
On the basis of the particular conÞguration of the con-
sidered VToL UA V , the expressions of the input forces,f
b
b
,
and torques,?
b
b
, are different. Considering a quadrotor, this
can be characterized by ?
b
b
=

?
?
?
?
?
?

T
and f
b
b
=

0 0 u

T
, where u denotes the total thrust perpendicular
to the propellers rotation plane. The relationship between
the thrust, the control torques and the forces f
i
, with i =
1,...,4, generated by each of the four propellers is [21]
u =
4
X
i=1
f
i
, (4a)
?
?
=l(f
2
?f
4
), (4b)
?
?
=l(f
3
?f
1
), (4c)
?
?
=cf
1
?cf
2
+cf
3
?cf
4
, (4d)
where l is the distance from the propollers to the center of
mass of the quadrotor and c > 0 is the drag factor. Many
aerodynamic effects are neglected through this representa-
tion, which is instead considered a good approximation in
case of hovering or low-speed motion [13].
External forces,f
ext
, and moments,?
ext
, might act on the
VToL UA Vs during the execution of a task. Such external
generalized forces may represent unmodeled aerodynamic
effects, imbalances caused by batteries and/or on-board sen-
sors, motion of a robotic arm placed for aerial manipulation
actions, interactions with the environment, wind and so on.
Hence, for control design purposes, the following dynamic
model is considered
m¬ p
b
?mg =?uR
b
(?
b
)e
3
+f
ext
, (5a)
M(?
b
)¬ ?
b
+C(?
b
, ú ?
b
)ú ?
b
=Q(?
b
)
T
?
b
b
+?
ext
, (5b)
wheree
3
=

0 0 1

T
and bothf
ext
and?
ext
are (3?1)
vectors.
III. MOMENTUM-BASED EXTERNAL GENERALIZED
FORCES ESTIMATOR
Along the lines of the approach described in [17], the
(6? 1) generalized momentum vector of the system (5) is
deÞned as
q =

mI
3
O
3
O
3
M(?
b
)

ú p
b
ú ?
b

, (6)
where I
n
and O
n
are (n?n) identity and zero matrices,
respectively. From the properties of mechanical systems [20],
it is possible to prove that
ú
M(?
b
, ú ?
b
) =C(?
b
, ú ?
b
)+C(?
b
, ú ?
b
)
T
. (7)
Using (5) and (7), the time derivative of the generalized
momentum vector (6) is
ú q =

?uR
b
(?
b
)e
3
+f
ext
+mg
Q(?
b
)
T
?
b
b
+?
ext
+C(?
b
, ú ?
b
)
T
ú ?
b

. (8)
The purpose of the proposed estimator is to achieve, in the
Laplace domain, a linear relationship between the dynamics
2094
of the estimated external generalized forces and the real ones.
Hence, the following relationship can be written

b
f
ext
(s)
b ?
ext
(s)

=G(s)

f
ext
(s)
?
ext
(s)

, (9)
where
b
f
ext
and b ?
ext
are the (3? 1) vectors of estimated
external forces and moments, respectively, while G(s) is a
(6?6) diagonal matrix of transfer functions in which theith
element, with i = 1,...,6, has the following expression
G
i
(s) =
?
2
n,i
s
2
+2?
i
?
n,1
s+?
2
n,i
, (10)
with w
n,i
and?
i
the desired natural frequency and damping
factor of the system, respectively.
In order to get (10) component-wise in (9), the external
generalized forces (in the time domain) has to be estimated
as follows

b
f
ext
b ?
ext

=r(t) =K
1
Z
t
o
?r(t)+K
2

q(t)
?
Z
t
0

?uR
b
(?
b
)e
3
+mg
Q(?
b
)
T
?
b
b
+C(?
b
, ú ?
b
)
T
ú ?
b

+r(t)

ds

ds

,
(11)
where it is assumed that q(0) = r(0) = ú r(0) = 0, while
K
1
= diag{K
1,1
,K
1,2
} and K
2
= diag{K
2,1
K
2,2
} are
(6? 6) positive deÞnite diagonal matrices, in which K
i,j
,
i,j ={1,2}, is a (3?3) positive deÞnite diagonal matrix.
Considering (5) and (8), the dynamics of (11) is
¬ r+K
1
ú r+K
1
K
2
r =K
1
K
2

f
ext
?
ext

, (12)
that in Laplace domain is equivalent to (10).
The natural frequencies and the damping factors in (10)
can be chosen on the basis of the bandwidth of the closed-
loop equations as explained in the next section. Once they
have been designed, the components of the matricesK
1
and
K
2
in (11) can be retrieved as follows
k
1,i
k
2,i
=?
2
n,i
, (13a)
k
1,i
= 2?
i
?
n,i
, (13b)
where i = 1,...,6, and k
1,i
and k
2,i
are the ith element of
K
1
andK
2
, respectively. In ideal case, notice that
?
i
? 1
?
n,i
?°
=?r(t) =

b
f
ext
b ?
ext

Å

f
ext
?
ext

,
with i = 1,...,6, which means that the gains should be
taken as large as possible in the practice. However, they have
to take also into account the limitation given by the digital
implementation of the controller. Hence, a good compromise
has to be reached.
The quantities required to estimate the external generalized
forces are the UA V attitude?
b
and the related time derivative
ú ?
b
, the vehicle linear velocity ú p
b
, the commanded input
torque ?
b
b
and thrust u, the (nominal) knowledge about the
UA V inertia matrix I
b
and mass m. ?
b
and ú ?
b
can be
obtained by the on-board IMU sensor, while ú p
b
can be
estimated by employing vision and/or GPS data in outdoor
scenarios, while an external visual tracking system can be
employed in indoor tasks. The total thrust u and the input
torque?
b
b
are given by the controller (see Section IV).
It is worth noticing that no inversion of the inertia matrix
M(?
b
) is required, and also no knowledge of the absolute
positionp
b
of the UA V is needed. The dynamic parameters
of the system might also not be known exactly a-priori, since
it will turn out to be as the appearance of external generalized
forces due to unmodeled effects. Moreover, notice that, with
respect to [17], second-order transfer functions have been
considered. In this way, it is possible to better weaken the
effects of high-frequencies noise, specially introduced by the
IMU sensor and the estimation of ú p
b
. Finally, notice that with
small modiÞcations to (11), it is possible to obtain transfer
functions in (9) of the desired order.
From (12) it is possible to recognize that the estimator is
able to perfectly reconstruct external disturbances, while the
reconstruction of time-varying external disturbances depends
on the chosen natural frequency and damping factor in (10).
IV. VTOL UAV IMPEDANCE CONTROL
Compensating the dynamics (5b) and introducing a new
virtual input torque, deÞned by the (3?1) vector ø ? , yields
?
b
b
=I
b
Q(?
b
)ø ? +Q(?
b
)
?T
(C(?
b
, ú ?
b
)ú ?
b
?b ?
ext
). (14)
By substituting (14) in (5b) it is possible to achieve
¬ ?
b
= ø ? +M(?
b
)
?1
e ?, (15)
where e ? =?
ext
?b ?
ext
.
Because of the under-actuation of the system, since it
could be shown that p
b
and ? are ßat outputs for the
system (5) [22], a common way to design the control is to
consider as references the desired position trajectory of the
VToL UA V , described by the (3?1) vectorsp
d
, ú p
d
and ¬ p
d
,
and the desired yaw angle trajectory, described by ?
d
,
ú
?
d
and
¬
?
d
.
A new virtual input can be deÞned by the (3?1) vector
? as follows
? =

?
1
?
2
?
3

T
=?
u
m
R
b
(?
d
)e
3
+g+
1
m
b
f
ext
, (16)
representing the desired acceleration vector with respect to
?
i
, in which the magnitude is the total thrustu produced by
the propellers, while the orientation is given by the desired
UA V attitude.?
d
=

?
d
?
d
?
d

T
is the (3?1) vector of
the UA V desired attitude.
Lete
p
=p
b
?p
d
, ú e
p
= ú p
b
?ú p
d
, ¬ e
p
= ¬ p
b
?¬ p
d
,e
?
=?
b
?
?
d
, ú e
?
= ú ?
b
? ú ?
d
and ¬ e
?
= ¬ ?
b
?¬ ?
d
be the (3?1) tracking
errors, and let
e
f = f
ext
?
b
f
ext
be the estimated external
forces error. Replacing both ?
b
= ?
d
+e
?
and f
ext
=
b
f
ext
+
e
f in (5a) and taking into account some trigonometric
relations yields
¬ p
b
=?+
u
m
?(?
d
,e
?
)+
1
m
e
f, (17)
2095
Planner
Position
impedance
controller
Thrust and
attitude
references Angular
impedance
controller
Actuation
torques
Propellers 
input
VTOL
UA V
Momentum-based
external force
estimator
Fig. 2. Block scheme of the proposed architecture.
where?(?
d
,e
?
) is a (3?1) interconnection vector depending
on the desired UA V attitude and the tracking error e
?
. The
detailed expression for?(?
d
,e
?
) can be found in [13].
Hence, in order to achieve the desired closed-loop
impedance behaviour, the virtual control inputs? and ø ? can
be chosen as follows
? = ¬ p
d
?
1
m
(D
p
ú e
p
+K
p
e
p
), (18a)
ø ? = ¬ ?
d
?M
?1
((D
o
+C(?
b
, ú ?
b
)) ú e
?
+K
o
e
?
), (18b)
where D
i
and K
i
, with i = {p,o}, are (3? 3) positive
deÞnite gain matrices. Therefeore, folding (18a) and (18b)
into (15) and (17), respectively, yields the following closed-
loop equations
m¬ e
p
+D
p
ú e
p
+K
p
e
p
=u?(?
d
,e
?
)+
e
f, (19a)
M(?
b
)¬ e
?
+(D
o
+C(?
b
, ú ?
b
)) ú e
?
+K
o
e
?
=e ?. (19b)
The right-side term in (19a) acts like an external force on
the Þrst sub-system and depends on both the UA V attitude
error and the estimated external forces error. The right-
side term in (19b) is the residual of the estimated external
moments and acts as a disturbance on the second subsystem.
Thus, the expressions in (19) establish a relationship between
the residuals of the estimation of external disturbances and
the tracking errors. This impedance is characterized by the
considered mass m and inertia M(?
b
) of the VToL UA V ,
the damping matrices D
i
and the stiffness matrices K
i
,
with i ={p,o}, which can be used to specify the dynamic
behaviour along the linear and angular directions of ?
i
.
Notice that the damping matrixD
o
only partially contributes
to the total damping of the mechanical impedance.
The gains of (19) are chosen on the basis of the desired
impedance behaviour for the closed-loop system. For exam-
ple, a high stiffness will be chosen for free-ßight trajectory-
tracking tasks, while a small one should be suitable for
interaction tasks. On the other hand, a high damping is
always required to a UA V to avoid overshooting at the target
position. Furthermore, since (19) represents a mechanical
system, this is typically able to resist external disturbances
having frequencies comparable with its bandwidth. Hence,
the tuning of (12) can be simply made by choosing a
bandwidth larger enough than that of (19), e.g. the twice.
To summarize, after computing the position tracking errors
e
p
and ú e
p
, by knowing the feed-forward acceleration ¬ p
d
, the
virtual control input ? can be computed as in (18a). The
desired total thrustu and the reference pitch and roll can be
obtained by inverting (16) as follows
u =m
q
ø ?
2
1
+ ø ?
2
2
+(ø ?
3
+g)
2
, (20a)
?
d
= sin
?1

m
ø ?
1
sin?
d
? ø ?
2
cos?
d
u

, (20b)
?
d
= tan
?1

ø ?
1
cos?
d
+ ø ?
2
sin?
d
ø ?
3
+g

, (20c)
where ø ? =

ø ?
1
ø ?
2
ø ?
3

T
= ?? (1/m)
b
f
ext
, with
b
f
ext
given by (11), while the desired yaw ?
d
is given by the
planner. A second-order low-pass digital Þlter should be
employed to reduce noise and compute both Þrst and second
derivative of?
d
, so as to get ú ?
d
and ¬ ?
d
, and hence compute
in turn the attitude tracking errors e
?
and ú e
?
. The virtual
control input ø ? can be obtained as in (18b), while the
actuation torques vector is retrieved from (14) in whichb ?
ext
is given by (11). Having at disposition both the thrust u
and the actuation torques ?
b
b
, the propellers forces f
i
, with
i = 1,...,4, can be computed by inverting (4). The block
scheme of the proposed architecture is depicted in Fig. 2.
V. SKETCH OF THE STABILITY PROOF
For brevity, only a sketch of the proof is here reported to
prove the stability of the whole control scheme, made up of
the momentum-based external generalized forces estimator
and the position/angular impedance controllers.
2096
In case of a perfect compensation of both the external
forces and moments, i.e.,
e
f =e ? =0, thene
p
= ú e
p
=e
?
=
ú e
?
= 0 is a global asymptotically stable equilibrium point
for the system (19) as shown in [13].
Otherwise, the stability proof has to take in account non-
vanishing perturbations. This could be done by considering
the stability theory of both perturbed and interconnected sys-
tems [23]. The rough idea behind these theories is that if an
exponentially stable system is perturbed by a nonvanishing,
but bounded, external disturbance, then the state variables of
the system will remain bounded during time. Some results
could be also provided for asymptotically stable systems.
First of all, in the presented case, the boundedness of
the solutions of the momentum-based estimator has to be
shown. Since it is possible to assume that the real external
disturbances are always limited, the perturbation term on
the right-side of (12) is bounded. Then the boundedness
of
b
f
ext
(t) and b ?
ext
(t) can be proved [23]. Now, a two-
steps procedure is adopted. First, the stability of (19b) is
veriÞed thanks to the perturbation theory [23] and to the
boundedness of b ?
ext
(t). However, this is the toughest part
of the proof since (19b) is a time-varying system because of
the presence of the inertia matrix depending on the actual
attitude of the VToL UA V [24]. Then, the stability of (19a)
is veriÞed considering the interconnection with the angular
closed-loop equation as done in [13]. The boundedness of
b
f
ext
(t) is taken into account in this latter part, as well. As
a result, the boundedness of solutions in (19), i.e., marginal
stability, can be guaranteed since the right-side terms in (19)
are bounded. Asymptotically stability can be obtained only
in the unconstrained directions [20].
VI. EXPERIMENTAL RESULTS
A. Set-up and Technical Details
The experiments have been performed in the PRISMA
Arena which is equipped with an OptiTrack motion-capture
system. The employed quadrotor is an ASCTECH PELI-
CAN. The controller is implemented onboard (at 100Hz) on
an ATOM CPU with UBUNTU OS and a patched RTAI
real-time kenerel. The ground station is an external PC with
UBUNTU OS and it is in charge of the WiFi communication
between the OptiTrack system and the vehicle, as well as for
the operator telemetry and human interfacing.
The estimated mass and inertia matrix of the vehicle are
1.2 Kg andI
b
= diag(3.4,3.4,4.7)10
?3
Kgm
2
, respectively.
The natural frequency and the damping factor for the
closed-loop linear impedance have been chosen as 4 rad/s
and1, respectively. Hence, the gains in (18a) have been tuned
to K
p
= 16I
3
and D
p
= 12I
3
, following the relations
in (13). Since the rotational part is faster than the linear
one, the natural frequency for the closed-loop rotational
impedance (18b) has been chosen twice the linear one. The
damping factor is again tuned to 1. The procedure described
in [24] has been adopted to tuneD
o
. Consequently, the de-
sired natural frequency and damping factor for the estimator
have been chosen as 10 rad/s and 1, respectively, for all the
components in (10).
Fig. 3. On the left, the additional load placed below the battery compart-
ment is highlighted by a red ellipse. On the right, the quadrotor in front of
the fan.
B. Case Studies
In all the considered case studies, the performance of the
proposed control design (from now on called PD+C
1
for
brevity) is compared to classical PD and PID approaches.
In detail, the PD control has been implemented without
considering the compensation of the estimated external ge-
neralized forces, i.e., b ?
ext
is not present in (14) and ø ? =?
in (20). The control gains are kept as in the PD+C case. On
the other hand, the PID control has been implemented as the
PD one with the addition of an integral action in (18). The
gain of this integral term has been set to 0.5I
3
.
Three case studies are considered in the following. Other
case studies are presented in the multimedia attachment,
showing the performance of the proposed controller in se-
veral different situations, e.g., interaction with an operator,
pendulum attached at the bottom of the vehicle, and so on.
1) Case study A: In this case study, the quadrotor per-
forms a hovering task at an altitude of 1 m with respect to
the ground. An additional load of about 0.110 Kg (about
8% of the UA V mass m) has been placed in the battery
compartment of the vehicle (see Fig. 3) but not considered
in the control.
The comparison between the PD+C, PD and PID con-
trollers is depicted in Fig. 4. The landing part is omitted.
From Fig. 4(a) it is possible to recognize that the norm
of the position error for the PD+C controller is lower than
the one obtained with the other implemented controllers. In
particular, the PD is not able to recover the error due to
the additional load placed on the quadrotor. The integral
action in the PID recovers this information with a speed
depending on the chosen gain, which in any case should be
accurately tuned so as not to compromise the stability of
the vehicle. Moreover, Fig. 4(b) shows how the oscillations
around the Þxed hovering point are reduced by using the
proposed PD+C controller. The quadrotor control inputs are
depicted in Fig. 4(d). The lines do not start from zero since
1
PD+C stands for PD control plus compensation of the estimated external
generalized forces
2097
0 10 20
0.05
0.15
0.25
0.35
[s]
[m]
(a) Position error norm.
0 10 20
0
0.1
0.2
[s]
[m/s]
(b) Linear velocity error norm.
0 10 20
0
0.05
[s]
[rad]
(c) Attitude error norm.
0 10 20
0
200
400
[s]
[rad/s] (d) Propellers angular velocity
Fig. 4. Case study A. Hovering with additional load. Performance
evaluation. From subÞgure (a) to (c) the legend is: blue, PD+C; red, PID;
black, PD. SubÞgure (d) shows the angular velocity of the propellers 1,2,3
and 4 (blue, red, black, magenta) in the PD+C case.
0 10 20
0
0.5
1
1.5
[s]
[N] (a) External forces estimation
0 10 20
?0.1
0
0.1
0.2
[s]
[Nm]
(b) External moments estimation
Fig. 5. Case study A. Hovering with additional load. Estimated external
forces and moments along (around) the axes x, y and z (blue, red, black)
employed in the PD+C case.
15 20 25
0
0.05
0.1
[s]
[m]
(a) Position error norm.
15 20 25
0
0.02
0.04
0.06
0.08
[s]
[rad]
(b) Attitude error norm.
Fig. 6. Case study B. Hovering, in front of a fan, with additional load.
Performance evaluation. The legend is: blue, PD+C; red, PID; black, PD.
the propellers are rotating at a slow velocity before the take-
off command is provided to the quadrotor. The estimated
external forces and moments are displayed in Fig. 5. The
uncertainty about the knowledge of the inertia matrix I
b
is
highlighted in the values different from zero in Fig. 5(b). The
presence of the additional load on the UA V is evidenced in
thez component of the estimated external force in Fig. 5(a).
2) Case study B: This case study is similar to the previous
one with the addition of a fan producing wind at a distance
of 0.15 m from the quadrotor (see Fig. 3).
In Fig. 6 the comparison between the PD+C, PD and PID
controllers is depicted. Only the hovering part is considered
in the related time histories. In Fig. 6(a) it is possible to
15 20 25
0
0.5
1
1.5
[s]
[N] (a) External forces estimation
15 20 25
?0.1
0
0.1
0.2
0.3
[s]
[Nm]
(b) External moments estimation
Fig. 7. Case study B. Hovering, in front of a fan, with additional load.
Estimated external forces and moments along (around) the axes x, y and z
(blue, red, black) employed in the PD+C case.
?0.5 0 0.5
0
0.5
1
[m]
[m]
(a) Circle
30 35 40
0.05
0.15
[s]
[m]
(b) Position error norm.
Fig. 8. Case study C. Circular trajectory with additional load. Performance
evaluation. In subÞgure (a) the circle in blue is the reference, the circle in
red is the one executed under the PD+C control. The legend for subÞgure
(b) is: blue, PD+C; red, PID; black, PD.
30 35 40
0
0.5
1
1.5
[s]
[N] (a) External forces estimation
30 35 40
0
1
2
3
[s]
[Nm]
(b) External moments estimation
Fig. 9. Case study C. Circular trajectory with additional load. Estimated
external forces and moments along (around) the axes x, y and z (blue, red,
black) employed in the PD+C case.
recognize that the norm of the position error for the PD+C
controller is lower than the one obtained with the other
implemented controllers. In particular, due to the persistent
external disturbance, the error can be zeroed only along
the unconstrained directions, resulting in an almost constant
position error norm during time. The estimated external
forces and moments are depicted in Fig. 7. It is still possible
to notice the estimation of the force due to the additional
load. Moreover, with respect to Fig. 5(a), it is possible to
notice a higher value of the estimated force in Fig. 7(a),
especially along the x direction due to the presence of the
wind force which is hence properly reconstructed.
3) Case study C: In this case study, the quadrotor tracks a
circle of a given radius with a constant speed of 0.5 m/s. The
circle is planned in thex,y plane at a constant altitude from
the ground and it is executed twice. Like the two previous
case studies, an additional load of about 0.110 Kg has been
placed in the battery compartment of the vehicle, but not
considered in the control. First, the quadrotor performs the
take-off reaching the hovering condition at 1 m from the
ground. Then, after a Þxed amount of time, the command
2098
to perform the tracking of the circle is given to the vehicle.
Once the trajectory has been completed, the quadrotor lands.
In the time histories of Fig. 8 only the circular trajectory is
displayed, neglecting the other phases.
In Fig. 8(a), it is possible to appreciate the tracking
performance (and the repeatability of the trajectory) of the
PD+C controller with respect to the planned circle in the
x,y plane. The comparison between the PD+C, PD and PID
controllers is provided in Fig. 8(b). Again, the norm of the
position error for the PD+C controller is lower than the
one obtained with the other implemented controllers. The
estimated external forces and moments are depicted in Fig. 9.
Due to the presence of the unbalanced added weight during
the execution of the circular trajectory, signiÞcant moments
are also estimated, as shown in Fig. 9(b).
VII. CONCLUSION AND FUTURE WORK
In this paper, a momentum-based estimator of external
generalized forces has been proposed to control a VToL UA V
together with a suitably modiÞed hierarchical architecture,
shaping the closed-loop equations as mechanical impedances
programmable through the control gains. This arrangement
allows the VToL UA V to perform hovering and tracking tasks
without a precise knowledge of the vehicle dynamics and in
presence of external disturbances. Experimental results have
been presented to prove the performance of the proposed
control design with respect to other classical controllers
employed in aerial robotics.
Future work will be focused on problems related to
outdoor scenarios. In particular, the effects of introducing an
estimated linear velocity, rather than using the one provided
by high-frequency external visual tracker, will be examined.
A detailed stability proof of the whole framework will be
provided in a future extended version of this work, taking
into account the problems related to the interconnection
between the external generalized forces estimator and the
VToL UA V hierarchical controller.
REFERENCES
[1] V . Lippiello and B. Siciliano, ÒWall inspection control of a VTOL
unmanned aerial vehicle based on a stereo optical ßow,Ó in 2012
IEEE/RSJ International Conference on Intelligent Robots ans Systems,
(Vilamoura, P), pp. 4296Ð4302, 2012.
[2] L. Marconi, L. Basile, G. Caprari, R. Carloni, P. Chiacchio,
C. Huerzeler, V . Lippiello, R. Naldi, N. Janosch, B. Siciliano,
S. Stramigioli, and E. Zwicker, ÒAerial service robotics: The AIRobots
perspective,Ó in 2nd International Conference on Applied Robotics for
the Power Industry, (Zurich, CH), 2012.
[3] P. Pounds, D. Bersak, and A. Dollar, ÒGrasping from the air: Hovering
capture and load stability,Ó in 2011 IEEE International Conference on
Robotics and Automation, (Shanghai, CN), pp. 2491Ð2498, 2011.
[4] G. Arleo, F. Caccavale, G. Muscio, and F. Pierri, ÒControl of quadrotor
aerial vehicles equipped with a robotic arm,Ó in 21st Mediterranean
Conference on Control and Automation, (Crete, GR), 2013.
[5] F. Forte, R. Naldi, A. Macchelli, and L. Marconi, ÒImpedance control
of an aerial manipulator,Ó in Proceedings of 2012 American Control
Conference, (Montreal, CDN), pp. 3839Ð3844, 2012.
[6] V . Lippiello and F. Ruggiero, ÒExploiting redundancy in Cartesian
impedance control of UA Vs equipped with a robotic arm,Ó in 2012
IEEE/RSJ International Conference on Intelligent Robots ans Systems,
(Vilamoura, P), pp. 3768Ð3773, 2012.
[7] V . Lippiello and F. Ruggiero, ÒCartesian impedance control of a UA V
with a robotic arm,Ó in 10th International IFAC Symposium on Robot
Control, (Dubrovnik, HR), pp. 704Ð709, 2012.
[8] T. Madani and A. Benallegue, ÒSliding mode observer and backstep-
ping control for a quadrotor unmanned aerial vehicles,Ó in Proceedings
of the 2007 American Control Conference, (New York City, NY),
pp. 5887Ð5892, 2007.
[9] V . Lippiello, G. Loianno, and B. Siciliano, ÒMA V indoor navigation
based on a closed-form solution for absolute scale velocity estimation
using optical ßow and inertial data,Ó in 50th IEEE Conference on
Decision Control and European Control Conference, (Orlando, FL),
pp. 3566Ð3571, 2011.
[10] R. Carloni, V . Lippiello, M. DÕAuria, M. Fumagalli, A. Mersha,
S. Stramigioli, and B. Siciliano, ÒRobot vision: Obstacle-avoidance
techniques for unmanned aerial vehicles,Ó IEEE Robotics & Automa-
tion Magazine, vol. 20, no. 4, pp. 22Ð31, 2013.
[11] R. Mahony, S. Stramigioli, and J. Trumpf, ÒVision based control of
aerial robotic vehicles using the port Hamiltonian framework,Ó in
50th IEEE Conference on Decision Control and European Control
Conference, (Orlando, FL), pp. 3526Ð3532, 2011.
[12] R. Mahony and T. Hamel, ÒRobust trajectory tracking for a scale
model autonomous helicopter,Ó International Journal of Robust and
Nonlinear Control, vol. 14, no. 12, pp. 1035Ð1059, 2004.
[13] K. Nonami, F. Kendoul, S. Suzuki, and W. Wang, Autonomous Flying
Robots. Unmanned Aerial Vehicles and Micro Aerial Vehicles. Berlin
Heidelberg, D: Springer-Verlag, 2010.
[14] A. Roberts and A. Tayebi, ÒAdaptive position tracking of VTOL
UA Vs,Ó IEEE Transactions on Robotics, vol. 27, no. 1, pp. 129Ð142,
2011.
[15] I. Palunko, P. Cruz, and R. Fierro, ÒAgile load transportation. Safe and
efÞcient load manipulation with aerial robots,Ó Robotics & Automation
Magazine, vol. 19, no. 3, pp. 69Ð79, 2012.
[16] G. Antonelli, F. Arrichiello, S. Chiaverini, and P. Robuffo Giordano,
ÒAdaptive trajectory tracking for quadrotor MA Vs in presence of
parameter uncertainties and external disturbances,Ó in Proceedings
2013 IEEE/ASME International Conference on Advanced Intelligent
Mechatronic, (Wollongong, AU), pp. 1337Ð1342, 2013.
[17] A. De Luca, A. Albu-Schaffer, S. Haddadin, and G. Hirzinger,
ÒCollision detection and safe reaction with the DLR-III lightweight
manipulator arm,Ó in IEEE/RSJ International Conference on Intelligent
Robots ans Systems, (Beijing, C), pp. 1623Ð1630, 2006.
[18] H. Sadeghian, L. Villani, M. Keshmiri, and B. Siciliano, ÒTask space
control of robot manipulators with null space compliance,Ó IEEE
Transactions on Robotics, 2013 (in press, available online).
[19] G. Antonelli, ÒOn the use of adaptive/integral actions for 6-degrees-
offreedom control of autonomous underwater vehicles,Ó IEEE Journal
of Oceanic Engineering, vol. 32, no. 2, pp. 300Ð312, 2007.
[20] B. Siciliano, L. Sciavicco, L. Villani, and G. Oriolo, Robotics: Mod-
elling, Planning and Control. London, UK: Springer, 2008.
[21] T. Madani and A. Benallegue, ÒBackstepping control for a quadro-
tor helicopter,Ó in IEEE/RSJ International Conference on Intelligent
Robots ans Systems, (Beijing, C), pp. 3255Ð3260, 2006.
[22] P. Fliess, J. Levine, and P. Rouchon, ÒFlatness and defect of nonlinear
systems: Introductory theory and examples,Ó International Journal of
Control, vol. 61, no. 6, pp. 1327Ð1361, 1995.
[23] H. Khalil, Nonlinear systems. Upper Saddle River, NJ: Prentice Hall,
2002.
[24] C. Ott, Cartesian Impedance Control of Redundant and Flexible-Joint
Robots, vol. 49 of Springer Tracts in Advanced Robotics. Berlin
Heidelberg, D: Springer-Verlag, 2008.
2099
