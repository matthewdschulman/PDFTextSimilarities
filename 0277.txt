Personal Robot Assisting Transportation to Support Active Human Life
– Reference Generation based on Model Predictive Control for Robust Quick Turning–
Noriaki Hirose
1
, Ryosuke Tajima
1
, Kazutoshi Sukigara
1
, and Minoru Tanaka
1
Abstract—Various robots are being developed to support
active human lifestyles throughout the world. In particular,
robots that can support a comfortable lifestyle for elderly
people are needed for the coming super-aging society in many
countries. The authors have already proposed the Personal
Robot (PR) shown in Fig. 1, which can follow a human
being and carry their baggage; the PR user does not need
to carry heavy bags, even after shopping. The PR, therefore,
can encourage not only elderly people but also young people
to walk outside . This means that the PR can support a life of
wellness in the true sense. In conventional research, a control
approach for the roll angle is proposed to ensure the stability
margin for steady turning because in order to follow a human
being, the PR must realize high traveling performance.
In this paper, a method of reference generation for the roll
angle and turning angular velocity is proposed to take into
account the stability margin during the transient state using
model predictive control. According to the proposed approach,
the quickest turning motion can be realized by keeping the
upper and lower boundary constraints for the zero moment
point (ZMP). The effectiveness of the proposed approach is
veriﬁed by experiment using the prototype PR.
I. INTRODUCTION
Various robots are being developed to support active
humanlifestylesthroughouttheworld[1][2][3].Inparticular,
robots that can support a comfortable life for elderly people
areneededforthecomingsuper-agingsocietyinmanycoun-
tries. However, robots that provide excessive or premature
support to elderly people may actually cause their physical
ability to decline sooner. The authors have already proposed
the Personal Robot (PR) shown in Fig. 1 [4], which can
follow a human being and carry their baggage [5]. The PR
user does not need to carry heavy bags, even after shopping.
The PR, therefore, can encourage not only elderly people but
also young people to walk outside . This means that the PR
can support a life of wellness in the true sense.
In order to follow the human being, the PR requires
a high traveling performance like that of a human being.
In addition, the footprint of the PR has to be small to
coexist in society. However, the small footprint results in
a higher center of gravity, which deteriorates the traveling
performance. Therefore, it is difﬁcult for the PR to realize
both high traveling performance and a small footprint. The
authors proposed the use an actuator to control the roll angle
(posture actuator) of the PR [4][6][7][8][9]. In conventional
research [4], the control approach for the roll angle using
1
N. Hirose, R. Tajima, and K. Sukigara are with Intelligent Systems
Lab., Information & Electronics Research Div., Toyota Central R &
D Labs., Inc., 41-1 Yokomichi Nagakute Aichi JAPAN hirose at
mosk.tytlabs.co.jp
[a] front view [b] following human being
Fig. 1. Overview of Personal Robot.
[a] turning [b] uneven ﬂoor
Fig. 2. Target behavior of PR for roll axis.
the lateral acceleration is applied to realize a appropriate
tilting posture during steady turning motion and a vertical
posture, even on an uneven road surface, as shown in Fig. 2.
And, the previous work shown in [6] proposes the feedback
compensation with the unstable pole to realize the desired
postureduringthesteadystatebyzeroingthecontrolinputof
thepostureactuator.However,theseconventionalapproaches
don’t take into account stability margin at the transient state
of the turning motion, although the desired posture in the
steady state can be achieved. Therefore, the PR loses the
stability margin and falls during the transient state, which
represents the transition from going straight ahead to steady
turning or from steady turning to going straight ahead.
In this paper, a method of reference generation for the
roll angle and turning angular velocity is proposed to take
into account the stability margin at the transient state us-
ing model predictive control [10][11][12]. Moreover, the
proposed approach also can consider the saturation of the
posture actuator torque and the suppression of discontinuity
for practical use. According to the proposed approach, the
quickest turning motion can be realized under keeping the
constraints of the upper and lower boundaries for the zero
moment point (ZMP). The effectiveness of the proposed
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2223
[a] 3D drawing sheet
[b] lateral view
Fig. 3. Structure for posture actuator.
approach is veriﬁed by experiments using the prototype PR.
II. PROTOTYPE OF PERSONAL ROBOT
In this section, the mechanical system of the PR and the
whole control system are explained before designing the
proposed approach. And, the conventional approach ignoring
the transient state is shown for the comparison.
A. Mechanical System
Figure 3 shows the mechanical structure of the PR. Fig.
3[a] is a 3D view of the drawing sheets, and [b] is a
simpliﬁed lateral-view diagram. The PR has two driving
wheels to realize stabilization of the pitch angle and the
desired traveling velocity by wheeled inverted pendulum
control [13][14]. In addition, the turning angular velocity can
be controlled by giving a difference in the rotation speed
between the right and left wheels. On the other hand, a
posture actuator with a motor and gear is used to achieve
tilting of the upper body for quick turning and a vertical
posture, even on a slope [6]. The posture actuator is driven
by the control method using the lateral acceleration for the
realization of the stable posture [4].
B. Control System
Figure 4 shows a block diagram of the proposed control
system for the prototype PR. Here, v
ref
and ?
refc
are
the references for the traveling velocity v and the turning
angularvelocity? (whicharegeneratedbytheupperprocess
Fig. 4. Block diagram of control system for PR.
for following the human being [15]), ?
ref
is the modiﬁed
referencefortheturningangularvelocitybymodelpredictive
control, and ?
ref
is the reference for the roll angle ? (which
is generated by model predictive control). In addition, “WIP
Control” is the wheeled inverted pendulum control system
(which controls the pitch angle and the traveling velocity v
to realize the desired value v
ref
), “Yaw Rate Control” is the
feedback control system (which controls the turning angular
velocity?),“Rollcontrol”isthetwo-degree-of-freedomcon-
trolsystemwithfeedbackandfeedforwardcompensation[16]
for the roll angle ? using the lateral acceleration [4], and
“MPC” is the proposed algorithm (which can generate the
modiﬁed reference ?
ref
and the appropriate reference of the
roll angle ?
ref
to keep the prescribed stability margin). In
order to take into account the stability margin in the “MPC,”
the ZMP equation should be formulated.
C. ZMP Equation of PR
Figure 5 shows a rear view of the PR model. Here, J is
the inertia of the upper body, M is the weight of the upper
body, h is the distance between the center of gravity and the
roll axis, r is the radius of the wheel, p is the position of
the center of gravity, and q is the position of the ZMP. The
following equation is the ZMP equation for the Y ¡Z axis:
¡(p
y
¡q
y
)f
z
+(p
z
¡q
z
)f
y
=J
¨? (1)
Here, p
y
, p
z
, q
z
, f
y
, and f
z
can be shown as follows:
p
y
= ¡hsin?,
p
z
= hcos?+r,
q
z
= 0,
f
y
= M(v?+h?
2
sin?¡h
¨?cos?),
f
z
= M(g¡h
¨?sin?), (2)
where g is the gravity acceleration. By substituting (2) into
(1), the ZMP trajectory q
y
for the y axis can be obtained as
follows:
q
y
= ¡
(v?+h?
2
sin?¡h
¨?cos?)(hcos?+r)
g¡h
¨?sin?
¡hsin?+
J
¨?
M(g¡h
¨?sin?)
. (3)
(3) can be simpliﬁed by substituting sin? = ?, cos? = 1,
and h
¨?sin? = 0 under the assumption that ? ¿ 1 and g À
2224
Fig. 5. Model of personal robot for roll axis.
h
¨?sin?.
q
y
= ¡
(h+r)v
g
?+
h(h+r)+
J
M
g
¨?
¡(h+
(h+r)h?
2
g
)? (4)
Intheconventionalapproachnotconsidering
¨?,thefollowing
reference ?
ref
is generated by substituting
¨? = 0, q
y
= 0,
v = v
ref
, and ? = ?
ref
into (4), only to realize the most
stable posture q
y
=0 at steady turning:
?
ref
=¡
v
ref
?
ref
h
h+r
g+h?
2
ref
(5)
Here, v
ref
and ?
ref
are used for ?
ref
in (5) instead of the
actual values v and ?. According to (5), the conventional
approach generates ?
ref
for not only steady state but also
the transient state. Therefore, the conventional approach has
problems at the transient state. For example, if ¨?
ref
has
a large value to realize quick turning during the steady
traveling velocity, a large amount of angular acceleration
¨? is occurred. It is obvious from the second derivative of
(5). As a result, the ZMP trajectory q
y
in (3) exceeds the
desired range during the transient state. It means that the PR
loses the stability margin and may fall in some situations.
In the conventional approach, the conservative reference
?
ref
to suppress ¨?
ref
has to be applied to ensure posture
stabilization. The desired quick turning, therefore, cannot be
achieved in the conventional approach.
III. REFERENCE GENERATION BY MODEL
PREDICTIVE CONTROL
In the proposed control system, model predictive control
is applied to generate the reference of the roll angle ?
ref
and the reference of the turning angular velocity ?
ref
. The
model predictive control approach can take into account the
inequality constraints for the predicted future values [10].
The ZMP trajectory q
y
, therefore, can be limited to within
upper and lower boundaries. In addition, ?
ref
can converge
Fig. 6. Block diagram for the proposed model predictive control approach.
quickly to the target value ?
refc
to realize quick turning
within the desired range of the ZMP.
Figure 6 shows a block diagram of the proposed approach,
which corresponds to the “MPC” shown in Fig. 4. In this
section, at ﬁrst, the conditions for the design of the model
predictive control are shown in III-A. Next, the mathematical
model is designed to formulate the model predictive control
in III-B, and the method of prediction and optimization for
generating ?
ref
and ?
ref
is shown in III-C.
A. Conditions for Model Predictive Control
The following factors should be considered when design-
ing the model predictive control for practical use:
i) limitation of the ZMP q
y
ii) limitation of the roll angle ?
iii) limitation of the actuator torque ?
iv) attenuation of the error between ?
refc
and ?
ref
v) suppression of the jerk j
x
around the x axis
vi) suppression of the discontinuity for the references
?
ref
and ?
ref
Theproposedapproachgivestheupperandlowerboundaries
fori),ii),andiii)asinequalityconstraints.Inaddition,i),iii),
iv), v), and vi) are taken into account by the minimization
of the evaluation function. Also, v) and vi) are required to
implement model predictive control in the experiment to
avoid unknown phenomena in the higher frequency range.
B. Predictive Model
The roll control system indicated in Fig. 4 as “Roll
Control” is designed as the following third-order system, as-
suming there are no disturbance forces and no perturbations
in the plant system:
? =
?
2
r
s
2
+2?
r
?
r
s+?
2
r
¢
?
r
s+?
r
?
ref
, (6)
where ?
r
is 2£π£2.0, and ?
r
is 0.95. Then, (6) can be
transformed into the following state space expression:
d
dt
?
?
¨?
˙
?
?
?
?
=
?
?
a
r1
a
r2
a
r3
1 0 0
0 1 0
?
?
?
?
¨?
˙
?
?
?
?
+
?
?
b
r
0
0
?
?
?
ref
, (7)
2225
wherea
r1
=¡2?
r
?
r
¡?
r
,a
r2
=¡?
2
r
¡2?
r
?
2
r
,a
r3
=¡?
3
r
,
and b
r
= ?
3
r
. (7) can be discretized by the zero-order-hold
method as follows:
x
r
[k+1] = A
r
x
r
[k]+B
r
?
ref
[k], (8)
where A
r
and B
r
are the state space matrices, and x
r
is the
following state matrix:
x
r
[k]=
[
¨?[k]
˙
?[k] ?[k]
]
T
. (9)
On the other hand, the “Yaw Rate Control” shown in Fig. 4
can realize a higher control bandwidth than the roll control
system to achieve the precise human following. Its control
system, therefore, can be approximated as a delay of one
step.
?[k]=?
ref
[k¡1] (10)
By combining (8) and (10) and adding the
¨?[k¡1] to deal
with the jerk j
x
, the following model can be generated:
?
?
x
r
[k+1]
¨?[k]
?
ref
[k]
?
?
=
?
?
A
r
0 0
A
r1
0 0
0 0 0
?
?
¢
¢
?
?
x
r
[k]
¨?[k¡1]
?
ref
[k¡1]
?
?
+
?
?
B
r
0
0 0
0 1
?
?
[
?
ref
[k]
?
ref
[k]
]
,
(11)
where A
r1
= [1 0 0]. (11) can be redeﬁned as follows to
simplify the after-mentioned formulation:
X[k+1]=AX[k]+Bu[k]. (12)
In order to take into account the ZMP trajectory q
y
for i),
the actuator torque ? for iii), the turning angular velocity ?
for iv), and the jerk j
x
for v) in the evaluation function, the
output equation can be generated as follows by (10), (26),
(28) and (29) shown in appendix:
?
?
?
?
q
y
[k]
?[k]
?[k]
j
x
[k]
?
?
?
?
=
?
?
?
?
c
1
0 c
2
0 c
3
c
4
0 c
5
0 c
6
0 0 0 0 1
1 0 0 ¡1 0
?
?
?
?
X[k], (13)
where c
1
, c
2
, c
3
, c
4
, c
5
, and c
6
can be described as follows:
c
1
=
h(h+r)+
J
M
g
,
c
2
= ¡h¡
(h+r)h?
2
ref
g
,
c
3
= ¡
(h+r)v
ref
g
,
c
4
= J +Mh
2
,
c
5
= ¡hMg¡h
2
M?
2
ref
,
c
6
= ¡hMv
ref
. (14)
(13) can then be redeﬁned as follows:
z[k]=CX[k]. (15)
On the other hand, the discrete integration
z
z?1
is added to
the control input u(k) in order to consider vi) [17] as shown
in Fig. 6. The following input ∆u[k ] is given as the control
input to the extended model with
z
z?1
.
∆u [k]=u[k]¡u[k¡1] (16)
C. Formulation of Model Predictive Control
The “prediction & optimization” shown in Fig. 6 calcu-
lates ∆u [k] by solving the following quadratic programming
problem with inequality constraints:
min
∆U [k]
V[k]=(R[k]¡Z[k])
T
Q(R[k]¡Z[k])
+∆U [k]
T
W∆ U[k], (17)
subject to q
ymin
·Q
y
[k]·q
ymax
, (18)
?
min
·T[k]·?
max
, (19)
?
min
·?
ref
[k]·?
max
, (20)
where R[k], Z[k], ∆U [k], Q
y
[k], T[k], and ?
ref
[k] are
shown as follows:
R[k] = [r(k+1jk) ... r(k+N
p
jk)]
T
,
Z[k] = [ˆ z(k+1jk) ... ˆ z(k+N
p
jk)]
T
,
∆U [k] = [∆ˆu(kjk) ... ∆ˆu(k+N
u
¡1jk)]
T
,
Q
y
[k] = [ˆ q
y
(k+1jk) ... ˆ q
y
(k+N
p
jk)]
T
,
T[k] = [ˆ ?(k+1jk) ... ˆ ?(k+N
p
jk)]
T
,
?
ref
[k] = [
ˆ
?
ref
(k+1jk) ...
ˆ
?
ref
(k+N
u
jk)]
T
,
(21)
and where N
p
is the number of steps for the prediction,
N
u
is the number of control inputs generated in each
sampling period, and r(k +ijk)(i = 1,...,N
p
) represents
the following constant vector for the reference:
r(k+1jk)=...
...=r(k+N
p
jk)=[0 0 ?
refc
[k] 0]
T
(22)
In addition,Q andW are the weight matrices,q
ymin
,q
ymax
,
?
min
, and ?
max
are the N
p
£ 1 constant matrices (which
give the upper and lower boundaries for q
y
and ?), ?
min
,
and ?
max
are the N
u
£1 constant matrices (which give the
boundary for ?
ref
) . According to the appendix, V[k] can
be transformed into the quadratic form of ∆U [k]. Also, the
inequalities shown in (18), (19), and (20) can be redeﬁned
as the linear inequalities of∆U [k]. Therefore,∆U [k], which
minimizes V[k] in (17) with the inequality constraints (18),
(19), and (20), can be calculated by solving the quadratic
programming problem [10]. As a result, the control input
∆u [k] shown in Fig. 6 can be given as follows at the k-th
step:
∆u [k]=∆ˆu(kjk). (23)
2226
[a] turning angular velocity
[b] roll angle
[c] zero moment point
[d] actuator torque
Fig. 7. Experimental results. (v
ref
= 1.667 [m/s], ?
refc
= 1.766 [rad/s])
IV. EXPERIMENTAL RESULTS
Several times of experiments are performed to verify the
effectiveness and repeatability of the proposed approach. In
the experiment, the references of the turning angular velocity
?
refc
= 1.766 rad/s and 0.588 rad/s are given to the PR
at the traveling velocity v
ref
= v = 1.667 m/s. On the
other hand, the calculation of the quadratic programming
problem is implemented into the MicroAutoBox – dSPACE
by using Matlab/Simulink to generate the ∆ u[k] at the
sampling period T
s
= 80 ms.
A. Parameters for Model Predictive Control
The weighting matrix Q is designed as follows by trial
and error to stabilize the model predictive control system:
Q =
?
?
?
?
?
Q
opt
... 0 0
.
.
.
.
.
.
.
.
.
.
.
.
0 ... Q
opt
0
0 ... 0 Q
optf
?
?
?
?
?
, (24)
[a] turning angular velocity
[b] roll angle
[c] zero moment point
[d] actuator torque
Fig. 8. Experimental results. (v
ref
= 1.667 [m/s],?
refc
= 0.5886 [rad/s])
where Q
opt
and Q
optf
are designed as follows:
Q
opt
= diag
[
10 20 0.01 30
]
,
Q
optf
= diag
[
10
5
20 0.01 30
]
. (25)
On the other hand, another weighting matrix W is designed
as the unit matrix2¢N
u
£2¢N
u
to suppress the discontinuity
of U[k]. The other free parameters for model predictive
control are listed in Table I.
B. Experimental Results
Figure 7 shows the experimental results for the turning
motion ?
refc
= 1.766 rad/s at the traveling velocity v
ref
=
1.667 m/s. The centripetal acceleration during this turning
motion corresponds to 0.3£g, which is the maximum value
for the speciﬁcation of the prototype PR. Fig. 7[a] indicates
the turning angular velocity, [b] indicates the roll angle, [c]
indicates the calculated zero moment point by (26), and
[d] indicates the actuator torque. In all of the ﬁgures, the
blue lines show the actual responses in the experiment, the
green lines show the responses in the simulation, and the
2227
horizontal broken lines show the upper and lower boundaries
fromthemodelpredictivecontrol.Inaddition,thesimulation
responses without linear approximation are shown as the
magenta lines in Fig.7[c] and [d]. In Fig. 7[a], the red
line shows the reference ?
ref
generated by the proposed
approach, and the dotted black line shows the reference
?
refc
. In Fig. 7[b], the red line shows the reference ?
ref
generated by the proposed approach.
From Fig. 7[b], [c], and [d], the roll angle, the ZMP, and
the actuator torque can be successfully limited by the desired
upper and lower boundaries in both the experiment and the
simulation. The quick turning motion can be conﬁrmed in
Fig. 7[a] under the above limitations. The reaching times to
50% and 90% of ?
refc
are 0.16 s and 0.46 s, respectively.
In addition, the suppression of the discontinuity for ?
ref
and
?
ref
are also veriﬁed from Fig. 7[a] and [b]. On the other
hand, the experimental responses approximately coincide
with the responses in the simulation, although there is a
small difference between the experiment and the simulation
caused by the perturbation of the model, the disturbance in
the experiment, and the sensor noise. And, from Fig.7[c] and
[d], the green lines with linearization coincide well with the
magentalineswithoutlinearization.Itmeansthatthevalidity
of the linear approximation approach shown in appendix A
can be proved.
Figure 8 shows the experimental results for the turning
motion ?
refc
= 0.588 rad/s at the traveling velocity v
ref
=
1.667 m/s. The centripetal acceleration during steady turning
corresponds to 0.1 £g. From Fig. 8[a], a faster response is
realized compared to that in Fig. 7[a]. The reaching times to
50% and 90% of ?
refc
are 0.13 s and 0.21 s, respectively.
Because, the ZMP and the actuator torque have some margin
againsttheupperandlowerboundaries,asshowninFig.8[c]
and[d].Figs.7and8aretheexperimentalwaveformsforone
trial. However, the repeatability of the proposed approach is
conﬁrmed by several experiments at same conditions.
Fig. 9 shows snapshots of the turning motion from Fig.
7. The PR tilts its upper body based on the reference of the
model predictive control and achieves quick turning.
C. Simulation Results for the Conventional Approach
Figure10showsthesimulationresultsfortheconventional
approach of (5) to realize the same performance of the
turning angular velocity as in Fig. 7[a]. Fig. 10 is shown
in the same manner as Fig. 7. The conventional approach
actually realizes q
y
=0 at steady turning. However, the roll
angle, the ZMP, and the actuator torque exceed the desired
boundaries indicated by the horizontal broken lines. From
the simulation, the merits of the proposed approach over the
conventional approach are clearly presented.
V. CONCLUSION
In this paper, a reference generation approach based on
model predictive control for the PR was proposed to re-
alize quick turning under the upper and lower constraints
of the ZMP and actuator torque. The proposed approach
can generate the references for the roll angle and turning
TABLE I
PARAMETERS FOR THE MODEL PREDICTIVE CONTROL.
weight of upper body M [kg] 17.76
inertia of upper body J [kg m
2
] 1.12
height of center of gravity h [m] 0.31
radius of wheel r [m] 0.10
the number of steps for prediction Np 30
the number of control input Nu 5
upper boundary of ZMP qymax [m] 0.080
lower boundary of ZMP q
ymin
[m] ?0.080
upper boundary of actuator torque ?max [Nm] 12.06
lower boundary of actuator torque ?
min
[Nm] ?12.06
upper boudary of roll reference ?max [rad] 0.24
lower boudary of roll reference ?max [rad] ?0.24
angularvelocitytokeepthedesiredstabilitymarginusingthe
inequality constraints. Moreover, model predictive control
optimizes these references to suppress discontinuity of the
references and to attenuate the error of the turning angular
velocity by minimizing the evaluation function.
The effectiveness of the proposed approach was veriﬁed
by the simulation and experiments using the prototype PR.
For future work, we propose shortening the sampling period
T
s
by the reduction in computational load for the model
predictive control and keeping the robustness for variation
of baggage mass.
APPENDIX
In order to solve (17), (18), (19), and (20) as the quadratic
programming problem, the ZMP trajectory q
y
, the actuator
torque ?, and the jerk j
x
are deﬁned as the linear equation,
V[k] is transformed into the quadratic form of ∆U [k], and
the inequalities in (18), (19), and (20) are transformed into
the linear inequality of ∆U [k], respectively [10].
A. Linearization of q
y
, ?, and j
x
The following linearized q
y
can be generated by substitut-
ing ?
2
=?
2
ref
and v =v
ref
into (4).
q
y
= ¡
(h+r)v
ref
g
?+
h(h+r)+
J
M
g
¨?
¡(h+
(h+r)h?
2
ref
g
)? (26)
Here, ?
2
and v are assumed as the steady value among the
predictive horizon N
p
steps.
On the other hand, the motion equation around the roll
axis can be expressed as follows:
(J +Mh
2
)
¨? = ? +hMgsin?
+hM(v?+?
2
hsin?)cos?. (27)
(27) can be linearized by sin ? = ?, cos ? = 1, ?
2
= ?
2
ref
and v = v
ref
. As a result, the actuator torque ? can be
expressed as follows:
? = ¡hMv
ref
?+(J +Mh
2
)
¨?
¡(hMg+h
2
M?
2
ref
)?. (28)
2228
[a] [b] [c] [d] [e]
[f] [g] [h] [i] [j]
Fig. 9. Snapshots of turning motion in experiment.
In addition, the jerk j
x
around the x axis can be shown as
follows:
j
x
=
¨?[k]¡
¨?[k¡1]. (29)
B. Transformation of V[k]
Z[k] can be given as follows:
Z[k] =
?
?
?
C ... 0
.
.
.
.
.
.
.
.
.
0 ... C
?
?
?
?
?
?
ˆ
X[k+1jk]
.
.
.
ˆ
X[k+N
p
jk]
?
?
?,
= C
p
X
p
[k], (30)
where X
p
[k] can be shown as follows:
X
p
[k]=
?
?
?
?
?
?
?
?
?
?
A
.
.
.
A
Nu
A
Nu+1
.
.
.
A
Np
?
?
?
?
?
?
?
?
?
?
X[k]+
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
B
.
.
.
Nu?1
∑
i=0
A
i
B
Nu
∑
i=0
A
i
B
.
.
.
Np?1
∑
i=0
A
i
B
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
u[k¡1]
+
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
B ... 0
AB+B ... 0
.
.
.
.
.
.
.
.
.
Nu?1
∑
i=0
A
i
B ... B
Nu
∑
i=0
A
i
B ... AB+B
.
.
.
.
.
.
.
.
.
Np?1
∑
i=0
A
i
B ...
Np?Nu
∑
i=0
A
i
B
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
∆ U[k]. (31)
By substituting (31) into (30), Z[k] is redeﬁned as follows:
Z[k] = ?X[k]+?u[k¡1]+?∆U [k]. (32)
By substituting (32) into V[k] in (17), V[k] can be modiﬁed
into the following quadratic form:
V[k] = ∆U [k]
T
(?
T
Q?+W)∆ U[k]
¡2∆U [k]
T
?
T
QE[k]+E[k]
T
QE[k], (33)
where E[k] is shown as follows:
E[k] = R[k]¡?X[k]¡?u[k¡1]. (34)
C. Transformation of Inequalities
(18) and (19) can be modiﬁed as follows:
[
I
Np
¡I
Np
]
Q
y
[k] ·
[
q
ymax
q
ymin
]
,
?
q
Q
y
[k] · g
q
, (35)
[
I
Np
¡I
Np
]
T[k] ·
[
?
max
?
min
]
,
?
?
T[k] · g
?
, (36)
where I
Np
is the N
p
£N
p
unit matrix. Q
y
[k] and T[k] can
be extracted from Z[k] and expressed as follows by using
the correspondent matrices ?
q
, ?
?
, ?
q
, ?
?
, ?
q
, and ?
?
:
Q
y
[k] = ?
q
X[k]+?
q
u[k¡1]+?
q
∆U [k], (37)
T[k] = ?
?
X[k]+?
?
u[k¡1]+?
?
∆ U[k]. (38)
Bysubstituting(37)and(38)into(35)and(36),(35)and(36)
can be transformed into the following linear inequalities of
∆U [k]:
?
q
?
q
∆U [k] · ¡?
q
?
q
X[k]
¡?
q
?
q
u[k¡1]+g
q
, (39)
?
?
?
?
∆U [k] · ¡?
?
?
?
X[k]
¡?
?
?
?
u[k¡1]+g
?
(40)
2229
[a] turning angular velocity
[b] roll angle
[c] zero moment point
[d] actuator torque
Fig. 10. Simulation results for the conventional approach. (v
ref
= 1.667
[m/s], ?
refc
= 0.5886 [rad/s])
On the other hand, the following matrices are deﬁned to
modify (20):
F =
[
F
1
... F
Nu
]
=
[
I
Nu
M
¡I
Nu
M
]
,
f = [?
T
max
, ¡?
T
min
]
T
, (41)
where I
Nu
is the N
u
£N
u
unit matrix, and M can be shown
as follows:
M =
?
?
?
?
?
m
one
0 ... 0
0 m
one
... 0
.
.
.
.
.
.
.
.
.
0 0 ... m
one
?
?
?
?
?
, (42)
where m
one
=[1 0]. (20) can be transformed as follows:
F
y
∆ U(k)·¡F
x1
u[k¡1]¡f, (43)
where F
y
and F
x1
can be shown as follows:
F
y
= [F
x1
, ... F
xNu
],
F
xi
=
Nu
∑
i=1
F
i
. (44)
As a result, the inequalities (18), (19), and (20) can be
modiﬁed as the linear inequalities of ∆U [k] to formulate
the quadratic programming problem.
REFERENCES
[1] M.Yamaoka,PersonalMobilityRobot,JournaloftheRoboticsSociety
of Japan, Vol.26, No.8, pp.27–28, 2008.
[2] Y. Hosoda, S. Egawa, J. Tamamoto, K. Yamamoto, R. Nakamura, and
M. Togami, Basic Design of Human-Symbiotic Robot EMIEW, Proc.
of the 2006 IEEE/RSJ International Conference on Intelligent Robots
and Systems, pp. 5079–5084, 2006.
[3] M. Morita, and A. Yanaka, “Personal Mobility i-REAL”, Journal of
Society of Automotive Engineers of Japan, Vol.66, No.12, pp.36–41,
2012.
[4] N. Hirose, R. Tajima, and K. Sukigara, Personal Robot Assisting
Transportation to Support Active Human Life – Posture Stabilization
based on Feedback Compensation of Lateral Acceleration, Proc. of the
IEEE/RSJ International Conference on Intelligent Robots& Systems,
pp.659–664, 2013.
[5] T. Takei, R. Imamura, and S. Yuta, Baggage Transportation and
Navigation by a Wheeled Inverted Pendulum Mobile Robot, IEEE
Trans.onIndustrialElectronics,Vol.56,No.10,pp.3985–3994,2009.
[6] N. Hirose, R. Tajima, K. Sukigara, and Y. Tsusaka, Posture Stabi-
lization for a Personal Mobility Robot using Feedback Compensation
with an Unstable Pole, Proc. of IEEE International Conference on
Mechatronics, pp.804–809, 2013.
[7] R. Rajamani, J. Gohl, L. Alexander, and P. Starr, Dynamics of Narrow
Tilting Vehicle, Mathematical and Computer Modeling of Dynamical
Systems, Vol.9, No.2, pp. 209–231, 2003.
[8] D. Piyabongkarn, T. Keviczky, and R. Rajamani, “Active Tilt Control
for Stability Enhancement of a Narrow Commuter Vehicle”, Inter- national Journal of Automotive Technology, Vol.5, No.2, pp. 77–88,
2004.
[9] M. Krid, and F. Benamar, Design and control of an active anti-roll
system for a fast rover, Proc. of the 2011 IEEE/RSJ International
Conference on Intelligent Robots and Systems, pp. 274–279, 2011.
[10] J. M. Maciejowski, Predictive Control with Constraints, Prentice Hall,
2000.
[11] P. B. Wieber, Trajectory Free Linear Model Predictive Control for
Stable Walking in the Presence of Strong Perturbations, Proc. of the
IEEE-RAS International Conference on Humanoid Robots, pp.137–
142, 2006.
[12] S. Kajita, F. Kanehiro, K. Kaneko, K. Fujiwara, K. Harada, K. Yokoi,
and H. Hirukawa, Biped Walking Pattern Generation by using Pre-
view Control of Zero-Moment Point, Proc. of the IEEE International
Conference on Robotics & Automation, pp. 1620–1626, 2003.
[13] A. Shimada, and N. Hatakeyama, High-Speed Motion Control of
Wheeled Inverted Pendulum Robots, Proc. of 4th IEEE International
Conference on Mechatronics, pp. 1–6, 2007.
[14] N. Hirose, K. Sukigara, H. Kajima, and M. Yamaoka, Mode Switching
Control for a Personal Mobility Robot based on Initial Value Com-
pensation, Proc. of the 36th Annual Conference of the IEEE Industrial
Electronics Society, pp.1908–1913, 2010.
[15] M. Tanaka, R. Tajima, A. Fujii, Y. Tsusaka, N. Hirose, and K.
Sukigara, Personal Robot to Support Active Human Life by Assisting
Transportation – Person detection and following –, Proc. of JSME
Robomec 2013, 2A2–Q02 (in Japanese).
[16] N. Hirose, M. Iwasaki, M. Kawafuku, and H. Hirai, Deadbeat Feed-
forward Compensation with Frequency Shaping in Fast and Precise
Positioning, IEEE Trans. on Industrial Electronics, Vol. 56, No.10,
pp. 3790 – 3797, 2009.
[17] N. L. Ricker, Model Predictive Control with State Estimation, Ind.
Eng. Chem. Research, Vol.29, pp. 374–382, 1990.
2230
