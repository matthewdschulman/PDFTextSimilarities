A Precise Gait Phase Detection Based on High-Frequency Vibration
on Lower Limbs
Shuhei Kadoya
1
, Naohisa Nagaya
2
, Masashi Konyo
2
and Satoshi Tadokoro
2
Abstract—A novel gait phase detection method that can
extract the timing of foot contact conditions (Heel Strike and
ToeOff)byasinglepiezo ﬁlm sensor attached on each leg
is proposed. We focused on the occurrence of high-frequency
vibrations (> 100 Hz) in the beginning and the end of stance
phases during gait. After the features of vibration waveforms
during gait were conﬁrmed, we proposed the phase detection
method.Theoptimalparameterswereinvestigatedtodetectthe
phases robustly despite the walking speed and the shoe types.
Experimental results showed that the detected ground contact
events had high accuracy of timing. Finally, we conﬁrmed
the feasibility with the prototype wearable device in usual
environments.
I. INTRODUCTION
Gait phases are functional units segmented with the rel-
evant timing of motions in a gait cycle. Detection methods
of the gait phases are fundamental not only for clinical gait
analysis, but also for future engineering applications such as
a robotic walking support system and a ubiquitous health
monitoring system.
A gait cycle is divided into two primary phases, the stance
phase and the swing phase. The stance phase can be subdi-
vided into the detailed gait phases with the relevant timings,
HeelStrike(HS),HeelOff(HO),andToeOff(TO),observed
with the ground contact condition at the heel and toe as
shown in Fig. 1. In physical medicine and rehabilitation
ﬁelds, gait phases are deﬁned by the combination of timings
of HS, HO, and TO in the both legs [1]D In engineering
ﬁelds, the gait phase detection is also necessary for a gait
support system and human–machine interfaces synchronized
with gait motion. For example, a walking assistance system
requiresadistinctionofthestancephaseandtheswingphase
for controlling assistive force so that the detection of HS
and TO is necessary. In a study of a personal navigation
system, detecting the timing of the Mid Stance, in which
foot’s velocity becomes zero, performed precise estimation
of trajectories of a human locomotor equipped with inertial
measurement unit (IMU) [2], [3]. In studies of haptic display
for gait feeling [4], [5], detection of HS is also important
for producing stimulation on foot in synchronized with the
ground contacts. In this sense, detecting exact timings of
*This work was not supported by any organization
1
S. Kadoya is with the Department of Mechanical and Aerospace
Engineering, School of Engineering, Tohoku University, 6-6-01
Aramaki Aza Aoba, Aoba-ku, Sendai, Miyagi, 980-8579, Japan
kadoya@rm.is.tohoku.ac.jp
2
N. Nagaya, M. Konyo, and S. Tadokoro with the Graduate School
of Information Sciences, Tohoku University, 6-6-01 Aramaki Aza
Aoba, Aoba-ku, Sendai, Miyagi, 980-8579, Japan nagaya, konyo,
tadokoro@rm.is.tohoku.ac.jp
Fig. 1. Common deﬁnition of gait phases
HS, HO and TO is the fundamental procedure for the gait
analysis and the gait support systems.
Conventionally, there are several approaches for the gait
phase detection. In basic studies, many commercial gait
analysis systems are available, involving force plates and
pressure distribution sensors (a sheet type or an insole type)
for detecting foot contact conditions. On the other hand,
for aiming practical use in daily life, there are mainly two
approaches: a pressure-sensing type and an IMU type.
Pressure-sensing types use pressures sensors such as
pressure-sensitive rubber sensors, air pressure sensors, or
strain gauges, installed to the outside/inside of the shoes. For
example, Kong et al. [6] developed a smart shoe that can
measure ground contact forces (GCF), embedded with air
bladders and air pressure sensors in the sole. A fuzzy logic
estimator based on pressure patterns distinguished the gait
phases. Chen et al. [7] proposed a shoe-integrated system,
which consists of an IMU and ﬂexible pressure sensors
mounted on the insole, for human abnormal gait detection.
Whilethepressure-sensingtypescandetectrelativelyprecise
timing of HS, HO, and TO because they measure contact
pressure at the foot directly, available shoes are limited. An
insole type can be applied for various kinds of shoes but not
for all, especially for a bare foot.
IMU types, consisting of multi-dimensional accelerom-
eters and gyroscopes, are attached to legs or shoes and
estimate gait motions and contact conditions. Although a
shoe-mounted IMU [8]–[13] can detect contact condition
with relatively high accuracy, it has the same limitation of
attachment on shoes as well as the pressure-sensing type.
Leg-mounted IMU types [14]–[16] are available for any
footwear. They detect gait phases by attaching multiple
IMUs on several parts of legs such as thighs and shanks.
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 1852
40 45 50 55 60 65 70 75 80 85 90
-25
-20
-15
-10
-5
0
5
10
15
20
25
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 1
020 40 -20 60 80
0
0
500
1000 1.25
-1.25
Force
Sensor
40 45 50 55 60 65 70 75 80 85 90
-25
-20
-15
-10
-5
0
5
10
15
20
25
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 2
020 40 -20 60 80
0
0
500
1000 1.25
-1.25
40 45 50 55 60 65 70 75 80 85 90
-5
-4
-3
-2
-1
0
1
2
3
4
5
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 3
020 40 -20 60 80
0
0
500
1000 0.25
-0.25
40 45 50 55 60 65 70 75 80 85 90
-5
-4
-3
-2
-1
0
1
2
3
4
5
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 1
020 40 -20 60 80
0
0
500
1000 0.25
-0.25
Force
Sensor
40 45 50 55 60 65 70 75 80 85 90
-5
-4
-3
-2
-1
0
1
2
3
4
5
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 2
020 40 -20 60 80
0
0
500
1000 0.25
-0.25
40 45 50 55 60 65 70 75 80 85 90
-25
-20
-15
-10
-5
0
5
10
15
20
25
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
40 45 50 55 60 65 70 75 80 85 90
0
100
200
300
400
500
600
700
800
900
1000
Percentage Stride (%)
Ground Reaction Force (N)
Filtered Sensor Output (V)
Subject 3
020 40 -20 60 80
0
0
500
1000 1.25
-1.25
(a) Low frequency vibration waveform
(b) High frequency vibration waveform
Fig. 2. The example of the vibration waveform for a) low frequency and b) high frequency for 3 different subjects
A drawback of the leg-mounted IMU types might be lower
accuracy of the phase detection than the pressure-sensing
types. Mansﬁeld et al. [16] reported that HS detection had
approximately 150 ms delay with their IMU-based method.
In addition, putting multiple IMUs on legs takes time and
may not be suitable for use in daily life.
In this paper, we propose a novel gait phase detection
methods that can extract the timing of foot contact condi-
tions (HS and TO) by a single simple sensor attached on
each leg regardless of footwear types. Compering with the
conventional leg-mounted IMU type, the method proposed
has high accuracy in detection time for HS and TO. Our new
viewpoint is the occurrence of high-frequency vibrations (>
100 Hz) in the beginning and the end of stance phases during
gait. As far as the authors’ knowledge, there is no literature
focusing on such high-frequency vibration propagating on
legs for the gait phase detection. In this paper, we conﬁrm
that the high-frequency vibrations achieved by piezoﬁlm
sensors attached on ankles have peaks near HS and TO in the
stance phases. A stance phase detection method is proposed
based on the feature of the observed vibration waveforms.
Then, we explore the optimal parameters in the proposed
method for detecting the gait phases robustly despite the
walking speed and the shoe types. Finally, time accuracy
of the detected phased is evaluated.
II. MEASURING METHOD AND CHARACTERISTIC OF
VIBRATION
A. Measuring Method
In this study, vibrations during gait were measured using
a piezo ﬁlm sensor (SDT1-028K, Measurement Specialties,
Inc.) which can measure in a wide frequency range (up to
50 kHz) and has a ﬂat frequency response. The piezo ﬁlm
sensor converts its deformation to voltage. Output signals are
ampliﬁed by an ampliﬁer (PA-20DB, tokyo Sensor Co.,Ltd,)
and ﬁltered with an analog bandpass ﬁlter (6-1600 Hz).
As refference data for true timing of HS and TO, ground
reaction forces were measured by dual-belt treadmill with
force plates (ITR5018, Bertec Corp). The treadmill can
acquire separate ground reaction forces for both feet and
change speed from 0 km/h to 20 km/h.
The piezo ﬁlm sensor was attached on the ankle (lower
tibia around Medial malleolus) of each leg. All data were
recorded by a multi-channel 16 bits datalogger (NR-600,
Keyence Co., Ltd) at the sampling frequency of 5 kHz.
B. Characteristic
Typical features of generated vibration at the legs during
gait are investigated in this section. Especially, we discuss
the differences between high and low frequency components
in the timing of ground contacts at the stance phase.
Fig. 2 shows the 5 step samples of vibration waveform
for three subjects and ground reaction forces are also plotted
as a reference of gait phases. The top graphs (a) show the
low frequency components, which are ﬁltered with a band-
pass ﬁlter (5th-order Butterworth ﬁlter; cut-off frequency
10–100 Hz), and the bottom (b) shows the high frequency
components, which are ﬁltered with a band-pass ﬁlter (5th-
order Butterworth ﬁlter; cut-off frequency 50–150 Hz). The
horizontal-axis shows gait cycle in percentage stride of
?20% to 80%, where 0% represents a heel strike and 100%
is the next heel strike. The left vertical axis is for the ﬁltered
1853
sensor outputs, and right vertical-axis is for the ground
reaction force.
The vibration peaks appear near heel strike and toe off
for both the low frequency and the high frequency. So it
indicates that using vibration is possible to measure HS
and TO. The high frequency appears in the short term at
HS and TO comparing with the low frequency. It indicates
high frequency can determine the accurate timing of HS and
TO. However, the high frequency components are not so
conﬁdent to detect the contact events because sometimes it
have an unique shape depending subjects, for example, two
peaksappearnearthesameevent(Subject1)orseveralpeaks
appear between HS and TO (Subject 2). The low frequency,
on the other hand, less unique shape and has large peaks
only near heel strike and toe off that makes easier to detect
heel strike and toe off. Therefore, it is the best to use the
low frequency components for the indication of approximate
timing of heel strike and toe off, and the high frequency for
determining more speciﬁc timing.
III. HEEL STRIKE AND TOE OFF DETECTION
A. Phase Detection Method Proposed
In this section, a more speciﬁc phase detection method is
described.
True HS point -100ms +100ms
Search range
RMS peak
-100ms +100ms Peak
Search range
RMS peak
-100ms +100ms
Peak
True TO point -100ms +100ms
Estimated HS timing
Estimated TO timing
Search Threshold 
Time
Tsearch
RMS
High frequency vibration
Fig. 3. Proposed gait phase detection method
For ﬁnding approximate timing of the contact events
stably, the low frequency components are converted to RMS
(root mean square), which makes signals much smooth, and
then used to narrow down the possible detection term for
ﬁnding peaks of the high frequency at the ground contact
events. The detail of detection processes is given as follows:
1. Normalization: an acquired sensor signal isﬁltered with
the bandpass of 10–150 Hz, then normalized with the
maximum value of the ﬁltered data.
2. RMS: Determine the RMS of the normalized data. (The
applied RMS sample number N is optimized in later
section)
3. Noise Threshold: Determine the mean of the absolute
value of the normalized data in the step 1 from the ﬁrst
5 steps, which are assumed as a calibration process in
a practical use. This value becomes the threshold T
noise
for removing small noise of the signals.
4. Mean RMS: Determine the mean of the RMS that
exceeds the T
noise
.
5. Search Threshold: Multiply the Mean RMS with the
weight m. This value becomes the threshold T
search
for
ﬁnding possible range of the ground contact events.
(The weight m is optimized in the later section)
6. Max RMS: Find the maximum of RMS that exceeds the
threshold T
range
7. Finding Peaks: Find peaks of the high frequency com-
ponent in the range of ±100 ms from the Max RMS
point in the previous step. (100 ms is about 10% of the
gait cycle in 4 km/h walking speed)
To optimize this method, the best RMS sample number
N and threshold weight m should be determined. The opti-
mization is conducted in the next section.
B. Optimization RMS Samples and Threshold Statement
TheRMSsamplenumberN andsearchthresholdweightm
are needed to optimized as described in the previous section.
RMS is applied to generalize the trend of the peak of the
low frequency components. The sample number N should be
chosentoextracttheapproximaterangeofthegroundcontact
events. More sample number will generalize more, but too
many sample number will eliminate necessary information.
After preliminary investigation, we selected possible range
of RMS sampling numbers as follows: 600, 900, and 1200.
True event range
True event range
True event range
No search range
Tsearch
RMS
High frequency vibration
1st peak
2nd peak
Search range 1
Search range 2
1st peak
2nd peak
Search
range 1
Search range 2
(a) pass error
(b) multiple error
(c) extra error
Tsearch
Tsearch
Fig. 4. Diﬁnition of three types of error.
TheweightmisaimedtoadjustthesearchthresholdT
search
for extracting possible ranges of the contact events from the
RMS curve. If T
search
is too large, no possible range to be
searched is found. If T
search
is too small, many wrong search
area could be found. After preliminary investigation, we
found the possible value is around 0.50 so that we selected
m from 0.40 to 0.60 for the optimization.
Investigating parameters for the optimization are summa-
rized as follows:
? N: 600, 900, 1200 points
? m: 0.40, 0.45, 0.50, 0.55, 0.60
1854
C. Detection Performance Metrics
To evaluate the detection performance, we deﬁned the
possible case of errors as follows:
? pass error: No search range is achieved because the
RMS does not exceed the threshold T
search
near the
contact events. Fig. 4 (a) shows an example of pass
error, where the RMS near the event does not exceed
the threshold.
? multiple error: Multiple events are detected within the
± 100 ms range of the true event because RMS has
multiple peaks and exceeds the threshold T
Search
more
than twice. Fig. 4 (b) shows an example of multiple
error, where the RMS exceeds the threshold twice in
the range of the event, and another peak is detected.
? extra error: Extra events are detected out of the ± 100
ms range of the true event. The reason is same as
multiple error, but one or more peaks are detected out
of the event range. Fig. 4 (c) shows an example of extra
error, where the RMS exceeds threshold twice, and one
peak is out of the range of the event.
The successful detection is deﬁned as a rate of detection
occurrence that does not contain any errors deﬁned above.
D. Experimental Data Set
Experimental data set for optimizing the phase detection
method were achieved by conducting the measurements of
vibrations with various footwear and walking speeds.
Six subjects (all male in their age from 22 to 23 years
old) walked on the treadmill for 30 seconds, and ground
reactionforcesweremeasuredasareference.Walkingspeeds
were 3, 4, 5 [km/h], which were controlled by the treadmill
constantly.Itisknownthattypicalwalkingspeedforanadult
is 4 km/h.
Three kinds of footwear were selected as follows:
? Bare foot: wear nothing
? Sandal: a simple slip-in sandal, which only instep is
ﬁxedbytwobelts
? Running shoes: a running shoes with shock absorber in
the sole
E. Optimization Results
We analysed the successful detection rate for the ex-
perimental data set by changing the detection parameters
described in optimization.
First, we compare the result for three kinds of footwear at
walking speed of 4 km/h, which is the usual walking speed.
Resultsofthesuccessful detection rateforeachcondition are
showninFig.5.FortheRMSsamplenumberN,theN=900
has relatively higher score for the bare foot and the running
shoes except for the sandal. For the threshold weight m, m=
0.5 has relatively higher score rate on average if focusing
on the condition of N= 900. Therefore, we assumed that
a possible combination of optimized parameters is N=900
and m=0.5.
Second, we veriﬁed the robustness of the determined
parameters against the walking speeds. Fig. 6 shows the
Heel Strike Toe Off
0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7
o
*
+
N=600
N=900
N=1200
o
*
+
N=600
N=900
N=1200
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
(a) Bare Foot
0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7
50
55
60
65
70
75
80
85
90
95
100
0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7
50
55
60
65
70
75
80
85
90
95
100
o
*
+
N=600
N=900
N=1200
o
*
+
N=600
N=900
N=1200
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
(b) Sandal
0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7
50
55
60
65
70
75
80
85
90
95
100
0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7
50
55
60
65
70
75
80
85
90
95
100
o
*
+
N=600
N=900
N=1200
o
*
+
N=600
N=900
N=1200
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
Successful Detection (%)
Threshold Weight
100
90
70
80
60
0.40 0.45 0.50 0.60 0.55 0.65 0.35
(c) Running Shoes
Fig. 5. Successful detection result of the shoes for all given RMS samples
and threshold weight at walking speed of 4 km/h.
successful detention rate averaged from all the subject in
the different walking speed on each footwear. In the most
cases, the averaged detection rates are over 90. Therefore,
we concluded that the assumed optimal parameters are
reasonable enough.
IV. ACCURACY OF TIMING
In this section, the accuracy of detection timing achieved
in the previous section is discussed.
To verify the effect of the high frequency components
(ﬁltered with 50 –150 Hz band pass ﬁlter), we compare
the difference in detection timing with lower frequency
components, which are assumed that the band pass ﬁlter for
the sensor output is set to lower frequency range in 10 – 100
Hz.
Fig.7 shows the histograms of detected timing errors in
comparison of the frequency range of the band pass ﬁlter;
upper red bars represent the errors of the high frequency
range ﬁlter and lower blue bars represent that of the low
frequency range. The left side is the timing error about HS
and the right side is TO for three kinds of footwear. All
the experimental conditions are in the walking speed of 4
1855
Detection Rate (%)
3 km/h 5 km/h
Walking Speed
4 km/h 3 km/h 5 km/h
Walking Speed 
4 km/h
100
80
60
40
20
0
Detection Rate (%)
100
80
60
40
20
0
Bare foot Sandal Running Shoes
(a) Heel Strike (b) Toe Off
Fig. 6. Successful detection for all footwears and walking speeded at 900
RMS points and 0.5 threshold weight
km/h. Note that we excluded the timing error out of ±100
[ms] range from the histogram and counted them as the out
of range (OR) error. The observed OR error rate for the
high frequency estimation were 0.91% for HS in the sandal
and 3.23% for HS in the running shoes. No OR error was
observed in other conditions.
For the timing error of HS, the histograms clearly show
that the high frequency range has sharp and accurate score
near zero on each kind of footwear comparing with the low
frequencyrange.AsforTO,whilethedetectionerrorsspread
in relatively wide range, the occurrence rate of appearing
near zero for the high frequency range is higher than that
of the low frequency range. There is a tendency that the
detection timing with the high frequency range occurs in
advance of the event timing, and that of the low frequency
has a delay from the event timing.
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
-0.1 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 0.1
-80
-60
-40
-20
0
20
40
60
80
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
80
60
40
20
20
40
60
80
0
0 0.02 0.04 0.06 0.08 0.1 -0.1 -0.08 -0.06 -0.04 -0.02
Frequency
Frequency
Frequency
Frequency
Frequency
Frequency
0
80
60
40
20
20
40
60
80
80
60
40
20
20
40
60
80
0
80
60
40
20
20
40
60
80
0
0
80
60
40
20
20
40
60
80
80
60
40
20
20
40
60
80
0
80
60
40
20
20
40
60
80
0
Error (ms) Error (ms)
0 40 20 60 100 80 -100-80 -60 -20 -40 0 40 20 80 100 60 -100-80 -60 -20 -40
Error (ms) Error (ms)
0 40 20 60 100 80 -100-80 -60 -20 -40 0 40 20 80 100 60 -100-80 -60 -20 -40
Error (ms) Error (ms)
0 40 20 60 100 80 -100-80 -60 -20 -40 0 40 20 80 100 60 -100-80 -60 -20 -40
high
low
high
low
high
low
high
low
high
low
high
low
Bare foot
Heel Strike Toe Off
Sandal Running shoes
Fig. 7. Time error for successful detections (over 100 ms is excluded)
with shoes at walking speed of 4 km/h for all subjects. The results are bare
foot, sandal, and shoes from the top. Upper part of histogram shows the
result of high frequency and lower part of histogram shows the result of
low frequency.
These results demonstrate that the high frequency vibra-
tion has the high potential to extract the accurate timing
of the contact events during gait. If we compare the ac-
curacy of the proposed method with the best conventional
studies, which use IMU sensor mounted on foot (shoes)
with sophisticated algorisms [12], the timing of accuracy
in this study is comparable to them. The mean and the
standard deviation of timing errors were ?7.64±19.65 [ms]
for HS and ?4.86±23.10 [ms] for TO in the condition of
the running shoes. Mannini et al. [12] reported that their
estimation errors were 8±32 [ms] for HS and 11±15 [ms]
for TO in the condition of walking with the HMM-based
method.
If we say the difference of our method, our sensing
algorism is very simple and the piezo ﬁlm sensor is able to
be attached on legs except for feet or shoes. The successful
detection rates in Fig. 6, however, is still lower than the
conventional methods (about 99%). In this sense, we may
be able to ﬁnd the model-based approach or the combination
with IMUs to estimate the gait phase certainly.
V. FEASIBILITY TEST IN USUAL ENVIRONMENT
The two subjects (both male in their age from 23 to 24
yearsold)walkedonthecarpetﬂoorwithellipticorbitwhich
contains turning motion (to the left), and the same data as
previous experiment was recorded with the prototype device.
This device can be carried, and acquire vibration data with
piezo ﬁlm sensor and ground reaction force, as the reference
data, with FlexiForce (FF-SET-A2014-25-8: Nitta co.,Ltd )
placed underneath the heel and foot thumb. The pressure of
the heel FlexiForce will begin to rise when HS occurs and
the pressure of toe off will end to fall when TO occurs.
The result is shown in Fig. 8. The red line represents heel
pressure, blue represents toe pressure, and the black line
represents a detection by using the detection method. The
black line appears near HS and TO precisely that indicates
the method successfully detected HS and TO in the usual
environment. Even with mixing of turning motion during
walking, it still detected HS and TO successfully. Therefore
this method has high usability.
VI. CONCLUSIONS
A novel gait phase detection method that can extract
the timing of foot contact conditions (Heel Strike and Toe
Off) by a single piezo ﬁlm sensor attached on each leg is
proposed. We focused on the occurrence of high-frequency
vibrations (> 100 Hz) in the beginning and the end of stance
phases during gait. The method is proposed based on the
feature of observed vibration waveforms. We investigate the
optimal parameters for detecting the gait phases robustly
despite the walking speed and the shoe types. Experimen-
tal results showed that the high-frequency-vibration-based
method had high accuracy of timing, comparing with the
low frequency-based methods. Finally, we conﬁrmed the fea-
sibility of the proposed method with the prototype wearable
device in usual environments.
1856
0.7 0.8 0.9 1 1.1 1.2 1.3
4 5 6 7 8 9 10
4
time
time
detection point heel pressure toe pressure
high frequency filterd sensor output 
heel pressure toe pressure high frequency filterd sensor output 
detection point
Subject 1
Subject 2
Fig. 8. Feasibility test for free walking on the carpet ﬂoor with a wearable prototype system.
Theproposedmethodissosimplethatitcanbeappliedfor
gait analysis in daily life for many purposes such as robotic
motion support systems and health monitoring systems.
ACKNOWLEDGMENT
This research was partially supported by the Cabinet
Ofﬁce, Government of Japan through its ”Funding Program
for Next Generation World–Leading Researchers.”
REFERENCES
[1] Observational gait analysis,Los Amigos Research and Education In-
stitute, Downey, CA, 2001
[2] O. Bebek, M. a Suster, S. Rajgopal, M. J. Fu, M. C. Cavusoglu, D. J.
Young, M. Mehregany, a J. van den Bogert, and C. H. Mastrangelo,
Personalnavigationviashoemountedinertialmeasurementunits,2010
IEEE/RSJInternationalConferenceonIntelligentRobotsandSystems,
no. i, pp. 1052–1058, Oct. 2010.
[3] J. Borenstein, L. Ojeda, and S. Kwanmuang, Heuristic Reduction of
Gyro Drift for Personnel Tracking Systems, Journal of Navigation,
vol. 62, no. 01, p. 41, 2009.
[4] Y. Visell, F. Fontana, B. L. Giordano, R. Nordahl, S. Seraﬁn, and
R. Bresin, Sound design and perception in walking interactions,
International Journal of Human-Computer Studies, vol. 67, no. 11,
pp. 947–959, Nov. 2009.
[5] S. Papetti, F. Fontana, M. Civolani, A. Berrezag, and V. Hayward,
Audio-tactile display of ground properties using interactive shoes,
Haptic and Audio Interaction Design, pages 117–128, 2010.
[6] K. Kong and M. Tomizuka, Smooth and continuous human gait phase
detection based on foot pressure patterns, 2008 IEEE International
Conference on Robotics and Automation, pp. 3678–3683, May 2008.
[7] M. Chen, B. Huang, K. Lee, and Y. Xu, An intelligent shoe-integrated
system for plantar pressure measurement, Robotics and Biomimetics,
ROBIO’06, pp. 416–421, 2006.
[8] K. Aminian, B. Najaﬁ, C. Bula, P.F. Leyvraz, and P. Robert, Spatio-
temporal parameters of gait measured by an ambulatory system using
miniature gyroscopes, Journal of biomechanics, vol. 35, no. 5, pp.
689–99, May 2002.
[9] S. J. Morris and J. A. Paradiso, A Compact Wearable Sensor Package
for Clinical Gait Monitoring, vol. 1, no. 1, pp. 7–15, 2003.
[10] A. M. Sabatini, C. Martelloni, S. Scapellato, and F. Cavallo, Assess-
ment of walking features from foot inertial sensing, IEEE transactions
on bio-medical engineering, vol. 52, no. 3, pp. 486–494, Mar. 2005.
[11] L. Tao, Y. Inoue, K. Shibata, and H. Morioka, Development of
wearable sensor combinations for human lower extremity motion
analysis,Proceedings2006IEEEInternationalConferenceonRobotics
and Automation, 2006. ICRA 2006., no. May, pp. 1655–1660, 2006.
[12] A. Mannini and A. M. Sabatini, Gait phase detection and discrimina-
tion between walking-jogging activities using hidden Markov models
applied to foot motion data from a gyroscope, Gait and posture, vol.
36, no. 4, pp. 657–61, Sep. 2012.
[13] I. P. Pappas, M. R. Popovic, T. Keller, V. Dietz, and M. Morari,
A reliable gait phase detection system, IEEE transactions on neural
systems and rehabilitation engineering : a publication of the IEEE
Engineering in Medicine and Biology Society, vol. 9, no. 2, pp. 113–
25, Jun. 2001.
[14] A.T.M. Willemsen, F. Bloemhof, and H. B. Boom, Automatic stance-
swing phase detection from accelerometer data for peroneal nerve
stimulation, IEEE transactions on bio-medical engineering, vol. 37,
no. 12, pp. 1201–1208, Dec. 1990.
[15] K. Tong and M. H. Granat, A practical gait analysis system using
gyroscopes, Medical engineering and physics, vol. 21, no. 2, pp. 87–
94, Mar. 1999.
[16] A.MansﬁeldandG.M.Lyons,Theuseofaccelerometrytodetectheel
contact events for use as a sensor in FES assisted walking, Medical
Engineering and Physics, vol. 25, no. 10, pp. 879–885, Dec. 2003.
[17] D. Kotiadis, H. J. Hermens, and P. H. Veltink, Inertial Gait Phase
Detection for control of a drop foot stimulator Inertial sensing for gait
phase detection, Medical engineering and physics, vol. 32, no. 4, pp.
287–297, May 2010.
1857
