Experimental Evaluation of Adaptive Model-Based Control for Underwater
Vehicles In the Presence of Unmodeled Actuator Dynamics
Christopher J. McFarland and Louis L. Whitcomb
Abstract— This paper reports a comparative experimental
evaluation of proportional derivative and adaptive model-
based control for underwater vehicles. To the best of the
authors’ knowledge, this is the ﬁrst such evaluation of model-
based adaptive tracking control for underwater vehicles during
simultaneous dynamic motion in all 6 degrees-of-freedom. This
experimental evaluation revealed the presence of unmodeled
thruster dynamics arising during reversals of the vehicle’s
thrusters, and that the unmodeled thruster dynamics can desta-
bilize parameter adaptation. The three major contributions of
this paper are: an experimental analysis of how unmodeled
thruster dynamics can destabilize parameter adaptation, a two-
step adaptive model-based control algorithm which is robust
to the thruster modeling errors present, and a comparative
experimental evaluation of adaptive model-based control and
proportional derivative control for fully-actuated underwater
vehicles preforming simultaneous 6 degree-of-freedom trajec-
tory tracking.
I. INTRODUCTION
This paper addresses the problem of adaptive model-
based trajectory tracking control of Underwater Vehicles
(UV) for dynamic 6 degree-of-freedom (DOF) motion. The
approach of adaptive model-based control (AMBC) reﬁnes
estimates of plant parameters during the trajectory tracking
control process. The adaptive controller estimates parameters
for a rigid-body plant such as vehicle mass with added
hydrodynamic mass, quadratic drag, gravitational force, and
buoyancy torque parameters that arise in the dynamic models
of rigid-body UV . We report a comparative experimental
evaluation of AMBC and proportional derivative control
(PDC) in full scale vehicle trials utilizing the Johns Hopkins
University Hydrodynamic Test Facility and Johns Hopkins
University Remotely Operated Vehicle (JHU ROV) (Fig. 1).
This experimental evaluation shows that AMBC provides
30% better position tracking performance and 8% worse
velocity tracking performance over PDC. To the best of the
authors’ knowledge, this is the ﬁrst experimental comparison
of AMBC and PDC during simultaneous motion in all DOF.
This paper is organized as follows: Section II states
two UV control algorithms: a non-adaptive model-based
controller (MBC) which assumes knowledge of the plant
parameters and an adaptive model-based controller which
estimates plant parameters during the control process. Both
approaches can be shown to provide asymptotically exact
trajectory tracking in position and velocity [16]. Section
This work was supported by the National Science Foundation under
Award 0812138 and 1319667. Support for the ﬁrst author was provided
by the Link Foundation and ARCS Foundation.
The authors are with the Department of Mechanical Engineering,
Johns Hopkins University, Baltimore, MD 21218, USA, cmcfarland,
llw@jhu.edu
Fig. 1: JHU ROV inside the Johns Hopkins Hydrodynamic Test
Facility.
II-C reports a two-step AMBC algorithm which is shown
experimentally to be robust to the actuator modeling errors
observed in our experimental vehicle. Section III-C presents
two experiments where AMBC is used to follow a pitch
only reference trajectory. The range of motion is changed
such that one pitch only reference trajectory requires thrust
reversals and the other pitch only reference trajectory does
not. A comparative analysis of these parameter adaption pro-
cesses details how unmodeled dynamics arising from thrust
reversals can cause unstable parameter adaptation. Section
III-C also shows how direct implementation of the AMBC
from Theorem 2.1 exhibits unstable parameter adaptation in
the presence of unmodeled thrust reversal dynamics. Section
III-D reports an experimental evaluation of the two-step
AMBC algorithm, and a comparison of AMBC and PDC.
A. Background and Paper Contribution
Recent advances in UV enabling technologies including
in-situ sensing, power storage, and communication modal-
ities have enabled the development of UVs which can ac-
complish missions previously thought impractical or impos-
sible. Many of these missions, such as commercial seaﬂoor
surveys and environmental monitoring, depend on tracking
a speciﬁed trajectory as closely as possible. To facilitate
these missions, novel UV control algorithms are required
to provide improved trajectory tracking precision. UV MBC
has been shown experimentally to provide signiﬁcant perfor-
mance gains over PDC [15], however MBC requires model
parameters to be known a priori. UV AMBC removes the
need for a previously identiﬁed model. Although a few
experimental implementations UV AMBC algorithms have
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2893
been reported, experimental evaluations of AMBC during
simultaneous motion in all DOF is a lacuna in the literature.
In steady-state operation at zero advance velocity the
axial thrust of a bladed-propeller marine thruster is linearly
proportional to the applied shaft torque, and is also linearly
proportional to the signed-square of the shaft angular velocity
[26]. The parameters of these steady-state thruster models
cannot be determined analytically, but are easily estimated
with simple steady-state experiments. Research by the author
and others has shown that the transient performance of
marine thrusters can be accurately approximated by a ﬁnite-
dimensional second-order plant model of propeller-ﬂuid in-
teraction [2], [8], [10], [28]. The plant parameters of these
dynamic thruster models cannot be determined analytically,
and are very difﬁcult to measure experimentally because such
identiﬁcation requires highly instrumented measurements of
both the thruster and the ﬂuid in unsteady operation.
Because unsteady thruster model parameters are difﬁcult
to obtain experimentally, in the design of marine vehicle con-
trol systems it is common practice to employ easily-obtained
steady-state thruster models. This approach works extremely
well for steady-state or slowly time-varying vehicles motion,
but results in the presence of unmodeled thruster dynam-
ics during highly dynamic vehicle maneuvering. In 1984
Rohrs et al. famously showed that stable adaptive controllers
for linear time-invariant plants can be destabilized by the
presence of unmodeled plant dynamics [21]. To the best of
our knowledge, this paper reports the ﬁrst observation of
unmodeled thruster dynamics resulting in the destabilization
of model-based adaptive tracking control of a UV .
B. Literature Review
Adaptive controllers for linear plants are well understood
[18]. Adaptive reference trajectory-tracking is well under-
stood for several types of second-order holonomic nonlinear
plants whose parameters enter linearly into the plant equa-
tions of motion, e.g. robot manipulator arms [5], [22], [24],
spacecraft [12], [23], and rigid-body rotational plants [4].
Comparative experimental evaluations of AMBC for robot
manipulator arms have been performed, e.g. [19], [27].
[3] reports a PDC control law for a second-order rigid-
body plant in free space using exponential error coordinates.
UV MBC algorithms have been reported [7], with several
experimental studies for control of the x, y, depth, and head-
ing DOF [25], and for simultaneous motion in all DOF [15].
Previous studies have utilized a nonlinear model (such as
(1)) in the development of tracking control algorithms which
are robust to model parameter uncertainty. In [30] a sliding
mode controller and numerical simulations of performance
in X, Y and heading is reported. In [31] a discrete time
parameter adaptation algorithm is reported with a numerical
simulation study. In [6] the authors report a hybrid (adaptive
and sliding) nonlinear UV controller which explicitly handles
multiplicative uncertainty in the input mapping. The ﬁrst
experimental evaluation of nonlinear adaptive sliding-mode
control on an underwater vehicle was reported [29]. In [32]
an experimental evaluation of UV AMBC performance in
the presence of noisy position readings is reported. In [1]
an experimental evaluation of an AMBC is reported during
simultaneous motion in the translational DOF. Comparative
experimental evaluations of linear controllers, model-based
controllers and their adaptive extensions for UV single DOF
motion have been reported [13], [25]. In [33] a comparative
experimental evaluation in the presence of a common exter-
nal disturbance for proportional integral derivative control,
disturbance observer control and the adaptive extensions of
both is reported. In each of these experimental evaluations
at most two DOF had a non-zero reference velocity at a
given moment, and in all cases only set-point regulation was
reported in the pitch and roll DOF.
C. Problem Statement
Notation: We represent the actual pose of the vehicle in
exponential coordinates as 
a
2R
6
and the actual velocity
of the vehicle as
a
v
a
2 R
6
. Note that for
w
a
R 2 SO(3),
the rotation matrix from the actual body-frame to the world-
frame, and p
a
2 R
3
, the position of the vehicle, we have
w
a
H =

w
a
R p
a
0
13
1

= e
c
 a
whereb : R
6
! se(3) is
the standard operator mapping R
6
into the tangent space
of SE(3) [17]. The vehicle’s velocity vector obeys the
relation
a
v
a
=

a

T
a
a
!
T
a

T
, where
a

a
2 R
3
is the
vehicle’s body-frame translational velocity and
a
!
a
2 R
3
is the vehicle’s body-frame angular velocity. We similarly
represent the desired pose and velocity of the vehicle as
 
d
2R
6
and
d
v
d
2R
6
with the desired-frame homogeneous
matrix, rotation matrix, position, translational velocity and
angular velocity represented as
w
d
H,
w
d
R, p
d
,
d

d
, and
d
!
d
,
respectively.
Vehicle Dynamics: We model a UV as a rigid body
with added hydrodynamic mass, quadratic drag, gravitational
force, and buoyancy moving under the inﬂuence of external
control torques2R
3
and control forcesf2R
3
applied by
the vehicles thrusters. The commonly accepted second-order
ﬁnite-dimensional lumped parameter dynamic model for a
fully submerged rigid-body UV , in the body frame, is
w
a
_
H =
w
a
H
d
a
v
a
M
a
_ v
a
= ad
T
a
va
M
a
v
a
+D(
a
v
a
) +G(
w
a
H) +u (1)
where D(v) =
P
6
i=1
jv
i
jD
i
v, G(R) =

gR
T
e
3
J (b)R
T
e
3

,
e
3
= [0 0 1]
T
, u =

f
T

T

T
, M2 R
66
is the vehicle’s
symmetric positive deﬁnite (SPD) mass matrix, the setD
i
2
R
66
(i = 1 6) are the 6 DOF fully-coupled quadratic
drag coefﬁcients,g2R is the net vertical force acting on the
vehicle due to gravity and buoyancy (i.e. the net buoyancy),
and b2 R
3
is the moment applied to the vehicle due to
the relative positions of the center-of-gravity and center-of-
buoyancy (which will vary as a function of the vehicle’s roll
and pitch) [7]. We assume
w
a
H,
a
v
a
, f and  are accessible
signals and the parameters (M, D
i;i=16
, g, b) are constant
but unknown. Note that (1) is linear inM,D,g andb, thus
can be parametrized as a single parameter vector, 2R
241
with M having 21 parameters, D having 216 parameters, g
having 1 parameter, and b having 3 parameters.
The functionsJ :R
3
!R
33
(the mapping from R
3
to
so(3)),b :R
6
!R
44
(the mapping fromR
6
to se(3)), ad :
2894
R
6
!R
66
(the se(3) adjoint operator), and Ad : SE(3)!
R
66
(the se(3) adjoint map) and further information on
state representation, the parameters analytic properties, the
structure of, state error representations, the SE(3) logorithm
log
SE(3)
: SE(3)! se(3) and the inverse SE(3) Velocity
Jacobian
^
A
 1
: se(3)!R
66
are detailed in [16].
Error Coordinates: We deﬁne H as
H =
w
d
H
 1w
a
H: (2)
We use H to deﬁne the position tracking error ( ),
velocity tracking error (v), and parameter error vector as
 = log
SE(3)
(H) (3)
v =
a
v
a
 
a
v
d
(4)
 =
^
  (5)
where
a
v
d
= Ad
H
 1
d
v
d
.
Norm and Eigenvalue Conventions: We employ the fol-
lowing notation convention for the eigenvalues of the mass
matrix:
^

6
is the smallest and
^

1
is the largest eigenvalues
of the mass matrix
^
M(t), the other eigenvalues are labeled
such that
^

i 1
(t)
^

i
(t)
^

i+1
(t). The eigenvalues of M
and M are labeled using the same convention.
Goal: Given a desired trajectory f
w
d
H;
d
v
d
;
d
_ v
d
g for a
plant of the form (1) with unknown plant parameters
fM;D;g;bg, our goal is to develop a control law u :
SE(3)R
6
 SE(3)R
6
R
6
R
241
! R
6
and param-
eter update law
_
^
 : SE(3)R
6
 SE(3)R
6
 R
6
!
R
241
which guarantee that all signals remain bounded
and provide asymptotically exact reference tracking, i.e.
lim
t!1
 (t) =
~
0 and lim
t!1
v(t) =
~
0.
II. UV ADAPTIVE MODEL-BASED TRACKING CONTROL
This Section states three tracking control algorithms for
mechanical plants of the form (1): a MBC, an AMBC, and
a two-step AMBC. All three tracking controllers reported
herein admit the use of a fully-coupled model for UV
dynamics; however, to clarify the analysis of UV AMBC
in the presence of unmodeled thruster dynamics, we imple-
mented controllers which employ an uncoupled model of
UV dynamics for the experimental evaluations reported in
Section III. Note that the MBC requires exactapriori param-
eter knowledge, whereas the AMBC provides asymptotically
exact tracking control without requiring a priori knowledge
of the plant parameters.
A. UV Model-Based Tracking Controller
Theorem 1.1: For plants of the form (1), when the plant
parameters, , are known, the control law
u
 
w
a
H;
a
v
a
;
w
d
H;
d
v
d
;
d
_ v

=  (k
p
^
A
 T
( ) +k
d
v) +W(
a
_ v
d
; v;
a
v
d
;
w
a
H); (6)
where the regressor matrix W :R
6
R
6
R
6
 SE(3)!
R
6241
is deﬁned such that
W(
a
_ v
d
; v;
a
v
d
;
w
a
H) =M
a
_ v
d
 M ad
v
a
v
d
  ad
T
a
va
M
a
v
a
 D(
a
v
a
) G(
w
a
H); (7)
provides asymptotically stable trajectory tracking in the sense
of Lyapunov, i.e. lim
t!1
 (t) =
~
0 and lim
t!1
v(t) =
~
0, if the following conditions are met:
 the signalsf
w
d
H;
d
v
d
;
d
_ v
d
g2fSE(3);R
6
;R
6
g are con-
tinuous and bounded
 k
d
:k
p
2R
+
 kx(t
0
)k<
q
12
1

where, as per the eigenvalue ordering conventions from
Section I-C,


i
are the eigenvalues of
M

=

k
p
I
66
M
M M

: (8)
A stability proof is reported in [16].
B. UV Adaptive Model-Based Tracking Controller
Theorem 2.1: For plants of the form (1) with unknown
plant parameters  the control and parameter update laws
u(
w
a
H;
a
v
a
;
w
d
H;
d
v
d
;
d
_ v;
^
) (9)
=  (k
p
^
A
 T
( ) +k
d
v) +W(
a
_ v
d
; v;
a
v
d
;
w
a
H)
^

_
^
(
w
a
H;
a
v
a
;
w
d
H;
d
v
d
;
d
_ v
d
) (10)
= K

W
T
(
a
_ v
d
; v;
a
v
d
;
w
a
H)( + v)
provide asymptotically stable trajectory tracking in the sense
of Lyapunov, i.e. lim
t!1
 (t) =
~
0 and lim
t!1
v(t) =
~
0, and the parameter values converge to constant values, i.e.
lim
t!1
_
^
(t) = 0
2411
, if the following conditions are met:
 the signalsf
w
d
H;
d
v
d
;
d
_ v
d
g2fSE(3);R
6
;R
6
g are con-
tinuous and bounded
 k
d
;k
p
2R
+
 K

is SPD
 < min

4kpk
d
21kpc+k
2
d
;
q
kp6

2
1


q
1
12
kx(t
0
)k
2
+
k

12
k(t
0
)k
2
<.
wherek

=
1
min eigK

,


i
are the eigenvalues ofM

, and
i
are the eigenvalues ofM (noting the eigenvalue conventions
from Section I-C). A stability proof is reported in [16].
C. Two-Step AMBC
(1) allows the identiﬁcation of dynamic and gravitational
parameters to be conducted in a two-step process. (7) is linear
in the parameters, thus there exists a set of regressor vectors
W
i
:R
6
R
6
R
6
 SE(3)!R
6
such that
241
X
i=1
W
i
(
a
_ v
d
; v;
a
v
d
;
w
a
H)
i
=W(
a
_ v
d
; v;
a
v
d
;
w
a
H): (11)
If a subset of parameter values in  is known a priori then,
based on Theorems 1.1 and 2.1, an AMBC can be developed
to estimate the remaining unknown parameters. Any AMBC
of this form achieve asymptotically exact trajectory tracking
canceling the contribution to vehicle dynamics due to known
parameters (Section 1.1) and use parameter update laws
to adaptively learn estimates of the unknown parameters
(Section 2.1). IfK

is assumed to be diagonal, each AMBC
of this form will be equivalent to using the AMBC from
Theorem 2.1 with each known parameter initialized to its
known value and its associated parameter gain within K

set to zero. The two-step AMBC presented herein relies on
independently estimating two disparate sets of parameters.
The ﬁrst step is identifying theg andb during slow (quasi-
static) pitch and roll motion, for which the plant model
0 =G(
w
a
H) +u (12)
2895
is valid—where all inertial and drag terms are assumed to
be negligible because they are either quadratic in velocity
or linear in acceleration. The validity of this model implies
using the adaptive tracking controller from Theorem 2.1 to
track a slow reference trajectory in pitch and roll will identify
estimates of g and b without requiring the simultaneous
estimation of mass and drag parameters.
The second step AMBC estimates the inertial and drag
parameters (i.e. M and D) while using the gravitational
parameter values identiﬁed in step one. Using the controller
from Theorem 2.1 with
^
b(t
0
) and ^ g(t
0
) set to their previ-
ously identiﬁed values, this controller can be used to track
any reference trajectory while identifying estimates of the
vehicle’s mass and drag.
III. EXPERIMENTAL EVALUATION
A. Experimental Setup
The JHU Hydrodynamic Test Facility [11] contains an
indoor fresh water tank measuring 7:75 m in diameter and
4:25 m deep, as shown in Figure 1. The facility is equipped
with the JHU ROV , a fully instrumented UV designed for
navigation and control research. The JHU ROV displaces
150 kg and is actuated by six 1:5 kWh DC electric thrusters
providing full control authority in 6 DOF. Each thruster is
controlled with a current-mode ampliﬁer in conjunction with
data from a-priori thruster calibration experiments. We esti-
mate thruster force (f
th
) based on measured thruster angular
velocities (!
th
) using the empirically validated steady state
relation f
th
=k
th
!
th
j!
th
j [26].
The world-frame’s orthonormal x, y, and z unit vectors
point from the frame’s origin towards in the directions
North, East and down respectively. Employing standard navel
architecture convention, the body-frame’s x, y, and z unit
vectors point from the vehicle’s origin toward, respectivly,
the vehicle’s bow, starboard side and keel [26].
The vehicle state is instrumented by a PHINS Inertial
Navigation System (IXSEA SAS, Marly-le-Roi, France),
1200 kHz bottom-lock Doppler sonar (RD Instruments, San
Diego, CA), and Paroscientﬁc depth sensor. The PHINS INS
includes a three-axis north-seeking ﬁber-optic gyrocompass
and inertial grade accelerometers whose data is used to esti-
mate angular velocity, pitch, roll, and heading states at 10 Hz.
For our PHINS conﬁguration, the measurement standard
deviations are 0.01

/s for angular velocity estimates, 0.13

for heading estimates, and 0.01

for pitch and roll estimates
[9]. This Doppler sonar measures the three dimensional
linear velocity in the instrument’s frame to an accuracy of
0.3% with an update rate of 6 Hz and zero bias [20].
B. Experimental Testing Methodology
To evaluate the performance of the identiﬁed plant models
we employ the approach that we term cross-validation. We
use the plant model experimentally identiﬁed from a vehicle
experimental identiﬁcation trial to predict, in a numerical
simulation, the performance of the actual plant in a dif-
ferent experimental trial whose trajectories differ from the
experimental identiﬁcation trial. The class of plants given
by (1) are open-loop-stable in linear velocity and angular
velocity due to the hydrodynamic damping. In the presence
of signiﬁcant buoyancy torque due to center-of-gravity to
center-of-buoyancy separation, this class of plants is also
open-loop-stable in roll and pitch. Because these open-loop
signals are stable, we can employ these signals to compare
the model plant’s predicted performance to the actual plant’s
experimentally observed performance. The error between
the predicted model performance and the experimentally
observed performance is reported as the mean absolute error
(MAE) between the simulated plant roll, pitch, linear velocity
and angular velocity and the actual experimental plant roll,
pitch, linear velocity and angular velocity. To compare the
trajectory tracking performance of controllers we consider
the mean normal of error (MNE) vectors, such as the position
and velocity error vectors. Smaller NME magnitude means
the plant is more closely tracking the reference trajectory.
The fully-coupled model of UV dynamics used in (1)
requires 241 independent parameter values. To clarify the
experimental analysis of UV AMBC in the presence of
unmodeled thruster dynamics, we have implemented a con-
troller which employs an uncoupled model using 16 scalar
terms: 6 hydrodynamic mass, 6 quadratic drag terms (one for
each DOF which we will label as m
i
and d
i
respectively),
and the 4 gravitational parameters g and b. A recent com-
parative experimental study of the performance of several 6-
degree of freedom (DOF) UV plant models (including both
the uncoupled 16 plant parameter model and fully-coupled
241 plant parameter model) concluded that the fully cou-
pled models (with 241 parameters) most accurately predict
plant dynamic behavior for fully-coupled 6-DOF dynamic
motion, however the 16 plant parameter model provided
adequate predictive capacity [14]. For a diagonal parameter
adaptation gain matrixK

, we can label the individual mass
parameter gains as 
mi
, the individual drag parameter gains
as 
di
, the individual buoyancy parameter gains as 
bi
and
the gravitational parameter gain as 
g
. Sinusoidal reference
trajectories are used in this study. Table I lists the frequencies
and amplitudes for the 6 DOF reference trajectories used.
TABLE I: Reference Trajectory Information
RefTraj1 RefTraj2
Reference Trajectory Parameter Parameter
Propose Identiﬁcation Cross-Validation
DOF Excitation Trajectory-Tracking
world x Cos Freq 0.242 rad/sec 0.185 rad/sec
Cos Amp 0.50 m 0.50 m
DOF Excitation Trajectory-Tracking
world y Cos Freq 0.210 rad/sec 0.286 rad/sec
Cos Amp 0.50 m 0.50 m
DOF Excitation Trajectory-Tracking
world z Cos Freq 0.185 rad/sec 0.242 rad/sec
Cos Amp 0.30 m 0.30 m
DOF Excitation Trajectory-Tracking Torque Input
roll Cos Frequency 0.5 rad/sec 0.55 rad/sec
Cos Amplitude 6.9

35 N m
DOF Excitation Trajectory-Tracking Torque Input
pitch Cos Freq 0.6 rad/sec 0.65 rad/sec
Cos Amp 8.6

30 N m
DOF Excitation Trajectory-Tracking
heading Cos Freq 0.210 rad/sec 0.0824 rad/sec
Cos Amp 135

135

2896
C. Experimental Analysis of UV AMBC Instability
In this subsection we report the results from three exper-
iments using AMBC to control the JHU ROV . Two experi-
ments reveal parameter adaptation instability in the presence
of unmodeled thruster dynamics during thrust reversals. A
third experiment does not have thrust reversals and parameter
estimates remain stable. In all three experiments the mass,
drag, and gravitational terms were initialized to previously
identiﬁed parameters values (Tables IV and V).
Tables II and III tabulate the initial and ﬁnal parameters
identiﬁed from the ﬁrst experiment during simultaneous
dynamic maneuvers in all DOF. For this experiment, the
reference trajectory speciﬁed was RefTraj1 from Table I, and
the gains used were k
p
= 300, k
d
= 100 
mi
= 1000,

di
= 5000, 
g
= 
b1
= 
b2
= 0:5 and 
b3
= 10:0. Over
this two-hour duration experiment most parameter values
oscillated near their previously identiﬁed values, however
^
b
3
(t), ^ m
4
(t), and ^ m
5
(t) adapted away from their previously
identiﬁed values. As seen in Figure 2, these mass estimates
adapt to physically unrealistic negative values and show no
signs of asymptotic behavior.
TABLE II: Gravitational Parameters Identiﬁed During Unstable
Parameter Adaptation
g b
1
b
2
b
3
Init 3.63 N 1.017 N m 3.02 N m 300 N m
Final -5.71 N 2.6 N m 3.53 N m 261 N m
TABLE III: Mass and Drag Parameters Identiﬁed During Unstable
Parameter Adaptation
DOF m
i
(to) m
i
(t
f
) d
i
(to) d
i
(t
f
)
Tran X 583 kg 583 kg -1245
N s
2
m
2
-1005
N s
2
m
2
Tran Y 873 kg 769 kg -1426
N s
2
m
2
-1400
N s
2
m
2
Tran Z 1021 kg 1031 kg -3060
N s
2
m
2
-3039
N s
2
m
2
Ang X 103.5 kg m
2
-1.348 kg m
2
-728.4 N s
2
-761.5 N s
2
Ang Y 137.1 kg m
2
42.5 kg m
2
-769.1 N s
2
-681.4 N s
2
Ang Z 106.4 kg m
2
41 kg m
2
-376.2 N s
2
-393.3 N s
2
0 1000 2000 3000 4000 5000 6000 7000 8000
?50
0
50
100
150
200
time (sec)
AngX or AngY Mass Estimate (kg)
Angular X and Angular Y Mass Estimates During AMBC
 
 
AngX DOF m
4
(t)
AngY DOF m
5
(t)
Fig. 2: The time evolution of of Angular X DOF and Angular
Y DOF mass estimates from AMBC during 6 DOF dynamic
maneuvers. These mass estimates adapt to physically unrealistic
negative values and show no signs of asymptotic behavior.
The second and third experiments compare parameter
adaptation while the vehicle is following pitch-only ref-
erence trajectories. In the second experiment, the pitch-
only reference trajectory oscillates about zero pitch. In the
third experiment, pitch-only reference trajectory oscillates
about a pitch of 5

with an amplitude of 3

. Thus the
second experiment requires thrust reversals to follow the
speciﬁed reference trajectory, and the third experiment does
not require thrust reversals. Figure 3 plots the angular ve-
locity, thrust commands, and mass estimate derivative for
both experiments. In the thrust subplots, the four lines are
plotted. For the two thrusters actuating vehicle pitch, both
the commanded and estimated thrusts are shown. Note that
the thrust is estimated using a thruster’s measured angular
velocity as detailed in Section III-A. As seen in the left thrust
plot, as the commanded thrust crosses zero, the measured
output remains zero until the commanded thrust reaches 5
Newtons. The buoyancy torque’s inﬂuence causes the pitch
and y angular velocity to signiﬁcantly deviate from their
respective reference trajectories. From the perspective of
the AMBC algorithm, these deviations from the position
and velocity reference trajectories are indistinguishable from
the deviations which would occur if the estimated pitch
inertia were too large, thus the parameter estimate update
for this term,
_
^ m
5
, have a large negative transient reponse
after each thrust reversal. Over a multi-hour experiment this
systematic error causes pitch and roll mass estimates to adapt
to physically unrealistic negative values. In the four plots to
the right in Figure 3 show that, without thrust reversals, the
chain of events leading to a large negative transient response
in the pitch mass update law are not present. The balanced
parameter adaptation seen in this third experiment leads to
pitch mass convergence to a physically realistic value.
D. Experimental Evaluation of Two-Step Method
In this subsection we report an experimental evaluation of
the adaptive tracking control algorithm II-C. The ﬁrst step
is identifying the gravitational and buoyancy parameters for
the UV using the adaptive tracking controller for plant model
(12). The reference trajectory was constant in translational
position and heading, with slow changes in pitch and roll to
provide quasi-static motion. For this experiment we used a
sinusoidal pitch reference trajectory with a magnitude of 0:2
rad and frequency of 34 Hz and a sinusoidal roll reference
trajectory with a magnitude of 0:15 rad and frequency of 42
Hz. The gains used were k
p
= 300, k
d
= 100 
g
= 
b1
=

b2
= 0:5 and 
b3
= 10:0. Over a 90 minute experiment
the gravitational and buoyancy parameters converged to the
values shown in Table IV.
TABLE IV: Gravitational Parameters Identiﬁed During Quasi-Static
Motion
g b
1
b
2
b
3
Final 3.59 N 1.696 N m 3.09 N m 300 N m
Using the identiﬁed parameters from Table IV, we exper-
imentally evaluated the performance of the two-step AMBC
described in II-C. The reference trajectory speciﬁed was
RefTraj1 from Table I. The mass and drag parameters were
initialized to zero. The gains used were k
p
= 300, k
d
=
1000, 
mi
= 1000 and 
di
= 5000. Over a four and a
half hour experiment all 12 mass and drag parameters were
observed to converge to physically realistic values. Table V
records the initial and ﬁnal value for each dynamic parameter.
Two-Step AMBC Trajectory Tracking Performance: Figure
2897
0 5 10 15 20 25 30 35
?10
?5
0
5
10
Time (sec)
Pitch (deg)
Experiment with Thrust Reversals
 
 
Ref Pitch
Pitch
0 5 10 15 20 25 30 35
?0.06
?0.04
?0.02
0
0.02
0.04
0.06
Time (sec)
Angular Velocity (rad/sec)
 
 
Ref AngY Vel
AngY Vel
0 5 10 15 20 25 30 35
?30
?20
?10
0
10
20
30
Time (sec)
Thrust (Newtons)
 
 
Est Th 5 Force
Cmd Th 5 Force
Est Th 6 Force
Cmd Th 6 Force
0 5 10 15 20 25 30 35
?0.6
?0.4
?0.2
0
0.2
0.4
0.6
Time (sec)
Mass Estimate Derivative (kg/sec)
 
 
AngY Mass Est Derivative
0 1 2 3 4 5 6 7 8
?10
?5
0
5
10
Time (sec)
Pitch (deg)
Experiment without Thrust Reversals
 
 
Ref Pitch
Pitch
0 1 2 3 4 5 6 7 8
?0.06
?0.04
?0.02
0
0.02
0.04
0.06
Time (sec)
Angular Velocity (rad/sec)
 
 
Ref AngY Vel
AngY Vel
0 1 2 3 4 5 6 7 8
?30
?20
?10
0
10
20
30
Time (sec)
Thrust (Newtons)
 
 
Est Th 5 Force
Cmd Th 5 Force
Est Th 6 Force
Cmd Th 6 Force
0 1 2 3 4 5 6 7 8
?0.6
?0.4
?0.2
0
0.2
0.4
0.6
Time (sec)
Mass Estimate Derivative (kg/sec)
 
 
AngY Mass Est Derivative
Fig. 3: Data from two experiments where AMBC was used to follow a single DOF reference trajectory in pitch. For both experiments an
uncoupled model was assumed, initial parameter estimates taken from the ﬁnal values in Tables IV and V, and thruster force was estimated
using measured propeller angular velocity. The four plots on the left are from the same 40 second subset of a single experiment which had
thrust reversals. In the left plot of commanded/estimated thruster output, a short period of thruster stiction is seen at each thrust reversal.
The effects of thruster stiction are seen in both the pitch and angular velocity plots as deviations from each state’s respective reference
trajectory. In the left pitch mass update law plot, the parameter update law is seen to have a large negative transient response after each
thurst reversal. The four plots on the right are from the same 8 second subset of a single experiment which did not have thrust reversals.
The chain of events leading to a large negative transient response in the pitch mass update law are not present in this experiment.
2898
TABLE V: Parameters Identiﬁed with two-step AMBC during
Dynamic Motion Trajectory-Tracking
DOF m
i
(to) m
i
(t
f
) d
i
(to) d
i
(t
f
)
Tran X 0.0 kg 628 kg 0.0
N s
2
m
2
-1259
N s
2
m
2
Tran Y 0.0 kg 791 kg 0.0
N s
2
m
2
-1429
N s
2
m
2
Tran Z 0.0 kg 1043 kg 0.0
N s
2
m
2
-3083
N s
2
m
2
Ang X 0.0 kg m
2
95.7 kg m
2
0.0 N s
2
-727.1 N s
2
Ang Y 0.0 kg m
2
145.3 kg m
2
0.0 N s
2
-783.4 N s
2
Ang Z 0.0 kg m
2
110.2 kg m
2
0.0 N s
2
-465.6 N s
2
4 compares the performance of the two-step AMBC to a
PDC with comparable gains. These two plots contain the
exponential position and velocity MNE for the PDC and
two-step AMBC experimental run. Both controllers were
following the reference trajectory RefTraj1 from Table I as
well as usingk
p
= 300 andk
d
= 100 gains. The PDC MNE
were calculated using 10 minutes of data. The MNE values
for the two-step AMBC were calculated for consecutive
15 minutes windows. Due to page limit constraints, the
trajectory tracking performance for each of the 12 individual
DOF are not reported here but are available online [16].
Note that several hours were required for the the dy-
namic plant parameter estimates to converge to physically
realistic values. Figure 4 presents the changes in trajectory-
tracking performance during parameter adaptation. Since
PDC trajectory-tracking performance does not adapt to the
system as part of the control process, we see from the right
side of Figure 4 that the asymptotic performance of two-step
AMBC provides 30% better position tracking and 8% worse
velocity tracking than PDC with similar gains.
0 5000 10000 15000
0
0.05
0.1
0.15
Time (sec)
Norm Psi Error
Comparison of Two?Step AMBC and PDC  ? Error In Exponential Position
 
 
AMBC MNE
PDC MNE
0 5000 10000 15000
0
0.02
0.04
0.06
Time (sec)
Norm V Error
Comparison of Two?Step AMBC and PDC  ? Error In Body Velocity
 
 
AMBC MNE
PDC MNE
Fig. 4: Exponential position and velocity MNE data for two experi-
mental controller evaluations, a PDC and the two-step AMBC. Both
controllers were following the same reference trajectory (RefTraj1
from Table I) as well as using the gains kp = 300 and k
d
= 100.
The PDC NME were calculated using 10 minutes of data, , this
single value is plotted in green across the entire ﬁgure. The two-
step AMBC MNE values were calculated for consecutive 15 minute
windows and plotted in blue.
Two-Step AMBC Parameter Cross-Validation: In addition
to providing trajectory tracking, AMBC has also been pro-
posed to identify UV models. Figure 5 shows the ability
of the identiﬁed model to match vehicle performance in
forward simulation increases during parameter adaptation.
Figure 5 shows experimentally measured states verses the
states from numerical simulations; each numerical simulation
uses a model identiﬁed by the two-step AMBC after a set
amount of time. For this comparison, a PDC was used to
drive the JHU ROV to follow RefTraj2 from Table I, the UV
states and thrust inputs were recorded for 10 minutes. Each
JHU ROV simulation used the thrust inputs recorded and
initial JHU ROV states to create a forward simulation. Three
states representative of the eight open-loop-stable states are
plotted. Note that both in the plots and listed MAE values, the
capacity of the identiﬁed parameters to model vehicle per-
formance increases as time progresses. Although the models
identiﬁed using two-step AMBC were not able to reproduce
the highest frequency ﬂuctuation’s observed experimentally
(such as those seen in the z angular velocity subplots of
Figure 5), the states shown from simulating a model using
the “5000 sec” parameter set (the ﬁnal parameter set included
in this analysis) indicate that AMBC can produce parameter
estimates which result in accurate plant models.
IV. CONCLUSION
In this paper we report an experimental investigation of
a previously unreported UV AMBC failure mode where
unmodeled thruster dynamics during thrust reversals cause
unstable parameter adaptation. We also report a novel two-
step AMBC algorithm which is shown experimentally to
provide stable trajectory tracking and parameter adaptation
in the presence of the unmodeled thruster dynamics of
our system. Finally, we report a comparative experimental
analysis of the two-step AMBC algorithm with PDC. This
experimental evaluation shows that two-step AMBC provides
30% better position tracking performance and 8% worse
velocity tracking performance over PDC.
REFERENCES
[1] G. Antonelli, S. Chiaverini, N. Sarkar, and M. West, “Adaptive control
of an autonomous underwater vehicle: Experimental results on ODIN,”
IEEE Transactions on Control Systems Technology, vol. 9, no. 5, pp.
756–65, September 2001.
[2] R. Bachmayer, L. L. Whitcomb, and M. Grosenbaugh, “An accurate
ﬁnite-dimensional dynamical model for the unsteady dynamics of
marine thrusters,” IEEE Journal of Oceanic Engineering, vol. 25,
no. 1, pp. 146–159, January 2000.
[3] F. Bullo and R. M. Murray, “Proportional derivative (PD) control on
the Euclidean group,” California Institute of Technology, Tech. Rep.,
08 1995.
[4] N. Chaturvedi, D. Bernstein, J. Ahmed, F. Bacconi, and N. McClam-
roch, “Globally convergent adaptive tracking of angular velocity and
inertia identiﬁcation for a 3-DOF rigid body,” IEEE Transactions on
Control Systems Technology, vol. 14, no. 5, pp. 841 –853, Sept. 2006.
[5] J. J. Craig, P. Hsu, and S. Sastry, “Adaptive control of mechanical
manipulators,” The International Journal of Robotics Research, vol. 6,
no. 2, pp. 16–28, Summer 1987.
[6] T. I. Fossen and S. I. Sagatun, “Adaptive control of nonlinear un-
derwater robotic systems,” in Proceedings of the IEEE International
Conference on Robotics and Automation, apr 1991, pp. 1687 –1694
vol.2.
[7] T. I. Fossen, Guidance and Control of Ocean Vehicles. New York:
John Wiley and Sons, 1994.
[8] A. J. Healey, S. M. Rock, S. Cody, D. Miles, and J. P. Brown, “To-
ward an improved understanding of thruster dyamics for underwater
vehicles,” IEEE Journal of Oceanic Engineering, vol. 20, no. 4, pp.
354–61, October 1995.
[9] IXSEA, PHINS III User Guide, 5th ed., IXSEA, July 2008.
[10] J. Kim and W. K. Chung, “Accurate and practical thruster modeling for
underwater vehicles,” Ocean Engineering, vol. 33, no. 5, pp. 566–586,
2006.
2899
0 0.5 1 1.5 2 2.5 3
?10
?5
0
5
10
Time (min)
rol (deg)
Cross?Validation Exp:  Known Vs two?step AMBC Identifed roll
 
 
TRUE
250s ?
1000s ?
5000s ?
0 0.5 1 1.5 2 2.5 3
?10
?5
0
5
10
rol Error (deg)
Time (min)
Mean Absolute Error: 250s ? 2.6 (deg) 1000s ? 2.2 (deg) 5000s ? 1.06 (deg) 
0 0.5 1 1.5 2 2.5 3
?0.4
?0.2
0
0.2
0.4
Time (min)
BodVelY (m/sec)
Cross?Validation Exp:  Known Vs two?step AMBC Identifed Body Velocity Y
 
 
TRUE
250s ?
1000s ?
5000s ?
0 0.5 1 1.5 2 2.5 3
?0.4
?0.2
0
0.2
0.4
BodVelY Error (m/sec)
Time (min)
Mean Absolute Error: 250s ? 0.107 (m/sec) 1000s ? 0.042 (m/sec) 5000s ? 0.042 (m/sec) 
0 0.5 1 1.5 2 2.5 3
?15
?10
?5
0
5
10
15
Time (min)
AngVelZ (deg/sec)
Cross?Validation Exp:  Known Vs two?step AMBC Identifed Angular Velocity Z
 
 
TRUE
250s ?
1000s ?
5000s ?
0 0.5 1 1.5 2 2.5 3
?15
?10
?5
0
5
10
15
AngVelZ Error (deg/sec)
Time (min)
Mean Absolute Error: 250s ? 4.3 (deg/sec) 1000s ? 3.6 (deg/sec) 5000s ? 2.8 (deg/sec) 
Fig. 5: Representative data of experimental and simulated JHU ROV
states during 6 DOF dynamic operation. In the roll, y body velocity
and z angular velocity plots, the measured state is plotted together
with the position estimates from three JHU ROV simulations. The
three parameter sets were taken from the time history of parameter
adaptation recorded during the two-step AMBC experiment. The
’250s’ parameter set (plotted in blue and marked with circles) is the
forward simulation using parameters identiﬁed after 250 seconds of
parameter adaptation. Similarly the ’1000s’ (plotted in green and
marked with stars) and ’5000s’ (plotted in red and marked with
triangles) are the forward simulations using parameters identiﬁed
after 1000 and 5000 seconds of parameter adaptation respectively.
For each DOF, the error between the measured positions and their
estimates is shown.
[11] J. C. Kinsey, D. A. Smallwood, and L. L. Whitcomb, “A new
hydrodynamics test facility for UUV dynamics and control research,”
in Proceedings of IEEE/MTS Oceans, San Diego, CA, September
2003, pp. 356–361.
[12] D. E. Koditschek, “Adaptive strategies for the control of natural
motion,” in IEEE Proceedings 24th Conference on Decision and
Control, Fort Lauderdale, Dec 1985, pp. 1405–1409.
[13] D. Maalouf, I. Tamanaja, E. Campos, A. Chemori, V . Creuze, J. Torres,
L. Rogelio, et al., “From PD to nonlinear adaptive depth-control of
a tethered autonomous underwater vehicle,” in IFAC Joint conference
2013, 2013.
[14] S. C. Martin and L. L. Whitcomb, “Experimental identiﬁcation of
six-degree-of-freedom coupled dynamic plant models for underwater
robot vehicles,” IEEE Journal of Oceanic Engineering, vol. PP, no. 99,
pp. 1–10, 2013.
[15] ——, “Preliminary experiments in fully actuated model based control
with six degree-of-freedom coupled dynamical plant models for under-
water vehicles,” in Proceedings of the IEEE International Conference
on Robotics and Automation, Karlsruhe, Germany, May 2013.
[16] C. J. McFarland, “Adaptive identiﬁcation and control for underwater
vehicles: Theory and experimental evaluations,” Ph.D. dissertation,
The Johns Hopkins University, Baltimore, MD USA, November 2013.
[17] R. M. Murray, Z. Li, and S. S. Sastry, A Mathematical Introduction
to Robotic Manipulation. Boca Raton: CRC Press, 1994.
[18] K. Narendra and A. Annaswamy, Stable Adaptive Systems. NY:
Prentice-Hall, 1988.
[19] G. Niemeyer and J.-J. E. Slotine, “Performance in adaptive manipula-
tor control,” The International Journal of Robotics Research, vol. 10,
no. 2, pp. 149–161, April 1991.
[20] RD-Instruments, “Workhorse Navigator Datasheet,” Teledyne RD-
Instruments, http://www.rdinstruments.com/navigator.aspx.
[21] C. Rohrs, L. Valavani, M. Athans, and G. Stein, “Robustness of
continuous-time adaptive control algorithms in the presence of un-
modeled dynamics,”IEEETransactionsonAutomaticControl, vol. 30,
no. 9, pp. 881–889, 1985.
[22] N. Sadegh and R. Horowitz, “Stability and robustness analysis of a
class of adaptive controllers for robotic manipulators,” The Interna-
tional Journal of Robotics Research, vol. 9, no. 3, pp. 74–92, June
1990.
[23] J.-J. E. Slotine and M. D. Di Benedetto, “Hamiltonian adaptive control
of spacecraft,”IEEETransactionsonAutomaticControl, vol. 35, no. 7,
pp. 848 –852, jul 1990.
[24] J.-J. E. Slotine and W. Li, “On the adaptive control of robot manipu-
lators,” The International Journal of Robotics Research, vol. 6, no. 3,
pp. 49–59, Fall 1987.
[25] D. A. Smallwood and L. L. Whitcomb, “Model-based dynamic posi-
tioning of underwater robotic vehicles: theory and experiment,” IEEE
Journal of Oceanic Engineering, vol. 29, no. 1, pp. 169–186, 2004.
[26] J. D. Van Manen and P. Van Ossanen,PrinciplesofNavalArchitecture,
Second Revision, Volume II: Resistance, Propulsion, and Vibration.
Jersey City, New Jersey USA: Society of Naval Architects and Marine
Engineers, 1988, E. V . Lewis, Editor.
[27] L. L. Whitcomb, A. Rizzi, and D. E. Koditschek, “Comparative
experiments with a new adaptive controller for robot arms,” IEEE
Transactions on Robotics and Automation, vol. 9, no. 1, pp. 59–70,
February 1993.
[28] D. R. Yoerger, J. G. Cooke, and J. E. Slotine, “The inﬂuence of thruster
dynamics on underwater vehicle behavior and their incorporation into
control system design,”IEEEJournalofOceanicEngineering, vol. 15,
no. 3, pp. 167–178, June 1990.
[29] D. R. Yoerger and J. E. Slotine, “Adaptive sliding control of an exper-
imental underwater vehicle,” in Proceedings of the IEEE International
ConferenceonRoboticsandAutomation, Sacremento, CA, USA, April
1991, pp. 2746–2751.
[30] D. R. Yoerger and J.-J. E. Slotine, “Robust trajectory control of
underwater vehicles,” IEEE Journal of Oceanic Engineering, vol. OE-
10, no. 4, pp. 462–70, October 1985.
[31] J. Yuh, “Modeling and control of underwater robotic vehicles,” IEEE
Transactions on Systems, Man, and Cybernetics, vol. 20, no. 6, pp.
1475 –1483, nov/dec 1990.
[32] J. Yuh, J. Nie, and C. S. G. Lee, “Experimental study on adaptive con-
trol of underwater robots,” in Proceedings of the IEEE International
Conference on Robotics and Automation, vol. 1, 1999, pp. 393–398
vol.1.
[33] S. Zhao and J. Yuh, “Experimental study on advanced underwater
robot control,” IEEE Transactions on Robotics, vol. 21, no. 4, pp.
695–703, 2005.
2900
