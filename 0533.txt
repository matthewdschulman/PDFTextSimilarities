Compliance Control for Standing Maintenance of Humanoid Robots
under Unknown External Disturbances*
Yaliang Wang, Rong Xiong, Qiuguo Zhu and Jian Chu
1
Abstract—For stable motions of position controlled hu-
manoid robots, ZMP (Zero Moment Point) control is widely
adopted, but needs to be integrated with other controllers
due to its relatively slow response and the execution error of
robots. While CoM (Center of Mass) control is much more
directly than ZMP feedback control in the view of rejecting
unknown external disturbance. In the meanwhile, we hope
the position-based humanoid robot can have the whole body
compliance in standing maintenance. So we proposes a CoM
compliance controller to achieve stable standing of position
controlled humanoid robot under unknown disturbance. The
controller uses the concept of force control and integrates
virtualmodelcontrolwithadmittancecontrol,whereanAMPM
(Angular Momentum including inverted Pendulum Model)-
based virtual model with variable gain is designed to not
only generate desired recovery force but also take the GRF
(Grand Reaction Force) constraints into account, while an
admittancecontrollerisemployedtotransformthedesiredforce
to expected CoM position and body attitude. The experiments
were conducted on the humanoid robot ’Kong’ by exerting
externalforcedisturbanceandchangingtheslopeoftheground
to demonstrate the effectiveness and robustness of our method.
I. INTRODUCTION
Due to the intrinsic unstable feature, bipedal humanoid
robotsareeasytofalloverandgetdamaged,especiallywhen
different disturbances such as unknown external force and
uneven ground exist. The ability to keep balance and remain
stable thus is of great importance to humanoid robots and
attracts a lot of attention in related research ﬁelds. Various
methods have been proposed to improve the stability of
the robot under various task conditions, such as standing
[1][2][3], walking [4][5][6], running [7][8], jumping [9], fast
manipulating [10], etc. This paper focuses on how to keep
humanoid robots standing stable when they are subject to
unknown external interference.
There are two categories of adjusting strategies. One is
adjustingthebodyconﬁgurationofthehumanoidrobotwhile
keeping the foot of the robot ﬁxed to the original location
[2][3], which is called standing maintenance in this paper.
Another is stepping out to gain a larger support polygon
[11]. For most conditions when both strategies are sufﬁcient,
the former is always preferred over the latter. First, the
balance problem for standing maintenance is simpler than
that of stepping out, because there is no need to consider
*This work is supported by the National Nature Science Foundation of
China (Grant No. 61075078), the Natural Science Foundation of Zhejiang
Province (Grant No. LQ12F03009) and the Innovation Team of Advanced
Technology of Zhejiang Province (Grant No. 2009R50014).
1
The authors are all with the State Key Laboratory of Industrial Control
and Technology, Zhejiang University, Hangzhou, P. R. China. Rong Xiong
is the corresponding author. rxiong@iipc.zju.edu.cn
the questions of supporting leg selection and switch. Sec-
ond, stepping out requires larger instantaneous torque on
the swing leg. Finally, standing maintenance is a natural
preference for human in most situations. Of course, when
disturbance becomes too large to keep human/robots still,
stepping out will be carried out.
This paper proposes a CoM-based compliance control for
standingmaintenanceofpositioncontrolledhumanoidrobots
basedontherecognitionthatCoMcontrolismoredirectthan
ZMP control and the idea of using body compliance control
to keep stable in a more natural way. The method proposed
integrates virtual model control [12] with admittance control,
where the virtual model control is used to calculate the
desired virtual force and the admittance control transfers
the desired virtual force to position control command. Here
’position controlled humanoid robots’ refers to the humanoid
robots of which the joints are operating in position mode.
The main contributions of this paper are:
 A variable gain virtual model is designed to generate
the desired recovery force. It consists of three spring-
damper components, the gains of which are adjusted
according to the position of CP (Capture Point) [11].
AMPM [13] is employed to derive the constraints of
model from the view of GRF. Beneﬁting from the
correspondence between control variables of the virtual
model and AMPM, each spring-damper component has
a clear descriptor of GRF.
 An admittance controller is introduced to modulate
the expected recovery force on position controlled hu-
manoid robots. It takes the virtual model designed
as the ideal impedance and then gets the expected
CoM position and body attitude by an AMPM-based
integrator, with which position control commands of
joints can be calculated.
Experiments of exerting external force disturbance to the
robot and changing the slope of the ground demonstrate the
effectiveness of the proposed method which makes the posi-
tioncontrolledhumanoidrobotownstheperformancesimilar
to that of force controlled robots without any mechanical
change.
Remainder of the paper is organized as follows. Section
II discusses recent research progress on humanoid balance
maintenance against external disturbance. Section III de-
scribestheAMPM-basedvariablegainvirtualmodel.Section
IV explains how the admittance controller achieves the ideal
impedancedeﬁnedbythevirtualmodel.SectionVshowsthe
conﬁrmatory experiments and discusses their results. Section
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2297
VI summarizes our works and concludes the paper.
II. RELATED WORK
Some researchers applied ZMP control for stable stepping,
walkingorrunningofhumanoidrobots.Thiskindofstrategy
ismainlybasedontheZMPcriteria[14],thattherobotkeeps
stable if and only if its ZMP locates in the support polygon.
K. Yokoi et al. [4] proposed a ZMP damping controller and
a foot adjusting strategy to maintain the walking stability
of HRP-1S on uneven grounds. J. Kim et al. [5] gave an
integrated balance scheme that included a real-time ZMP
compensation in the single support phase, a damping control
of ankle joint, and a landing position control based on the
angular velocity of the torso. This scheme is validated by
KHR-2’sstabledynamicwalking.T.Takenaka[7]introduced
agroundreactionforcecontrolmethodandanextendedZMP
model control method which used horizontal and rotational
acceleration of the upper body and changed step duration
to generate moments to handle disturbance too large to be
handled by ground reaction force control. By integrating the
two methods, ASIMO achieved both balance recovery from
external disturbances and stable running.
The basic idea of real-time ZMP correction is calculating
the new reference ZMP according to the ZMP feedback from
force/torque sensors. However, the measurement of ZMP
feedback, which reﬂects the effect of external disturbance,
lags behind the change of the actual CoM and body’s posture
angle. The sensing delay results in a slow response of the
controller and may cause the system oscillating. For the
position controlled humanoid robots, due to the execution
error, large GRF may be generated when the swing leg
lands on the ground. The slow response makes it difﬁcult
for ZMP controller to deal with this impact. Thus, as the
methods mentioned above, it needs to be integrated with
other strategies, such as a damping control of ankle joint. R.
Tajimaetal.[8]proposedacompliancecontrolfortoe,ankle,
and knee joints by setting the joint with low gain to follow
external torque. A feedback controller was also presented in
order to remove the following errors respect to the original
CoM trajectory due to the compliance motion of joints.
Some mechanical modiﬁcations were also introduced. Z. Li
et al. [3] employed physical elasticity to reduce and absorb
instantaneous impacts with an active compliance control for
standing maintenance. The experiments conducted on the
compliant humanoid robot COMAN showed that the robot
can recovery from external impacts and adapt to slopes and
uneven grounds.
In consideration of the position mode’s limitation, force
controlledhumanoidrobotsthatusetheforcecontrolmodeto
actuate its joints were developed and corresponding balance
control methods were proposed. J. Pratt et al. [15] introduced
the capturability-based analysis and control for step location
adjustment, the effect of which is demonstrated on the force
controlled humanoid robot M2V2. J. Englsberger et al. [6]
described the CP tracking and CP end-of-step controller to
realize the DLR Biped stable standing and dynamic walking
under external disturbances. B. Stephens [1] proposed CoP
Balancing, CMP Balancing and Stepping strategies for bal-
ance to resist varying strength push on the Sacros Humanoid
Robot. S. Hyon at el. [2] presented a balance controller that
transforms the required ground reaction force into full-body
jointtorques,whichmakesthecomplianthumanoidrobotCB
stand stably under the disturbance from unknown external
forces.
Compared with above methods, we focus on standing
maintenance problem and adopt the force compliance idea to
control the CoM of the position controlled humanoid robot,
which enables the robot response quickly and show good
compliance and stability to unknown external disturbance.
III. AMPM-BASED VIRTUAL MODEL
A. Design Idea
VirtualModelControlusesvirtualmechanicalcomponents
to generate reference actuator torques or force[12]. In this
work, we design an AMPM-based variable gain virtual
model to generate desired recovery force which takes GRF
constraints into account. The model designed for standing
maintenance with a compliant pose control consists of three
spring-damper components and the gain of the model will
change with the varying location of the CP.
The essence of any motion control or balance control
method is to regulate GRF. It means the force or torque
command generated by the Virtual Model Control should
eventually provided by the GRF. To simplify the control
problem, we separate the whole balance control problem
into two parts, the control in the longitudinal direction
and that in the lateral direction respectively, and take the
control in the longitudinal direction as example. Thus any
GRF can be determined uniquely by a horizontal force, a
vertical force, and an angular torque relative to the CoM.
AMPM simpliﬁes the humanoid robot as a momentum-
included mass component with a massless leg connecting
the CoM and CoP (Center of Pressure). The horizontal and
vertical accelerations of the CoM and the torque exerted
on the CoM are corresponding with the three components
of the GRF respectively. Based on the relationship above,
different with the virtual models deﬁned in [16], we propose
an AMPM-based virtual model. It consists of three spring-
damper components, each of which is correspondent with
a component of GRF. Using the correspondence between
AMPM and GRF, constraints of the model can be easily
determined.
According to the concept of the CP/CR (Capture Region)
introduced by Jerry Pratt [11], we can get the premise of
standing maintenance algorithm: an intersection region must
be shared between the CP/CR and the support polygon. This
means the generated virtual force should prevent the robot’s
feet from rolling over or slipping off. In order to ensure this,
constraints must be applied to the virtual force and adapt
to the status of robot. Here, we introduce a variable gain
into the virtual force model, which is a function of CP. CP
is a favorable norm to assess the stability of robots in the
view of the premise of standing maintenance. When the CP
locates near to the center of the support area, the horizontal
2298
component of the GRF needs to be large enough so that
the robot can recover fast, while when the CP is close to
the edge of the support area, the horizontal component of
the GRF should be limited to meet the constraints of the
GRF. In other words, CP has a closely relationship to the
permissibleGRF.Inaddition,becausetheCPrepresentsboth
the location and velocity of the CoM, it has a phase advance
to the CoM. When the robot is recovering from disturbances
towards the equilibrium position, the CP will move to the
center of support area before the CoM arrived. This means
an earlier deceleration can be presented by using the CP as
the argument of the variable gain function than that by using
the CoM.
B. AMPM-based Force Analysis
AMPMisanextensionofIPM(InvertedPendulumModel)
by expanding the mass point to a momentum included mass
component [13]. Based on the AMPM, the force and torque
acting on the robot are shown as Fig. 1(a). The GRF F
g
is
orthogonally decomposed into horizontal component F
x
and
vertical component F
z
. If only considering the motion of the
CoM, the AMPM is equivalent to the IPM which is shown as
Fig. 1(b). The virtual leg connecting the virtual CoP and the
CoM is parallel to the direction of F
g
. Fig. 2 illustrates the
deﬁnition of the coordinate frame, which takes the projection
of CoM’s equilibrium position on the ground as the origin,
and the important parameters of the dynamic model. Table I
explains the symbols in Fig. 2.
Fx
x
z
? 
? 
Fz Fg
(a)
? 
Virtual CoP Real CoP
(b)
Fig. 1. AMPM-based force analysis and its equivalent model. (a) AMPM-
based force analysis; (b) equivalent model describing the CoM movement
mg
F z
F x
?
l
x/F x
z/F z
?/? 
? 
x
z
m,J
x cop
O
x Edga1 x Edga2
Support Area
? 
F g
Positive direction of coordinates
Vector of forces
Vector of position or angle
Scalar of distance
Vector of equivalent forces and 
torque
Fig. 2. Parameters of the dynamic model
From the force point of view, the dynamic equations can
TABLE I
DEFINITIONS OF THE SYMBOLS IN FIG. 2
Symbol Deﬁnition
m total mass
J rotational moment to CoM
x
Edge1
back edge of support area
x
Edge2
font edge of support area
 body attitude angle
 rotation angle of virtual leg
x horizontal position of CoM
z vertical position of CoM
xcop horizontal position of CoP
l length of virtual leg
Fg ground reaction force
Fx horizontal component of GRF
Fz vertical component of GRF
 torque of GRF relative to CoM
g acceleration of gravity
be written as follow:
m x = F
x
(1)
m z = F
z
 mg (2)
J

 =  = (F
z
sin F
x
cos)l (3)
C. Derivation of the Virtual Model
The proposed virtual model for standing maintenance
control is shown as Fig. 3(a). The virtual model can be
decomposed into three spring-damper components in rota-
tional, vertical and horizontal directions respectively, which
are shown as Fig. 3(b), 3(c) and 3(d), in sequence.
x
z
=
? 
(a)
z
?0 
= +
(b)
z0
+ +
(c)
x0
+
(d)
Fig. 3. Proposed virtual model and its three components. (a) overview
of the virtual model; (b) the sprint-damping component in rotational()
direction; (c) the spring-damping component in vertical(z) dircetion; (d)
the spring-damping component in horizontal(x) direction
As the discussion in Section III.A, the gains of the three
components are deﬁned as the function of CP, the output of
which should decrease when the distance from the CP to the
origin increases. Thus, we use the Gaussian Function as the
variable gain function. Taking x direction as an example, we
have:
g(x
cp
;a;b;D) = ae
 x
2
cp
=b
2
+D (4)
where x
cp
is the position of the CP in x direction, x
cp
= x+
_ x
√
z
g
, a;b are parameters of the Gaussian Function, which
determines the peak value of gain and the width of high gain
area respectively, D is an offset, which settles the base value
of gain, g(x
cp
;a;b;D)2 (0;1].
For each spring-damper component, we have
f(p;p
0
;k;c) = k(p p
0
) c_ p (5)
where p is the current position of the spring-damper end-
point, p
0
is the equilibrium position of the spring-damper
2299
endpoint, _ p is the velocity of the spring-damper endpoint, k
is the spring constant, c is the damping coefﬁcient.
Then, by combining the variable gain function, we get the
ideal output without the GRF constraints:

?
= g(x
cp
;a
1
;b
1
;D
1
)f(;
0
;k
1
;c
1
) (6)
 z
?
= g(x
cp
;a
2
;b
2
;D
2
)f(z;z
0
;k
2
;c
2
) (7)
 x
?
= g(x
cp
;a
3
;b
3
;D
3
)f(x;x
0
;k
3
;c
3
) (8)
where 
?
; z
?
;  x
?
are ideal rotational torque of the body,
vertical and horizontal accelerations of the CoM, a
1
;b
1
;D
1
are gain function parameters in  direction, a
2
;b
2
;D
2
are
gain function parameters in z direction, a
3
;b
3
;D
3
are gain
function parameters in x direction, 
0
;z
0
;x
0
are expected
positions in ;z;x directions, k
1
;k
2
;k
3
are spring constants
, c
1
;c
2
;c
3
are damping coefﬁcients.
The virtual model outputs should satisfy the following
robot’s mechanical and GRF constraints:
 2 [
min
;
max
] (9)
 z 2 [ z
min
; z
max
] (10)
x
cop
2 [x
Edge1
;x
Edge2
] (11)
where ; z;x
cop
are body rotational torque, vertical accel-
eration of the CoM and position of the CoP, 
min
;
max
are minimum and maximum body torque,  z
min
; z
max
are
minimum and maximum vertical acceleration of the CoM.
Usingthedynamicequations(1)s(3)oftheAMPMmodel
and sin =
x xcop
l
;cos =
z
l
;l =
√
(x x
cop
)
2
+z
2
, we
get:
x
cop
= x 
 x
g +  z
z 

m(g +  z)
(12)
Substituting (12) into the constraint (11), we get the con-
straint of the horizontal acceleration of the CoM  x:
 x2 [ x
min
;  x
max
] (13)
where
 x
min
=(x x
Edge2
 

d
m(g +  z
d
)
)(
g +  z
d
z
) (14)
 x
max
=(x x
Edge1
 

d
m(g +  z
d
)
)(
g +  z
d
z
) (15)
Using 
?
and  z
?
from (6)s(7) to replace  and  z in the
constraints (9)s(10), we can get the desired body torque

d
, vertical acceleration of the CoM  z
d
. Using 
d
and  z
d
to
replace and  z in(14)s(15)andusing  x
?
from(8)toreplace
 x in the constraint (13), we can get the desired horizontal
acceleration of the CoM  x
d
. So, the desired outputs of the
virtual model:

d
=
8
>
<
>
:

min

?
< 
min

?

min
 
?
 
max

max

max
< 
?
(16)
F
d
z
= m z
d
+mg =
8
>
<
>
:
m z
min
+mg  z
?
<  z
min
m z
?
+mg  z
min
  z
?
  z
max
m z
max
+mg  z
max
<  z
?
(17)
F
d
x
= m x
d
=
8
>
<
>
:
m x
min
 x
?
<  x
min
m x
?
 x
min
  x
?
  x
max
m x
m
ax  x
max
<  x
?
(18)
where F
d
z
;F
d
x
are desired virtual forces in vertical and
horizontal direction respectively.
IV. AMPM-BASED ADMITTANCE CONTROL
A. Controller Structure
The virtual model describes the desired impedance of
the standing maintenance control. There are two approaches
to realize the desired impedance: Impedance Control and
Admittance Control, which are distinguished by the input
andoutputvariables.TheImpedanceControlleracceptsforce
inputs and determines its motion in response, while the
Admittance Controller accepts motion inputs and determines
its force in response[17]. A position controlled humanoid
robot is driven by joints position commands, which means
the desired impedance can be implemented in the admittance
form.WeadoptanAMPM-basedintegratortogetthedesired
angle of the body posture and position of the CoM.
The overview of the controller is shown as Fig. 4, where
the position controlled system includes the robot system
and the forward and backward kinematics calculation. In
this structure, the inputs and outputs of the controller are
the same variables. We can easily determine whether the
external disturbance happened by comparing the actual and
previously desired posture angle and CoM, which helps to
achieve a fast response to external disturbances and realize
precise control over the impedance.
Desired 
impedance
Admittance 
Controller
F
d
IMU
CoM
Position 
Controlled 
System
Desired 
impedance
Admittance 
Controller
F
d
AMPM based Admittance Controller
CoM
d
IMU
d
Desired 
equilibrium
d
Fig. 4. Overview of the controller
B. Calculation of Desired Impedance
The controller use the proposed virtual model control to
get the desired impedance. Without external disturbance,
there are only two forces applied on the robots. One is
the GRF and the other one is the gravity. The gravity of
the robot has constant magnitude and direction, and zero
torque respect to the CoM. Therefore, when the external
disturbance is absent, the motion of robots can be determine
by the GRF, which means we can control the GRF to get
our desired impedance. Based on the deﬁnition of the three
spring-damper components, we can get the desired body
torque , vertical force F
z
and horizontal force F
x
which are
presented as (16)s(18). The desired torque/forces response
conform the desired impedance.
C. Desired Impedance Implement
We use an AMPM-based integrator to implement the
desired impedance. The integrator accepts the desired
torque/forces from the virtual model as input and solves for
2300
the desired position of the CoM and the posture angle of the
body as output. Based on the AMPM, we can get expression:
2
4

d
z
d
x
d
3
5
=
∫
T
0
0
@
∫
T
0
2
4


d
 z
d
 x
d
3
5
dt+
2
4
_

_ z
_ x
3
5
1
A
dt+
2
4

z
x
3
5
(19)
where 
d
is desired attitude angle, z
d
;x
d
are desired vertical
and horizontal position, and
2
4


d
 z
d
 x
d
3
5
=
2
6
4
F
d
x
m
F
d
z
m
 g

d
J
3
7
5 (20)
V. EXPERIMENTAL RESULTS
A. Humanoid Platform
To test our algorithm, experiments are conducted on the
humanoid robot ’Kong’ as shown in Fig. 5(a). The robot
is 161 cm in height with a total mass of 53 kg and 14
DOFs (Degree of Freedom), where 6 DOF in each leg and
2 DOF in the waist. The main constrains and parameters of
our algorithm are listed in Table II.
An IMU (Inertia Measurement Unit) is mounted at the
middle of the waist to measure the body posture. Each joint
is equipped with an encoder to read its angle. A 6-axis
force/torque sensor is installed between the ankle and the
foot in each leg to record the real GRF and torque for data
analysis.Inordertomeasurethestrengthofthedisturbances,
we installed a same force/torque sensor at the endpoint of the
disturbance device (shown as Fig. 5(b)). The measurement
of disturbance is only used for data comparison. It is totally
unknown to the controller.
TABLE II
MAIN CONSTRAINS AND CONTROL SETTINGS
m  53kg 
0
= 0:000rad 
min
=  50rad=s
2
J  0:3kgm
2
z
0
= 0:815m max = 50rad=s
2
x
Edge1
=  0:10m x
0
= 0:000m  z
min
=  2m=s
2
x
Edge2
= 0:13m  zmax = 2m=s
2
T = 20ms
Ts = 10ms
T is the control period. Ts is the sampling period.
(a)
External fore/torque 
sensor (blue)
(b)
Fig. 5. Humanoid platform and disturbance device. (a) The humanoid
’Kong’; (b) The disturbance device with a force/torque sensor
B. Balance under Unknown Push
Balance experiment under unknown push was conducted
to demonstrate the compliance and stability of proposed
standing maintenance controller under push disturbances.
The values of the virtual model parameters, which were
manually modiﬁed based on their deﬁnition and effect, are
listed in Table III.
Fig. 6 is the impact disturbances applied on the humanoid.
Usingthebodyattitudeangleandjointangles,themovement
of the CoM, the angle of feet, as well as the position of the
CP are calculated. Fig. 7 shows the horizontal position and
velocity of the CoM and the position of the CP. The rotation
angle of the feet is shown in Fig. 8. Using these information,
the virtual model calculates the desired GRF which satisﬁes
the constraints. The AMPM-based integrator transforms the
virtual force into the motion of the CoM and the body
attitudeangle.TherealGRFandtorquesaremeasuredbythe
6-axis force/torque sensors equipped at the robots feet and
transformed into world coordinate frame according to the
calculated feet angle. Fig. 9 compares the desired horizontal
GRF F
d
x
and the measured horizontal GRF F
m
x
. Fig. 10
compares the desired vertical GRF F
d
z
and the measured
vertical GRF F
m
z
. Fig. 11 compares the desired body torque

d
and the measured body torque 
m
. Fig. 12 shows the
humanoid recovery after the 4
th
impact disturbance.
The comparison of the desired GRF/torque and the mea-
sured GRF/torque in three directions proves that the desired
impedance is well realized. By looking into the data we
collected, we discover that, when the robot suffered from
external disturbances or had a relatively obvious foot angle,
the error between desired and measured force/torque would
be enlarged. It is easy to understand that the external dis-
turbances applied on the robot causing the following error
of the desired force because the desired impedance calcu-
lation assumed only GRF and gravity applied on the robot.
There are two reasonable explanation for the following error
occurred when the rotation angle of foot is relatively large.
One is the underactuation between feet and ground,which
produces an uncontrollable torque on the feet. Because the
force/torque sensors are installed between feet and ankles,
this additional torque is unmeasurable. When the rotation
angle of the foot is relatively large, its rotational velocity
is also relatively large, which enlarges the following error.
Another explanation is the error of foot angle measurement
leads to the error of gravity compensation and coordination
transformation which ﬁnally causes the following error of
desired force.
TABLE III
PARAMETERS’ VALUE OF THE VIRTUAL MODEL WITH VARIABLE GAIN
FOR THE EXPERIMENT OF EXERTING PUSH DISTURBANCE
a
1
= 0.87 a
2
= 0.67 a
3
= 0.87
b
1
= 0.03 b
2
= 0.07 b
3
= 0.03
D
1
= 0.13 D
2
= 0.33 D
3
= 0.13
k
1
= 3.47 k
2
= 12.00 k
3
= 4.22
c
1
= 5.79 c
2
= 18.00 c
3
= 8.44
2301
0 5 10 15 20
?100
0
100
200
Disturbance
Time(s)
Force(N)
 
 
Impacts
Fig. 6. The impact disturbances
0 5 10 15 20
?0.2
?0.1
0
0.1
0.2
Position of CapturePoint(x), CoM(x),
and Velocity of CoM(x)
Time(s)
Position(m)
\ Velocity(m/s)
 
 
CP(x)
CoM(x)
Velocity(x)
Fig. 7. The position and velocity of the CoM in horizontal direction and
the position of the CP
0 5 10 15 20
?0.02
0
0.02
0.04
0.06
Foot Angle
Time(s)
Angle(rad)
 
 
Foot Angle
Fig. 8. The angle between feet and ground
0 5 10 15 20
?100
?50
0
50
Desired GRF(x)?Measured GRF(x)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 9. The desired and measured GRF horizontal components
0 5 10 15 20
490
500
510
520
530
540
Desired GRF(z)?Measured GRF(z)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 10. The desired and measured GRF vertical components
0 5 10 15 20
?50
0
50
Desired Torque(y)?Measured Torque(y)
Time(s)
Moment(Nm)
 
 
Desired
Measured
Fig. 11. The desired and measured GRF torque relative to the CoM
Fig. 12. The humanoid recovery of the 4
th
impact disturbance
C. Comparison between the Variable and Fixed Gain
In Section III.A, we have discussed why a variable gain is
needed. The advantage of the variable gain is to decrease
the possibility of the feet rolling over. Because of the
underactuation between feet and ground, feet rolling will
causeundesiredtorqueatthecontactpointofthefeetandthe
ground and leads to the following error of the desired GRF.
Serious feet rolling may lead to oscillation of the robot and
the divergence of the controller.
To evaluate the effectiveness of the variable gain, com-
parison experiment using ﬁxed gain is conducted. Three
appropriate ﬁxed gains are selected based on the range of
the former variable gains. The values of the spring constant
and damping coefﬁcient are listed in Table IV. Fig. 13 is the
impact disturbances applied on the robot. Fig. 14 shows the
horizontal position and velocity of the CoM and the position
of the CP. The rotation angle of the feet is shown in Fig. 15.
Fig. 16 compares the desired horizontal GRF F
d
x
and the
measured horizontal GRF F
m
x
. Fig. 17 compares the desired
vertical GRFF
d
z
and the measured vertical GRFF
m
z
. Fig. 18
compares the desired body torque 
d
and the measured body
torque
m
.Undersimilarstrengthimpacts,likelastimpactin
Fig.6andpenultimateimpactinFig.13,thereissmallerfoot
angle maximum during recovery when use the variable gain
than that of the ﬁx gain. Comparing the foot angle curve of
thesetwoimpacts,wecanﬁgureoutthattheimpactresponse
decayratioofvariablegainsystem,about5:1,issigniﬁcantly
larger than that of ﬁxed gain system, about 3:1, which means
a better stability of robot. At the last impact, the robot using
ﬁxed gain virtual model tends to diverge. As expected, the
result of experiment demonstrated the variable gain bring
a stabler performance of impact disturbance recovery. It’s
because the variable gain utilizes the interrelation of CP-
GRF and CP-CoM described in Section III.A.
TABLE IV
PARAMETERS’ VALUES OF THE VIRTUAL MODEL WITH FIXED GAIN
k
1
= 1.58 k
2
= 12.00 k
3
= 1.92
c
1
= 2.64 c
2
= 18.00 c
3
= 3.85
D. Balance on Changing Slope
The proposed controller is also suitable for robot standing
maintenancecontrolwhenthegroundisnottotallyhorizontal
and changing with time. The appropriate values of the virtual
2302
0 5 10 15 20
?50
0
50
100
150
Disturbance
Time(s)
Force(N)
 
 
Impacts
Fig. 13. The impact disturbances
0 5 10 15 20
?0.4
?0.2
0
0.2
0.4
Position of CapturePoint(x), CoM(x),
and Velocity of CoM(x)
Time(s)
Position(m)
\ Velocity(m/s)
 
 
CP(x) CoM(x) Velocity(x)
Fig. 14. The position and velocity of the CoM in horizontal direction and
the position of the CP
0 5 10 15 20
?0.1
0
0.1
0.2
0.3
Foot Angle
Time(s)
Angle(rad)
 
 
Foot Angle
Fig. 15. The angle between feet and ground
0 5 10 15 20
?100
?50
0
50
100
Desired GRF(x)?Measured GRF(x)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 16. The desired and measured GRF horizontal components
0 5 10 15 20
480
500
520
540
560
580
Desired GRF(z)?Measured GRF(z)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 17. The desired and measured GRF vertical components
0 5 10 15 20
?100
?50
0
50
100
Desired Torque(y)?Measured Torque(y)
Time(s)
Moment(Nm)
 
 
Desired
Measured
Fig. 18. The desired and measured GRF torque relative to the CoM
model parameters are listed in Table V. Fig. 19 shows the
horizontal position and velocity of the CoM and the position
of the CP. The rotation angle of the feet is shown in Fig. 20.
Fig. 21 compares the desired horizontal GRF F
d
x
and the
measured horizontal GRF F
m
x
. Fig. 22 compares the desired
vertical GRF F
d
z
and the measured vertical GRF F
m
z
. Fig.
23 compares the desired body torque 
d
and the measured
body torque 
m
. Fig. 24(a) shows the process of the ground
slope increasing from zero degree and Fig. 24(b) shows the
process of the ground slope decreasing to zero degree. We
discover that in Fig. 21, 22 and 23, curves are oscillatory.
These oscillations are mostly caused by the oscillation of
disturbance force/torque. As the Fig. 24(a) and 24(b) shown,
the operator cannot keep slope at a certain angle or change
it at a certain velocity. The high frequency disturbance lead
the oscillatory of measured GRF/torque and the error of
desired force/torque following. However, from the data of
CoM and CP, we still can draw the conclusion that the
proposed method is effective in balancing on changing slope.
TABLE V
PARAMETERS’ SETTING OF THE VIRTUAL MODEL WITH VARIABLE GAIN
FOR EXPERIMENT OF CHANGING GROUND SLOPE
a
1
= 0.68 a
2
= 0.67 a
3
= 0.68
b
1
= 0.04 b
2
= 0.07 b
3
= 0.07
D
1
= 0.32 D
2
= 0.33 D
3
= 0.32
k
1
= 1.24 k
2
= 12.00 k
3
= 4.22
c
1
= 3.72 c
2
= 18.00 c
3
= 12.66
0 10 20 30 40 50
?0.1
?0.05
0
0.05
0.1
Position of CapturePoint(x), CoM(x),
and Velocity of CoM(x)
Time(s)
Position(m)
\ Velocity(m/s)
 
 
CP(x) CoM(x) Velocity(x)
Fig. 19. The position and velocity of the CoM in horizontal direction and
the position of the CP
0 10 20 30 40 50
?0.2
?0.1
0
0.1
0.2
Foot Angle
Time(s)
Angle(rad)
 
 
Foot Angle
Fig. 20. The angle between feet and ground
VI. CONCLUSIONS
In this paper, we present a standing maintenance con-
trol algorithm for humanoid robots, which is composed
of an AMPM-based virtual model with variable gain and
an AMPM-based admittance controller. The virtual model
describes the desired impedance with GRF constraints. The
application of the variable gain helps greatly to decrease the
2303
0 10 20 30 40 50
?50
0
50
100
Desired GRF(x)?Measured GRF(x)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 21. The desired and measured GRF horizontal components
0 10 20 30 40 50
490
500
510
520
530
540
Desired GRF(z)?Measured GRF(z)
Time(s)
Force(N)
 
 
Desired
Measured
Fig. 22. The desired and measured GRF vertical components
possibility of feet rolling over and avoid the divergence of
the controller. Experiments conducted on the real humanoid
robot ’Kong’ validate the effectiveness of our method.
Next we will extend the proposed algorithm for stable
walking and make the parameters of the virtual model be
self-adaptive to the diverse tasks with optimal performance.
REFERENCES
[1] B. Stephens, “Humanoid push recovery,” in Humanoid Robots, 2007
7th IEEE-RAS International Conference on, ser. Humanoid Robots,
2007 7th IEEE-RAS International Conference on. IEEE, 2007, pp.
589–595.
[2] S.-H. Hyon, J. G. Hale, and G. Cheng, “Full-body compliant human-
humanoid interaction: balancing in the presence of unknown external
forces,” Robotics, IEEE Transactions on, vol. 23, no. 5, pp. 884–898,
2007.
[3] Z. Li, N. G. Tsagarakis, and D. G. Caldwell, “A passivity based
admittance control for stabilizing the compliant humanoid coman,” in
Humanoid Robots (Humanoids), 2012 12th IEEE-RAS International
Conference on. IEEE, 2012, pp. 43–49.
[4] K. Yokoi, F. Kanehiro, K. Kaneko, S. Kajita, K. Fujiwara, and
H. Hirukawa, “Experimental study of humanoid robot hrp-1s,” The
International Journal of Robotics Research, vol. 23, no. 4-5, pp. 351–
362, 2004.
[5] J.-Y. Kim, I.-W. Park, and J.-H. Oh, “Experimental realization of dy-
namic walking of the biped humanoid robot khr-2 using zero moment
point feedback and inertial measurement,” Advanced Robotics, vol. 20,
no. 6, pp. 707–736, 2006.
[6] J. Englsberger, C. Ott, M. A. Roa, A. Albu-Schaffer, and G. Hirzinger,
“Bipedal walking control based on capture point dynamics,” in In-
telligent Robots and Systems (IROS), 2011 IEEE/RSJ International
Conference on, ser. Intelligent Robots and Systems (IROS), 2011
IEEE/RSJ International Conference on. IEEE, 2011, pp. 4420–4427.
[7] T. Takenaka, T. Matsumoto, T. Yoshiike, T. Hasegawa, S. Shirokura,
H. Kaneko, and A. Orita, “Real time motion generation and control
for biped robot- 4
th
report: Integrated balance control,” in Intelligent
Robots and Systems, 2009. IROS 2009. IEEE/RSJ International Con-
ference on, ser. Intelligent Robots and Systems, 2009. IROS 2009.
IEEE/RSJ International Conference on. IEEE, 2009, pp. 1601–1608.
[8] R. Tajima, D. Honda, and K. Suga, “Fast running experiments involv-
ing a humanoid robot,” in Robotics and Automation, 2009. ICRA’09.
IEEE International Conference on, ser. Robotics and Automation,
2009. ICRA’09. IEEE International Conference on. IEEE, 2009, pp.
1571–1576.
[9] R. Tajima and K. Suga, “Motion having a ﬂight phase: Experiments
involving a one-legged robot,” in Intelligent Robots and Systems, 2006
IEEE/RSJ International Conference on, ser. Intelligent Robots and
Systems, 2006 IEEE/RSJ International Conference on. IEEE, 2006,
pp. 1726–1731.
0 10 20 30 40 50
?20
?10
0
10
20
Desired Torque(y)?Measured Torque(y)
Time(s)
Moment(Nm)
 
 
Desired
Measured
Fig. 23. The desired and measured GRF torque relative to the CoM
(a) The process of the ground slope increasing from zero degree
(b) The process of the ground slope decreasing to zero degree
Fig. 24. Snapshots of balancing under slope varying
[10] R. Xiong, Y. Sun, Q. Zhu, J. Wu, and J. Chu, “Impedance control
and its effects on a humanoid robot playing table tennis,” Int J Adv
Robotic Sy, vol. 9, no. 178, 2012.
[11] J. Pratt, J. Carff, S. Drakunov, and A. Goswami, “Capture point: A
step toward humanoid push recovery,” in Humanoid Robots, 2006 6th
IEEE-RAS International Conference on, ser. Humanoid Robots, 2006
6th IEEE-RAS International Conference on. IEEE, 2006, pp. 200–
207.
[12] J. Pratt, P. Dilworth, and G. Pratt, “Virtual model control of a bipedal
walking robot,” in Robotics and Automation, 1997. Proceedings., 1997
IEEE International Conference on, ser. Robotics and Automation,
1997. Proceedings., 1997 IEEE International Conference on, vol. 1.
IEEE, 1997, pp. 193–198.
[13] S. Kudoh and T. Komura, “c
2
continuous gait-pattern generation
for biped robots,” in Intelligent Robots and Systems, 2003.(IROS
2003). Proceedings. 2003 IEEE/RSJ International Conference on, ser.
Intelligent Robots and Systems, 2003.(IROS 2003). Proceedings. 2003
IEEE/RSJInternationalConferenceon,vol.2. IEEE,2003,pp.1135–
1140.
[14] M. Vukobratovi and J. Stepanenko, “On the stability of anthropomor-
phic systems,” Mathematical Biosciences, vol. 15, no. 1, pp. 1–37,
1972.
[15] J. Pratt, T. Koolen, T. De Boer, J. Rebula, S. Cotton, J. Carff,
M.Johnson,andP.Neuhaus,“Capturability-basedanalysisandcontrol
of legged locomotion, part 2: Application to m2v2, a lower-body
humanoid,” The International Journal of Robotics Research, vol. 31,
no. 10, pp. 1117–1133, 2012.
[16] R. Ekkelenkamp, P. Veltink, S. Stramigioli, and H. van der Kooij,
“Evaluation of a virtual model control for the selective support
of gait functions using an exoskeleton,” in Rehabilitation Robotics,
2007. ICORR 2007. IEEE 10th International Conference on, ser.
Rehabilitation Robotics, 2007. ICORR 2007. IEEE 10th International
Conference on. IEEE, 2007, pp. 693–699.
[17] N. Hogan, “Impedance control: An approach to manipulation,” in
American Control Conference, 1984, ser. American Control Confer-
ence, 1984. IEEE, 1984, pp. 304–313.
2304
