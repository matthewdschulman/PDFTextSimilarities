Increasing the Accuracy and the Repeatability of Position Control for
Micromanipulations Using Heteroscedastic Gaussian Processes
Yanyu Su
1
, Wei Dong
1
, Yan Wu
2
, Zhijiang Du*
1
, Yiannis Demiris
3
Abstract— Many recent studies describe micromanipulation
systems by using complex Analytic Forward Models (AFM),
but such models are difﬁcult to build and incapable of de-
scribing unmodelable factors, such as manufacturing defects.
In this work, we propose the Enhanced Analytic Forward
Model (EAFM), an integrated model of the AFM and the
Heteroscedastic Gaussian Processes (HGP). The EAFM can
compensate the shortfalls of the AFM by training the HGP on
the residual of the AFM. This also allows the HGP to learn the
repeatability of the micromanipulation system. Based on the
EAFM, we further contribute an optimal position controller
for improving the accuracy and the repeatability. This optimal
EAFM controller is implemented and tested on a three degree-
of-freedom micromanipulator based micromanipulation system.
Two sets of real-world experiments are carried out to verify
our method. The results demonstrate that the controller using
EAFM can statistically achieve higher accuracy and repeata-
bility than solely using the AFM.
I. INTRODUCTION
Micromanipulation systems (shown in Fig.1a), which usu-
ally consist of a tool and a micromanipnulator, have been
studied in various contexts. So far, increasing the accu-
racy and the repeatability of micromanipulation position
controllers still remains as a challenge. Three main kinds
of controllers are reported on this topic: 1) The feedback
controllers [1], which use feedback sensors, are model-free
but have the drawback of phase lag to apply in applica-
tions requiring high-frequency response. 2) The feed-forward
controllers [2], which generally construct a feed-forward
compensation scheme after building a model of the system,
do no have phase lag but need a very accurate model. 3)
The feed-forward approach has also been used with feedback
approaches to harness the advantages of both [3].
Building forward/inverse model of micromanipulation sys-
tems is the ﬁrst step towards designing a controller for
micromanipulation systems. Various analytic model along
with parameter identiﬁcation methods, such as [4], [6], [7],
have been investigated on this topic. However, such methods
are unable to describe the unmodelable factors, such as
manufacturing defects of the ﬂexure hinge as illustrated in
Fig. 1b. A promising solution for this problem is to learn the
1
Yanyu Su, Wei Dong and Zhijiang Du are with the State Key Lab-
oratory of Robotics and System, Harbin Institute of Technology, China.
suyanyu, dongwei, duzj01 at hit.edu.cn
2
Yan Wu is with Institute for Infocomm Research, Agency
for Science, Technology and Research, Singapore. wuy at
i2r.a-star.edu.sg
3
Yiannis Demiris is with Department of Electrical & Electronic Engi-
neering, Imperial College London, United Kingdom. y.demiris at
imperial.ac.uk
Fig. 1: The micromanipulation system of this work is shown in (a).
The system consists of a micromanipulator, a calibration block and a
capacitance gauge. The micromanipulator adjusts the mounted cali-
bration block to control the distance between the measurement point
and the capacitance gauge. (b) shows the inevitable manufacturing
defects which introduce unmodelable uncertainty to the system
resulting in the reduction of the accuracy and the repeatability of
the micromanipulator.
model of micromanipulation systems using machine-learning
methods.
There are at least two directions of research to learn
the model of the micromanipulation system: 1) model-free
methods which learn the system without any prior knowledge
[8]; 2) model-based methods which learn the residual of an
analytic model [9]. Although the ﬁrst approach produced
some successful examples, its learning complexity scales
drastically with the number of actuators involved. On the
other hand, to our knowledge, no literature uses the latter
approach considering the repeatability of micromanipulation
systems.
In this paper, we present an Enhanced Analytic Forward
Model (EAFM) to model a micromanipulation system using
a combination of the Heteroscedastic Gaussian Processes
(HGP) and a simple Analytic Forward Model (AFM). To
build the EAFM, we use the HGP to model the residual
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 4692
between the prediction of the AFM and the feedback data.
Unlike other machine learning methods either predicting
points (e.g. Supported Vector Machine) or providing the
predictive mean and distribution of a consistent variance
(e.g. Gaussian Processes), the HGP predicts the mean and
distribution of a possibly different variance at each point
of problem space. Therefore the HGP is an apt tool for
modelling the mean and the variance of the residual, which
represent the accuracy of the AFM and the repeatability of
the micromanipulation system respectively. In the EAFM,
the output mean of the HGP is used to compensate the AFM
on-the-ﬂy while the variance is used to indicate the system
repeatability.
We also address the optimal control problem of obtaining
maximum repeatability using the EAFM. If the microma-
nipulation system is redundant, it is possible to reach the
desired pose of the tool with different conﬁgurations. Given
the initial state and the desired pose of the tool, we apply an
optimal control approach to ﬁnd the optimal control signal
against the variance. Limited studies on micromanipulation
consider this problem. An approach with similar goal solely
uses analytic model to determine the best control policy
to gain high repeatability for industrial manipulators [10].
However, this method relies heavily on the analytic model
being accurate in order to identify the repeatability.
The rest of the paper is organised as follows: In Section
II we will present the proposed EAFM and the optimal
controller, followed by the application of this method on
a micromanipulation system described in Section III. We
will present the kinematic model of the micromanipulator
and implement the method on a simple calibration system
containing this micromanipulator. Two sets of experiments
and their results are detailed and discussed in Section IV.
II. METHODOLOGY
In this work, we consider the problem of position control
of the micromanipulation systems as shown in Fig.1a. We
assume the controller of the micromanipulator takes the input
of the pose (combination of position and orientation) of the
platform. We also assume the state of the micromanipulation
system is fully observable for training purpose.
A. Deﬁnitions
We model the micromanipulation system as a discrete-time
system in the form
ˆ s
k+1
= f(s
k
;u
k
)+e(s
k
;u
k
);
where u
k
denotes the current control signal deﬁned by
u
k
= p
k
;
with p
k
2 R
n
p
denoting the current pose of the platform
(n
p
2[1;n
p
] denoting the degree of freedom (DoF) of the
platform), s
k
denotes the state of the micromanipulation
system at current time step
s
k
=[t
T
k
q
T
k
]
T
;
which consists of the controlled pose of the tool t
k
2 R
n
t
(n
t
2[1;n
p
] denotes the DoF of the tool) and the displace-
ments of the actuators q
k
2 R
n
q
(n
q
denotes the number of
actuators), ˆ s
k+1
denotes the prediction of successor state. The
transition function f(s
k
;u
k
) and the noise function e(s
k
;u
k
)
respectively predict the successor state and noise from the
current state-action pair (s
k
;u
k
).
B. Learning the Transition Function and the Noise Function
In practice, the transition function is normally placed by
an AFM of the micromanipulation system (i.e. f(s
k
;u
k
)=
f
a
(s
k
;u
k
) with f
a
(s
k
;u
k
) denoting the AFM) and, the noise
function is normally assumed to follow a constant Gaussian
distribution (i.e. r(s
k
;u
k
)N (0;S) with S denoting a con-
stant diagonal matrix of the noise variance). However, there
are two limitations to these settings: the predictions of the
AFM usually have signiﬁcant errors due to the unmodelable
factors and, the noise usually does not follow the constant
Gaussian distribution noise model.
To overcome these limitations, we propose the EAFM
by respectively placing the transition function and the noise
function with
f(s
k
;u
k
)= f
a
(s
k
;u
k
)+ g
e
(s
k
;u
k
)
e(s
k
;u
k
)N (0;r
e
(s
k
;u
k
))
; (1)
where the function g
e
(s
k
;u
k
) predicts the residual of the
AFM, the function r
e
(s
k
;u
k
) describes the variance of the
noise. The noise function of EAFM is assumed to follow a
Gaussian distribution with zero mean and variable variance,
since ideally the residual of the EAFM should be zero but
the variance indicating the repeatability of the system could
be different at different states-action pairs. Therefore, by
regressing the functions g
e
(s
k
;u
k
) and r
e
(s
k
;u
k
), the system
is precisely modelled in the form
ˆ s
k+1
= f
a
(s
k
;u
k
)+ g
e
(s
k
;u
k
)+e
e
(s
k
;u
k
)
e(s
k
;u
k
)N (0;r
e
(s
k
;u
k
))
;
The underlying regression model should be capable of
describing the value and the distribution. We propose to
model the residual of the AFM with Heteroscedastic Gaus-
sian Processes (HGP). Consider the regression task where the
training dataset Dfx2 R
D
;y= y(x
i
)2 Rg
n
i=1
is modelled
as the sum of a latent function g(x) plus independent noise
e
i
y(x
i
)= g(x
i
)+e
i
:
A HGP is deﬁned by placing a GP prior on the latent function
g(x) and Gaussian priors on the noise terms e
i
g(x) GP(0;k
f
(x;x
T
))
e
i
N (0;r(x
i
))
; (2)
which is speciﬁed by the covariance function k
f
(x;x
T
) and
different possible variance r(x
i
) at each point x
i
.
In contrast to other regression methods, HGP regression
(HGPR) provides predictive distributions and is able to learn
the output noise with possibly input-dependent inconstant
variance from training data through likelihood maximisation.
4693
Fig. 2: The framework of the proposed controller for the microma-
nipulation. The dashed lines indicate the data ﬂow of the learning
process.
These features make HGPR attractive for learning the resid-
ual of the AFM, with the functions g
e
(s;u) and r
e
(s;u) in
(1) corresponding to the function g(x) and r(x) in (2) and
the training data deﬁned by
x=[s
T
u
T
]
T
y= t
0
  T
t
f
a
(s;u)
; (3)
where x and y are the input and output for training the HGP,
t
0
is the measurements of the controlled pose of the tool after
executing the control signal u, the matrix T
t
=[I
n
t
n
t
0
n
t
n
q
]2
R
n
t
(n
t
+n
q
)
transforms the state vector to the pose of the tool
with I
n
t
n
t
and 0
n
t
n
q
denoting the identity matrix and the
zero matrix.
In the literature, alternative HGPR methods include the
Markov chain Monte Carlo fully Bayesian method [11]
which is very slow in large scale applications and the
Maximum a Posteriori Approach [12] whose estimation does
not integrate all latent variables and is prone to overﬁtting. In
this work, we adopt the Variational Heteroscedastic Gaussian
Process Regression (VHGPR) presented in [13], a variational
inference method for HGPR based on variational Bayes and
the Gaussian approximation, to learn and predict the residual
of the AFM.
C. Optimal Controller with EFAM
Obtaining the maximum repeatability is a practically use-
ful goal in position control of micromanipulator. With the
EAFM, this goal can be considered as an optimal control
problem to ﬁnd the optimal control signal u

that minimizes
the expected variance of the noise
u

= arg min
u
1  e
 jjr
e
(s;u)jj
(4)
subject to the constraint that the predicted error should be
zero
jjt
d
  T
t
( f
a
(s;u)+ g
e
(s;u))jj= 0;
where t
d
denotes the desired pose of the tool.
Therefore, we construct the control framework shown in
Fig.2. Given the input of the desired pose of the tool t
d
,
the optimal controller generates the control signal u

(i.e.
required pose of the platform p
r
) by solving the optimal
control problem deﬁned in (4). Then the required movement
of the actuators q
r
is accounted by solving the inverse
kinematics of the micromanipulator subject to the required
pose of the platform p
r
. There are many optimization solvers
to solve the optimal problem. In this work, we adopted the
interior point algorithm [14].
III. CONTROL OF A MICROANIPULATOR
In this section, we apply the method presented in Section II
on a micromanipulation system which consists of a microma-
nipulator, a calibration block and a one channel capacitance
gauge, as shown in Fig. 1, to control the distance between
the calibration block and the capacitance gauge.
A. Inverse Kinematics of the Micromanipulator
The structural design of the micromanipulator, shown in
Fig.3b, consists of three parts: the Base, the PZTs and the
Cover. The Base contains four slots for mounting the PZTs.
On the bottom of these slots, four set-screws are used for
adjusting the height of the PZTs to preload the contact force
between the cover and the steel-balls located at the top of
the PZTs. The cover integrates the ﬂexure hinge and the
platform for mounting the tools (e.g. the calibration block).
The ﬂexure hinge will be detailed later.
With the structural described above, the PZTs drive the
platform by pushing the platform with the steel-balls. This
transmission mechanism follows the contact model. We
therefore apply the contact analysis method described in [15]
for the inverse kinematics of the micromanipulator under
the following assumptions: 1) Every steel-ball contacts the
platform at one and only one point, where there is a unique,
well-deﬁned tangential plane for deﬁning the normal vector.
2) The motion of the platform is small so the deformation
of the ﬂexure hinge is elastic.
The coordinate systems used in this work are illustrated in
Fig.3c: 1) The world framefNg is an inertial frame whose
origin is conveniently chosen at the geometric center of the
ﬂexure hinge. All quantities are expressed in the world frame
unless otherwise speciﬁed. 2) The platform framefPg is
ﬁxed on the platform with its origin located at the origin
of the world frame. 3) Let the steel-ball of the i-th PZT
contact the bottom plane of the platform at contact point
i with i= 1;2:::4 denoting the index of the PZTs. Let the
vector c
i
2 R
3
represents the position of the contact point i,
which can be approximately estimated using the Computer
Aided Design (CAD) model of the micromanipulator. 4) The
contact point i is chosen as the origin of the contact frame
fCg
i
with the axesfn
i
;o
i
;a
i
g, where the unit vector n
i
is
deﬁned normal to the contact tangential plane (the bottom
plane of the platform) and direct towards the platform, while
the selection of o
i
and a
i
is arbitrary.
The ﬂexure hinge is manufactured by cutting two stagger
rows of slits on the cover. This structure can be simpliﬁed
as a continuous beam supported by laterally and rotationally
ﬁxed supports. Since bending is the main mode of defor-
mation for a continuous beam, this enables the platform to
translate along z axis and rotate around x and y axis infNg.
4694
Fig. 3: Our micromanipulator is shown in (a) with its detailed structural design shown in (c). The micromanipulator consists of three
parts: the Base (coloured in green), 4 PZTs (red) and the Cover (grey), where the novel ﬂexure hinge shown in (b) located. The kinematic
model of the manipulator is shown in (d). The ﬂexure hinge is simpliﬁed as a three-DoF hinge and, the transmission mechanism between
the steel-ball and the platform is described using the contact model.
The ﬂexure hinge can therefore be simpliﬁed as a three-DoF
hinge, which sits at the geometric center of the ﬂexure hinge
with its motion described by p=[z;r
x
;r
y
]
T
. More precise
analysis on the ﬂexure hinge can be made using elastic
mechanics, however it is beyond this work.
With the equivalent hinge, we can build the kinematic
model of the manipulator as shown in Fig.3d. Let n =
[v
T
w
T
]
T
2 R
6
denote the twist of the platform, which is
composed of the translational velocity v2 R
3
and the angular
velocity w2 R
3
. It is constrained by the ﬂexure hinge,
n = J
h
˙ p; (5)
where the vector ˙ p=[˙ z ˙ r
x
˙ r
y
]
T
is the velocity of the ﬂexure
hinge, the matrix J
h
=[0
32
I
33
0
31
]
T
2 R
63
transforms
˙ q into the twist of the ﬂexure hinge. Therefore, the platform
has three actual DoF and, the motion of the ﬂexure hinge
can be adopted to describe the motion of the platform.
The twist of the platform n is mapped from the world
framefNg to the i-th contact framefCg
i
by
n
C
i;p
=
¯
R
i
T
P
T
i
n; (6)
where n
C
i;p
2 R
6
denotes the twist of the platform expressed
in the i-th contact framefCg
i
, P
i
2 R
66
is the matrix
P
i
=

I
33
0
S(c
i
) I
33

;
which relates the twist of platform n and the twist of the i-th
Contact Point on the Platform (CPP) with the cross-product
function S given a three-element vector r=[r
1
r
2
r
3
]
T
,
S(r)=
0
@
0  r
3
r
2
r
3
0  r
1
 r
2
r
1
0
1
A
;
the matrix
¯
R
i
2 R
66
translates the twist of the CPP from the
world framefNg to the i th contact framefCg
i
,
¯
R
i
= Blockdiag(R
i
;R
i
)=

R
i
0
0 R
i

;
where matrix R
i
=[n
i
o
i
a
i
]2 R
33
is the orientation of the i-
th contact framefCg
i
and, the function Blockdiag constructs
block diagonal matrix from arguments of matrices.
Let ˙ q=[ ˙ q
1
˙ q
2
˙ q
3
˙ q
4
]
T
represent the velocities of the PZTs,
where ˙ q
i
2 R denotes the velocity of the i-th PZT. It is related
to the twist of the i-th Contact Point on the Steel-ball (CPS)
with the equation
n
C
i;t
=
¯
R
i
T
J
i
˙ q; (7)
where n
C
i;t
2 R
6
is the twist of the i-th CPS expressed in the
i-th contact framefCg
i
, J
i
2 R
64
is the Jacobian that maps
the velocities of the PZTs to the twist of the i-th CPS, which
is also translated from the world framefNg to the respective
contact framefCg
i
by left multiplying the matrix
¯
R
i
T
.
Since the contact patch between the platform and each
steel-ball is small and slippery, in this work, we adopt the
frictionless point-contact model for the contact constraints
between the platform and the steel-balls. With this model,
only the normal component of the translational velocity
of the contact point on the stee-lball is transmitted to the
platform, that is,
H
i
(n
C
i;t
 n
C
i;p
)= 0; (8)
where H
i
=[1 0 0 0 0 0].
It is practical to substitute (6), (7) into (8) and stack into
a compact notation
H(
¯
R
T
J ˙ q 
¯
R
T
P
T
n)= 0; (9)
4695
where
H = Blockdiag(H
1
;H
2
;H
3
;H
4
)
¯
R
T
= Blockdiag(
¯
R
1
T
;
¯
R
2
T
;
¯
R
3
T
;
¯
R
4
T
)
J =

J
T
1
J
T
2
J
T
3
J
T
4

T
P
T
=[P
1
P
2
P
3
P
4
]
T
When HR
T
J2 R
44
is invertible, the inverse kinematics
is obtained from (9) in the form of
˙ q=((H
¯
R
T
J)
 1
H
¯
R
T
p
T
)n;
where the twist of the platform n has to fulﬁl the constraint
deﬁned in (5) or, equivalently we can substitute (5) into (10),
˙ q=((HR
T
J)
 1
HR
T
p
T
)P
T
j
J
h
˙ p; (10)
which maps the twist of the ﬂexure hinge to the velocities
of the PZTs.
Since (10) is obtained using the screw theory, its results
are also applicable for the inﬁnitessimal motions,
dq=((HR
T
J)
 1
HR
T
p
T
)P
T
j
J
h
d p; (11)
where dq = [dq
1
dq
2
dq
3
dq
4
]
T
2 R
4
and dq =
[dz dr
x
dr
y
]
T
2 R
3
respectively denote the inﬁnitessimal
motions of the PZTs and the ﬂexure hinge.
The displacement of the ﬂexure hinge in a micromanipu-
lation is small enough to be considered as an inﬁnitessimal
motion. So given the initial value p
0
and q
0
, the required
movement of PZTs for moving the ﬂexure hinge to a desired
pose is accounted for by solving (11) subject to dq= q q
0
and d p= p  p
0
. The initial state is normally set to zero,
that is, p
0
= 0 and q
0
= 0, therefore,
q=((HR
T
J)
 1
HR
T
p
T
)P
T
j
J
h
p: (12)
B. Implementation of the Controller
The method presented in Section II is implemented and
tested on our micromanipulator. The ﬁrst prototype of our
micromanipulator has some manufacturing defects, which
makes it a very suitable application of the proposed method.
1) Observation of the pose of the Tool: We used a one
channel capacitance gauge (i.e. Micro-Epsilon RS6500) to
measure the movement of the tool (calibration block). The
measurement range and the sensitivity of capacitance gauge
is respectively 200 um and and 0:0006 um. To maximally use
the device to measure the movement of the calibration block,
we choose a measurement point 50mm away from the center
of the platform.
2) AFM: Since the calibration block is mounted on the
platform, the distance between the calibration block to the
capacitance gauge is related to the pose of the platform by
t= T
s
(P
T
t
J
h
p+t
0
); (13)
where t2 R is the pose of the calibration block, the matrix
P
t
maps the inﬁnitessimal motion of the platform to the
calibration block
P
t
=

I
33
0
S(t
0
) I
33

;
TABLE I: Parameters of the Implementation
Symbol Equation Value Unit
c
1
(6) [15; 0; 5]
T
mm
c
2
(6) [0; 15; 5]
T
mm
c
3
(6) [ 15; 0; 5]
T
mm
c
4
(6) [0; 15; 5]
T
mm
t
0
(14) [50cos(145

); 50sin(145

); 10]
T
mm
and the matrix T
s
= [0 0 1 0 0]
T
maps the pose of the
calibration block to its distance to the capacitance gauge,
t
0
is the initial pose of the calibration block. Therefore, by
combining (12) and (13) the AFM is gained in the form
s=

t
q

=

T
s
(P
T
t
J
h
p+t
0
)
((HR
T
J)
 1
HR
T
p
T
)P
T
j
J
h
p

2 R
5
: (14)
with parameters listed in Tab.I.
3) Position Control of PZTs: We used two PZT servo
drivers to control the PZTs. Each driver has three channels
(one channel for each PZT). The driver takes the input of
the desired displacement and uses a PID controller to follow
the input. The parameters of the drivers are tuned to the
PZTs before the experiments. The accuracy of the driver is
0:01 um. The motion range of the PZTs is 0 38 um, but
we took the range of 0 32 um for safety reason.
IV. EXPERIMENTS AND RESULTS
Referring to the general methods for testing the accuracy
and the repeatability of a robot, we conducted two exper-
iments to investigate: how the EAFM improves the accu-
racy over the AFM (the Absolute Movement Experiment)
and how the proposed method improves the accuracy and
the repeatability of the system (the Incremental Movement
Experiment).
A. Experiment Setup
The experiment environment is shown in Fig. 4. Before
training and the experiments, we measured the repeatability
of the capacitance gauge, which is1 um in the experiment
environment. We trained the HGP with 125 randomly gen-
erated control signals evenly distributed in the workspace
before the experiments.
B. Performance Evaluation Metrics
We introduced four performance metrics to evaluate the
performance of the controller quantitatively.
1) Prediction Error of Forward Model (PE): The pre-
diction error of the EAFM e
m;e
and the AFM e
m;a
can be
measured using the difference between their predictions and
the feedback controlled pose of the tool
e
m;a
=jt
0
  f
a
(s;u)j
e
m;e
=jt
0
  f
a
(s;u)  g
e
(s;u)j
:
4696
Fig. 4: The experiment environment is shown in (a). The host of
the capacitance gauge is not put on the operation table therefore not
shown in the ﬁgure. (b) details the probe of the capacitance gauge
and the calibration block.
2) Mean of Steady-State Error (MSSE): The Steady-State
Error (SSE) of the controller is a commonly used metric for
the accuracy of controllers. In this paper, we calculate the
SSE e
s
(t
d
) at a desired controlled pose of the tool t
d
by
e
s
(t
d
)= t
d
 t
f
;
where t
f
is the feedback of the controlled pose of the tool. To
statically describe the result of the trials, we use the average
of the SSE values at the same desired pose e
s
(t
d
) to measure
the accuracy of the controller.
3) Variance of Steady-State Error (VSSE): We use the
variance of the SSE values at the same desired pose e
s
(t
d
)
to measure the repeatability of the controller.
4) Hypothesis Testing: To statistically evaluate the hy-
pothesis that EAFM improves the performance of micro-
manipulation over AFM in terms of the accuracy and the
repeatability, we applied the standard two-sample t-test on
the MSSE and the VSSE of the EAKM controller against
that of the AFM controller.
C. Absolute Movement Experiment
In this experiment, we check how the EAFM improves the
prediction in the terms of accuracy. 30 control signals evenly
covering the workspace, denoted by u
t
=fu
t;1
; u
t;2
::: u
t;30
g,
were randomly generated for conducting absolute movements
from the initial position (i.e. u
t;0
=[0;0;0]
T
), i.e. the platform
was sequentially assigned to move the desired control signals
of u
d
=fu
t;0
; u
t;1
;u
t;0
; u
t;2
; :::u
t;0
; u
t;30
g in each trial. These
desired control signals are used to account for the commands
sending to the PZTs drivers. 2 trials were conducted for each
point.
The feedback value and the predictions of the AFM and
EAFM are shown in Fig.5a. We can see that the feedbacks
are all in the area speciﬁed by the predictive mean and
Fig. 5: The feedback and the predictions of the AFM and EAFM
in the Absolute Movement Experiment are shown in (a). The solid
red line is the predictive mean of EAFM (i.e. g
e
(s;u)) and the light
red area represents the predictive variance of EAFM (i.e. g
e
(s;u)
r
e
(s;u)). The prediction errors of AFM and EAFM is shown in (b).
TABLE II: Statistical Results of Incremental Movement Experi-
ment
Method 7 um 14 um 21 um 28 um Unit
MSSE AFM 1.2 3.1 3.0 5.2 mm
MSSE EAFM 0.3 0.7 0.6 0.9 mm
VSSE AFM 0.3 3.1 4.5 8.0 mm
2
VSSE EAFM 0.14 0.15 0.5 3.5 mm
2
variance of EAFM (i.e. g
e
(s;u) r
e
(s;u)), which indicates
that the EAFM can correctly describe the inaccuracy and
the inconsistency of the system.
The PEs of both AFM and EAFM are shown in Fig.5b. We
can see that the PEs of the EAFM are smaller than those of
the AFM for all points. We further applied t-test respectively
on the PEs of both models and, the result indicates that
the PE of the EAFM is statistically smaller than that of the
EAFM controller with signiﬁcance level ofa= 0:05 (P-value
p= 1x10
 6
).
D. Incremental Movement Experiment
In each trial of this experiment, 4 points (7,14,21,28 um)
at equal distance covering the workspace were selected for
conducting continuous movements beginning from the initial
position, that is, the controller was sequentially assigned to
reach the desired positions of t
d
=f0; 7; :::28g in each trail.
10 trials were conducted in the experiment.
The SSE of both AFM and EAFM controllers are shown
in Fig.6. We can see that the EAFM controller outperformed
the AFM in nearly all trials. The only exception is the “28
um” in Trial 4.
The respective statistical results are shown in Tab. II.
Both the MSSEs and the VSSEs of the EAFM controller
are smaller than those of the AFM controller. We further
4697
Fig. 6: The Steady-State Error of the controller using AFM and EAFM in the incremental movement experiment.
applied t-test respectively on the ESSEs and VSSEs of
both controllers, the result indicates that the ESSEs of the
EAFM controller is statistically smaller than that of the
AFM controller with signiﬁcance level of a = 0:05 (P-
value p= 0:01) and the VSSEs of the EAFM controller is
statistically smaller with signiﬁcance level of a = 0:05 (P-
value p= 0:07).
V. CONCLUSION
In this paper, we contributed an Enhanced Analytic
Froward Model (EAFM) for a micromanipulatioin system, an
integrated model of the Analytic forward Model (AFM) and
the Heteroscedastic Gaussian Processes (HGP). The EAFM
can compensate the error of the AFM by training the HGP
on the residual of the AFM. Our experimental results showed
that the EAFM produces more accurate predictions over the
AFM. The EAFM is also be capable to model the variance of
the feedback measurements, which indicates the repeatability
of the system. The EAFM is applied to an optimal con-
troller to increase the accuracy and the repeatability of the
micromanipulatioin system. Our experimental results show
the optimal controller with EAFM is capable to increase the
accuracy and the repeatability over the controller with AFM.
Looking forward, we envision several improvements that
would increase the utility of the method. The method is
currently applied on a position control which only needs one
control step. We will investigate on an optimal controller for
trajectory tracking that needs multiple control steps and, the
aim of the controller would be to ﬁnd an optimal control
policy minimizing the expected cumulative variance.
ACKNOWLEDGMENT
The authors acknowledge the comments and support from
Dr. Harold Soh. This research is funded by the Chinese
Advanced Armament Research Project of 12-th Five-year
Plan (Grant No. 51320030201), the Fundamental Research
Funds for Central Universities (HIT.NSRIF.2014061), the
HIT Disruptive Innovation Program and the HIT Overseas
Talents Introduction Program.
REFERENCES
[1] Y . Li and Q. Xu, “Estimation and PID Sliding Surface for Motion
Tracking of a Piezo-Driven Micromanipulator,” Control Systems Tech-
nology, IEEE Transactions on, vol. 18, no. 4, pp. 798–810, 2010.
[2] Y . L. Zhang, M. L. Han, M. Y . Yu, C. Y . Shee, and W. T.
Ang, “Automatic hysteresis modeling of piezoelectric micromanip-
ulator in vision-guided micromanipulation systems,” Mechatronics,
IEEE/ASME Transactions on, vol. 17, no. 3, pp. 547–553, 2012.
[3] Q. Xu and Y . Li, “Dahl model-based hysteresis compensation and
precise positioning control of an XY parallel micromanipulator with
piezoelectric actuation,” Journal of dynamic systems, measurement,
and control, vol. 132, no. 4, p. 41011, 2010.
[4] W. Dong, L. N. Sun, and Z. J. Du, “Design of a precision compliant
parallel positioner driven by dual piezoelectric actuators,” Sensors and
Actuators A: Physical, vol. 135, no. 1, pp. 250–256, 2007.
[5] R. C. Shi, W. Dong, and Z. J. Du, “Design methodology and
performance analysis of application-oriented ﬂexure hinges,” Review
of Scientiﬁc Instruments, vol. 84, no. 7, p. 75005, 2013.
[6] Z. Du, R. Shi, and W. Dong, “A Piezo-Actuated High-Precision Flex-
ible Parallel Pointing Mechanism: Conceptual Design, Development,
and Experiments,” Robotics, IEEE Transactions on, vol. 30, no. 1,
pp. 131 – 137, 2014.
[7] D. Caligiore, T. Ferrauto, D. Parisi, N. Accornero, M. Capozza, and
G. Baldassarre, “Using motor babbling and Hebb rules for modeling
the development of reaching with obstacles and grasping,” in Proceed-
ings of International Conference on Cognitive Systems (CogSys 2008),
Karlsruhe, Germany, pp. E1–8, 2008.
[8] P. Hemakumara and S. Sukkarieh, “Non-parametric UA V system
identiﬁcation with dependent Gaussian processes,” in Proceedings of
International Conference on Robotics and Automation (ICRA-2011),
Shanghai, China, pp. 4435–4441, IEEE, 2011.
[9] T. Shamir and Y . Yomdin, “Repeatability of redundant manipulators:
Mathematical solution of the problem,” Automatic Control, IEEE
Transactions on, vol. 33, no. 11, pp. 1004–1009, 1988.
[10] M. Goldfarb and N. Celanovic, “Modeling Piezoelectric Stack ALctua-
tor for Control of Micromanipulation,” Control Systems, IEEE, vol. 17,
no. June, pp. 69–79, 1997.
[11] K. Kersting, C. Plagemann, P. Pfaff, and W. Burgard, “Most Likely
Heteroscedastic Gaussian Process Regression,” in Proceedings of In-
ternational Conference on Machine Learning (ICML -2007), Corvallis,
OR, USA, pp. 393–400, ACM, 2007.
[12] M. L´ azaro-Gredilla, M. Titsias, and L. Miguel, “Variational het-
eroscedastic Gaussian process regression,” in Proceedings of Inter-
national Conference on Machine Learning (ICML 2011), Bellevue,
Washington, USA, pp. 393–400, 2011.
[13] R. H. Byrd, M. E. Hribar, and J. Nocedal, “An interior point algorithm
for large-scale nonlinear programming,” SIAM Journal on Optimiza-
tion, vol. 9, no. 4, pp. 877–900, 1999.
[14] D. Prattichizzo and J. C. Trinkle, “Grasping,” in Springer Handbook
of Robotics, pp. 671–700, Springer, 2008.
4698
