  
? 
Abstract—The nonlinearities such as hysteresis and creep are 
the major factors inherent in PZT actuation that affect the tip 
positioning precision and manipulation performance of the 
AFM system. In this study, an extended PI model is generalized  
by introducing a creep model to the basic hysteretic operator of 
the PI model at the inflexion point of the hysteresis loop. Unified 
compensation for hysteresis and creep can be implemented with 
the extended PI model. Experiment results demonstrate the 
validity and effectiveness of the extended PI model and it is 
implied that the inflexion creep compensation not only improves 
the tip positioning precision at the inflexion points on the 
hysteresis loops, but also the localization effectiveness during 
the whole process of PZT actuation. 
Keywords—Hysteresis, Creep, Prandtl-Ishlinskii model, AFM, 
Pizeoelectric. 
I. INTRODUCTION 
tomic force microscopy (AFM) based robotic system 
becomes a powerful and promising tool in both 
nanofabrication and nanomanipulation areas due to its wide 
range of capabilities and applicability although AFM was 
originally invented for imaging and measuring matter at the 
nanoscale [1]. In nanofabrication, an AFM-based technique 
utilizing dynamic ploughing of a thin resist layer followed by 
pattern transfer of the lines into semiconductor through wet 
chemical etching was developed for fabricating ballistic 
quantum point contacts (QPCs) and resulted in promising 
subband separations [2]-[4], and the effect of geometric 
variations  on the transport properties of QPCs was further 
investigated [5]. AFM-based probe anodic oxidation is 
another effective technique for fabricating nano structures on 
substrate [6] or nano devices by controlling the position of 
oxide dots precisely to combine nano parts [7], and this 
approach was latterly successfully applied to oxidative 
cutting and welding of carbon nanotube (CNT) by controlling 
the distribution of electric field on substrate surface  and 
fabrication parameters such as bias voltage, tip-substrate 
 
This worl is supported by the National Natural Science Foundation of 
China (Grant No. 61327014, 61304251), and the CAS/SAFEA International 
Partnership Program for Creative Research Teams. 
Zhiyu Wang, Lianqing Liu, Zhidong Wang and Wenxue Wang are with 
the State Key Laboratory of Robotics, Shenyang Institute of Automation, 
Chinese Academy of Sciences (CAS), 110016, China.  
Zhiyu Wang is also  with the College of Electrical and Control 
Engineering, Liaoning Technical University, and University of Chinese 
Academy of Sciences, China 
Zhidong Wang is also with the Dept. of Advanced Robotics, Chiba 
Institute of Technology, Japan.  
Corresponding authors: lqliu@sia.cn (for AFM-based nanomanipulation) 
and wangwenxue@sia.cn (for hysteresis and creep compensation) 
 
distance and tip writing speed [8]. Furthermore, integrated 
with augmented reality interface, including real-time force 
and visual feedbacks, AFM-based robotic systems were 
developed for interactive nanomanipulation and 
nanoassembly with improved efficiency and effective [9], 
[10].  
The nanomanipulation performance of the AFM-based 
robotic systems is significantly affected by the spatial 
uncertainties, which are caused by random drift and faulty 
visual display. Efforts have been put into reducing the effect 
of such uncertainties. On-line sensing and display with local 
scanning strategy was developed for drift compensation and 
faulty display correction [11], Kalman filter techniques were 
applied to drift estimation [12] and to a probabilistic 
localization algorithm for improving tip positioning precision 
in nanomanipulation [13], and a virtual nanohand strategy 
with stochastic prediction was developed for automatic and 
stable nanoparticle pushing without monitoring the dynamic 
interactions between the tip and nanoparticles during the 
whole pushing process [14]-[16]. 
Another type of major factors that affect the 
nanomanipulation performance with AFM are the complex 
system nonlinearities inherent in the piezoelectric ceramics 
tube (PZT) actuation. One of the main nonlinearities  of PZT 
actuation is the hysteresis, which cause a multi-valued 
mapping between excitation voltage signal and displacement 
of PZT [17]-[19]. Many models have been proposed for the 
description and compensation of the nonlinear characteristics. 
One of the classical models is Preisach model to describe 
hysteresis with a basic relay hysteron in a stacked form, 
which shows excellent modeling accuracy with excitation 
voltage signal at low frequencies when the actuator is not 
subject to any load [17]. However Preisach model ignores the 
significant rate-dependent characteristic of PZT actuator that 
the displacement depends on the excitation voltages, and the 
modeling accuracy increasingly deteriorates as the load 
fluctuation applied to PZT actuator is relatively large and the 
range of frequencies of the voltage excitation get wider. 
Prandtl-Ishlinskii (PI) model stems from Preisach model, 
whose basic operator is a piecewise continuous closed loop 
with consideration of rate dependency [18], [19]. Compared 
with Preisach model, PI model has a simpler form and a 
smaller number of parameters, which makes it easier to 
compute the inverse of PI model for hysteresis compensation. 
Hence PI model is widely used for real time feedforward 
control in PZT actuation for hysteresis compensation. 
Creep is another nonlinear characteristic in PZT actuation. 
When a driving voltage signal of PZT stands still, the 
Unified Hysteresis and Creep Compensation in AFM Tip Positioning 
with an Extended PI Model 
Zhiyu Wang, Lianqing Liu, Member, IEEE,  Zhidong Wang,  Wenxue Wang, Member, IEEE 
A 
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 1606
  
displacement of PZT keeps changing slowly and cannot be 
hold at a certain value. The creep effect deteriorates the PZT 
positioning in detection and manipulation. Several modified 
PI model were proposed for compensation of both creep and 
hysteresis [20], [21], in which the creep effects are described 
as a first order linear system. With these methods for 
hysteresis and creep compensation, the creep effects are 
considered for all the time during the whole PZT activation 
process and depend on the history of excitation voltage signal, 
which makes the computation of the inverse model difficult. 
In fact, the creep effect in PZT actuation is not uniform, and 
the creep compensation at every voltage excitation consumes 
a lot of time for computing the inverse model and hence 
encumbers the application of such compensation to 
AFM-based robotic system with high speed actuation. An 
extended PI model was proposed by introducing a creep 
parameter into the hysteresis operator to compensate for 
inflexion creep effects only at the turning point of the single 
hysteretic loop, which significantly increased the tip 
positioning precision [22].  
In addition, closed-loop control strategies, such as 
sliding-surface control [23], Dahl Model-based control [24], 
iterative control [25], [26], can be applied to compensate for 
hysteresis and creep nonlinearities. However, compared with 
the PI model based feedforward control systems for 
hysteresis and creep compensation, the closed-loop control 
systems need extra sensors for measuring the PZT 
displacements and hence cause new noises and vibration in 
dynamic driving curve.  
In this paper, the extended PI model proposed in [22] is 
generalized with consideration of multi-loop hysteresis, for 
which the inflexion creeps are modeled as a generalized 
function of time with magnitude depending on the value of 
the corresponding turning point of the driving voltage signal. 
Therefore the complete extended PI model can be used to the 
inflexion creeps at any turning point on the hysteretic loop. 
Furthermore, the number of parameters in the creep model 
has been greatly reduced into three, which mathematically 
reveal the relationship between the creep effect and its driving 
voltage in PZT actuation. 
The paper is organized as follows. Section II briefly 
describes the inflexion creep through a PZT calibration 
experiment. Section III presents the generalized extended PI 
model by introduction of the inflexion creep model described 
as a function of time with magnitude depending on the 
turning voltage value as well as the inverse model. Section IV 
implements experiments for creep calibration and parameter 
identification of the extended PI model and its inverse, and 
then validate the effectiveness of hysteresis and creep 
compensation with the extended PI model. Section V 
concludes this paper with discussion. 
II. INFLEXION CREEP AND HYSTERESIS IN PZT ACTUATION 
 The precise tip positioning is crucial for the effectiveness 
and performance of AFM-based nanomanipulation and 
nanofabrication. For those AFM systems with displacement 
sensors, the tip placement can be recorded in real time, and 
the tip position on the sample surface can be derived 
accordingly. In this case, the hysteresis and creep effects can 
be compensated with closed control strategies. However, the 
closed-loop control strategies do not work for those AFM 
systems that lack of displacement sensors.  In this case, the tip 
position on the sample plane can be directly marked by the 
probe itself and a feedforward control strategy is required for 
hysteresis and creep compensation to improve tip positioning 
precision.   
 
Fig.1. Using an Atomic Force Microscopy (AFM) system for PZT  
calibration.  
 The AFM system, Multimode, for nanomanipulaiton in 
this study is the one without displacement sensors, as shown 
in the left subplot of Figure 1. The probe movements along 
the three directions are independently driven by three pairs of 
electrodes in the PZT actuator. To study the simultaneous 
compensations for hysteresis and creep, a sample with flat 
surface is fixed on the platform upon the top of  PZT actuator 
and under the probe for implementing calibration experiment. 
In this study, a piece of clean compact disc (CD) is chosen  for 
the experiments for inflexion creep calibration and validation 
of hysteresis and creep compensation because  CD surface is 
flat and soft enough for indenting with the AFM probe. The 
position of the probe on the sample surface, X-Y plane, and 
the height of the tip relative to the sample surface along the Z 
axis can be changed by driving the PZT through three driving 
voltages. The Multimode system can measure tiny distance 
difference on the sample surface with relatively high 
resolution in imaging process. The nonlinearities of 
hysteresis and creep of the PZT in the Multimode can be 
characterized through horizontal calibration with indentation 
by varying the excitation voltage for X-direction voltage, 
which is set as a triangle wave, as shown in the upper subplot 
of Figure 1. The triangle wave is fed into the AFM system 
through the control panel (the central subplot of Figure 1), 
and drives the PZT to move along a designed trajectory, 
indenting the substrate for recording the tip positions. The 
indenting result is then imaged by the scanning mode of the 
AFM system as shown in the right subplot of Figure 1. Based 
on the calibration data, the feedforward controller can be 
constructed with the nonlinearity compensations to realize the 
desired probe positioning and movement, as shown in the 
1607
  
bottom subplot of Figure 1. The experiments are implemented 
at a constant ambient temperature of 16 degree, which can 
restrain the thermal drift effect. The indentation marking the 
moving trajectory of the tip is imaged by the scanning mode 
of the AFM system as shown in Figure 2. The real position of 
the tip on the sample plane is recorded by the indentation. The 
horizontal displacement of AFM tip can be read out in pixels 
and translated into micrometer which is depicted as hysteresis 
loop as shown in Figure 3. The arrows in both Figure 2 and 
Figure 3 denote the moving directions of the tip on the sample 
plane. 
 
Fig.2. Indentation experimental results for characterizing the 
hysteresis and inflexion creep in PZT actuation. 
Inflexion points are those excitation voltage values at 
which the driving signal changes the variation direction. At 
each inflexion point of the X-driving signal, the inflexion 
value stands still for a sampling period of milliseconds, and 
meanwhile the tip is moved for a certain distance along the Y 
direction to prevent the returning trajectory from overwriting 
the previously indented line. The creep taking place at the 
inflexion point is called inflexion creep, shown as in Figure 3. 
-4 -3 -2 -1 0 1 2 3 4
-8
-6
-4
-2
0
2
4
6
8
-2.95 -2.9 -2.85 -2.8 -2.75 -2.7 -2.65 -2.6 -2.55 -2.5
-4.6
-4.5
-4.4
-4.3
-4.2
-4.1
-4
-3.9
-3.8
-3.7
3.8 3.85 3.9 3.95 4
5.95
6
6.05
6.1
6.15
6.2
6.25
6.3
6.35
6.4
Driving signal um
Tip displacement 
um
Negative 
creep
Positive 
creep
 
Fig.3. The displacement characteristics of AFM tip showing the 
hysteresis and creep effects. 
Although the creeping time is about tens of milliseconds, 
the creep displacement in X-axis in this example is several 
tens nanometers, which is enough to cause the tip to lose 
nano-objects and hence deteriorates the performance and 
effectiveness of nanomanipulation. In this study, we focus on 
the simultaneous compensation of hysteresis and inflexion 
creep. 
III. MATHEMATICAL EXPRESSION FOR THE INFLEXION 
CREEP AND THE EXTENDED PI MODEL 
The inflexion creep can be modeled as the response of a 
first order linear system with a step function as input, which 
corresponds to the inflexion voltage [20], [21]. The 
magnitude of the creep depends on the inflexion voltage value. 
In this study, the calibration data shows that the creep 
magnitude is an exponential function of the inflexion voltage 
value. Therefore, the inflexion creep is mathematically 
described as follows: 
( )*
( , ) (1 )* ( )
ut
C u t e M u
?
??                                      (1) 
()
u
M u a b ??                                                          (2) 
Where, both () u ?  and () Mu are the functions of inflexion 
voltage value u . PI model is time independent, while 
inflexion creep is a function of time, therefore the inflexion 
creep cannot be considered in PI. To implement simultaneous 
compensation of hysteresis and inflexion creep, an operator is 
introduced through the extension of the basic hysteretic 
operator of PI model by adding/subtracting the inflexion 
creep model. The new extended basic operator for both 
hysteresis and inflexion creep ( called as HC operator) is 
expressed as follows: 
0
[ , ]( )
max{ ( ) ,min{ ( ) , ( )}} ( , )
if  ( ) ( ) ( 2 ) 0;
max{ ( ) ,min{ ( ) , ( )}} ( , )
if  ( ) ( ) ( 2 ) 0;
max{ ( ) ,min{ ( ) , ( )}}
if  ( ) ( );
ri i
i i ri
i i ri
ii
HC u x t
u t r u t r x t T C u T
u t u t T u t T
u t r u t r x t T C u T
u t u t T u t T
u t r u t r x t T
u t u t T
?
? ? ? ? ?
?
? ? ? ? ?
? ? ? ?
?
? ? ? ? ?
? ? ?
??
?
?
?
?
?
?
?
?
  (3) 
1
i
i
rx
n
?
?
?
, ( , ) ( , )
1
ri
i
C u T C u T
n
?
?
 ,
0
0
i
x ?          
where () ut is a driving voltage and 
()
ri
HC t
 is the output of the 
operators, ( , ) 0 C u T ? is the inflexion creep function, 
01
( , , , )
n
r r r r ? ?? is a threshold vector, and ||·|| denotes the usual 
Euclidean norm. The deduction is similar with the traditional PI 
model [18], [19]. 
0 00 01 0
( , , , )
n
x x x x ? ??  is a vector of initial 
values of the output.  
With the basic operators in Eq. 3, the displacement output of 
the PZT actuation is expressed as follows: 
0
0 00 0
( ) [ , ]( ) ( [ , ]( ); [ , ]( ))
n
T
r r n
Y t HC u x t HC u x t HC u x t ? ? ? ?? (4)                                                                                                      
where () Yt is the displacement output,
0
[ , ]( )
i
ri
HC u x t is the 
th i HC operator, 
01
( , , , )
T
n
? ? ? ? ? ?? is a weight vector. The 
output is a weighted sum of a series of HC operators with 
corresponding threshold parameter r . Since HC operator 
stems from the traditional hysteretic operator of PI model, the 
parameters of the forward model and its inverse can be obtained 
in the same method. Therefore, the parameter ? of the extended 
1608
  
PI model can be calculated by Least Square Method described as 
follows: 
1
( * ) *
T
HC HC HC X ?
?
?                                               (5)                                                                                                                                                      
where, X is a vector of calibration data i.e. the PZT 
displacements. 
In [18] and [19], it has been proven that the hysteresis 
operator of PI is piecewise continuous and invertible, and the 
inverse of PI model is also modeled as the weight sum of  PI 
operators, which is written as follows:  
'
1 ' ' ' ' '
00
[ , ]( ) [ , ]( )
T
r
H u x t H u x t ?
?
?                                   (6) 
0
' 0 ' 00 ' 0
[ , ]( ) ( [ , ]( ) [ , ]( ))
n
T
r r r n
H u x t H u x t H u x t ? ??             (7) 
where the superscript “ ' ” indicates that the corresponding 
parameter belongs to the inverse of PI model. The input 
signal 
'
u is the expected displacement and the output
'
x is 
the driving signal for the PZT actuation. Likely, The inverse 
of the extended PI model has the similar form with its forward 
model, and can be expressed by Eq. 6  and Eq. 7, and the 
parameters of the inverse model can be calculated through the 
following equations [18], [19]: 
'
0
()
i
i j i j
j
r r r ?
?
??
?
;                                                                 (8) 
'
0
0
1
?
?
?                                                                                  (9) 
'
1
00
11
((
i
i ii
jj
jj
?
?
? ? ? ?
?
??
?
??
??
? ?
                                             (10) 
'
0 0 0
01
in
i j i j i
j j i
x x x ??
? ??
??
??
                                                     (11) 
IV. EXPERIMENTS FOR CALIBRATION AND VALIDATION OF 
HYSTERESIS AND INFLEXION CREEP COMPENSATION   
 
Fig.4. Inflexion creep calibration using the AFM system. 
 
The inflexion creep takes place at the inflexion points of 
driving signal, with magnitude depending on the inflexion 
voltage value. Then the inflexion creep can be calibrated at 
different inflexion voltage for a certain time by the tip 
indentation method. As shown in Figure 4, each column of 
indentations indicate an inflexion creep trajectory at a certain 
inflexion voltage value in the X-direction, with moving the 
tip in Y-direction within the creeping time. For example, in 
the rightmost column of indentation, the voltage in the 
X-direction holds still and the tip moves in the Y-direction for 
indenting the substrate within creeping time. It can be seen 
that the X-coordinates of the indented points gradually varies 
in the same direction, indicating the creep effect of the PZT 
actuator in the X-direction. It is obvious that the creep effects 
take place at any excitation voltage value.  
Time sec
Creep um
0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
 
 
U=3.91 um
U=3.32 um
U=2.73 um
U=2.15 um
U=1.56 um
U=0.97 um
 
Fig. 5. Calibrated inflexion creep curves at different inflexion points.  
 
The creep direction is consistent with the variation 
direction of the driving signal. Therefore the inflexion creep 
can be divided into positive creep and negative creep, taking 
place at the right and left inflexion points on the hysteresis 
loops respectively, corresponding to the creep trajectories on 
the right part and the left part in Figure 4. For the simplicity of 
study, we assume that the positive and negative creeps are 
symmetric. So the inflexion creep trajectories with different 
inflexion voltages in Figure 4 are extracted and displayed in 
Figure 5, with the dotted curves representing the 
X-coordinates and the solid curves fitting the corresponding 
trajectories.  
0.5 1 1.5 2 2.5 3 3.5 4
0.25
0.3
0.35
0.4
0.45
0.5
0.55
0.6
0.65
0.7
Driving signal um
Creep magnitude 
um
 
Fig. 6. Calibrated creep magnitudes  at different inflexion points. 
 
Based on the inflexion creep trajectories, the parameters of 
the creep model can be easily identified. In this study, the 
parameter () u ? is set to a constant value based on the 
experimental data. The magnitude of creep effect () Mu at a 
1609
  
certain inflexion voltage represents how far the creep goes as 
time elapses. Hence the magnitudes of the inflexion creeps 
are set to the values that the fitting curves of creep trajectories 
converge. Then the magnitude curve of inflexion creep can be 
achieved by fitting these magnitude values, as shown in 
Figure 6 where the dots represent the creep magnitude values 
of the creep trajectories and the solid curve is the creep 
magnitude as a function of inflexion voltage values. 
With estimated parameters of the creep model, the fitting 
curve for the displacement data in Figure 3 can be computed 
according to Eq. 3~Eq. 5, as shown in Figure 7 and the 
estimated parameters for the forward model are listed in the 
left column of Table 1. The blue curve is the original 
experimental data from Figure 3, and the red line is its fitting 
curve by the extended PI model depicted in Eq. 3 and Eq. 4. 
The subplots in the figure are the enlargements of the area 
containing a local inflexion creep. On the multi-loop 
hysteresis displacement curve, the fitting curve with the 
inflexion creep model follows the creep displacement at 
every inflexion points of driving signal. The fitting errors are 
shown in Figure 8.  
-4 -3 -2 -1 0 1 2 3 4
-8
-6
-4
-2
0
2
4
6
8
Tip displacement 
um
Driving signal um
-2.8 -2.75 -2.7 -2.65 -2.6
-4.2
-4.15
-4.1
-4.05
-4
-3.95
-3.9
-3.85
-3.8
-3.75
2.65 2.7 2.75 2.8 2.85
3.6
3.65
3.7
3.75
3.8
3.85
3.9
3.95
4
4.05
 
Fig 7. Curve fitting with hysteresis and creep compensations using 
the extended PI model for the hysteresis loops. 
 
 
Similarly, the weight vector of the inverse model can be 
computed using Eq. 8~Eq. 11, as listed the right column of 
the Table.1 With these parameters, the hysteresis and creep 
can be compensated with the inverse of the extended PI 
model depicted in Eq. 6 and Eq. 7. 
Sample time T 
Fitting error um
0 20 40 60 80 100 120 140 160
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
Maxerror 
0.47um
 
Fig 8.  The distribution of errors between the fitting curve and the 
multi-loop hysteresis. 
 
The feedforward control system is constructed with 
nonlinearity compensator by the inverse of the PI model or 
extended PI model. With estimated parameters of the inverse 
model, the desired voltage signal for expected tip positions is 
generated and then fed into the AFM system. In this study, 
two groups of localization experiments are carried out to 
compare the compensation performance of the extended PI 
model and the original PI model. The tip positions are 
expected to distribute uniformly in the X-direction.    
  
The indentation arrays on the CD sample surfaces are 
shown in Figure 9, where the top subfigure is for the 
indenting experiment with the hysteresis and inflexion creep 
compensation using the extended PI model, and the bottom 
subfigure for the indenting experiment with only the 
hysteresis compensation using the traditional PI model. 
The statistical distribution of error between the expected 
tip position and the actual indenting position is  shown in 
Figure 10, where the blue curve is the positioning error 
distribution with both hysteresis and creep compensations 
using the extended PI model, and the red curve is the 
positioning error with only the hysteresis compensation. It is 
 
Fig.9. The indentation array comparison. 
TABLE I. WEIGHT VECTOR? OF   THE EXTENDED PI MODEL  
? Forward  model inverse model 
0
?
 
0 0. .7 79 93 31 17 72 23 31 17 72 25 51 15 54 42 2  1 1. .2 26 60 07 76 60 00 08 87 73 37 73 31 13 3  
1
? 0 0. .4 44 42 20 07 71 11 13 34 45 53 34 49 94 41 1  - -0 0. .4 45 51 12 20 03 30 07 73 36 68 89 99 92 22 2  
2
? 0 0. .0 02 20 07 79 94 43 33 38 88 85 51 18 80 02 2  - -0 0. .0 01 13 34 40 02 26 62 24 44 49 97 73 33 30 07 7  
3
? 0 0. .1 10 06 67 72 23 39 90 04 43 36 68 81 18 83 3  - -0 0. .0 06 62 23 35 50 03 37 76 65 59 95 56 65 52 20 0  
4
? 0 0. .0 06 65 50 04 40 04 41 17 78 89 98 88 84 40 0  - -0 0. .0 03 33 34 42 26 68 84 44 48 80 01 10 06 62 20 0  
5
? 0 0. .1 13 35 55 51 13 33 33 34 49 97 74 48 81 12 2  - -0 0. .0 06 60 07 71 11 10 00 01 10 01 17 77 75 55 52 2  
6
? 0 0. .0 06 63 31 10 05 54 48 84 44 48 87 75 52 29 9  - -0 0. .0 02 24 48 81 19 91 18 85 58 83 33 37 78 85 50 0  
7
? 0 0. .0 09 94 43 33 34 46 67 75 55 50 03 35 50 08 8  - -0 0. .0 03 33 37 70 06 69 93 30 09 93 35 53 31 11 10 0  
8
? - -0 0. .0 04 41 12 26 61 19 96 61 16 65 57 71 19 9  0 0. .0 01 14 42 27 77 75 50 04 47 71 19 97 77 76 61 1  
9
? 0 0. .1 19 98 80 06 65 50 01 16 63 39 99 91 16 63 3  - -0 0. .0 06 62 28 81 11 10 02 26 69 94 40 08 82 28 85 5  
10
? 0 0. .0 08 83 38 84 49 94 40 03 36 62 29 93 36 62 2  - -0 0. .0 02 22 27 76 68 87 71 14 42 21 17 71 18 88 87 7  
11
? 0 0. .2 25 59 99 96 60 01 10 05 51 19 91 18 83 38 8  - -0 0. .0 05 59 96 66 64 48 80 01 17 78 87 71 14 40 05 5  
12
? - -0 0. .3 36 65 56 62 20 02 28 87 77 79 96 60 04 4  0 0. .0 08 88 86 69 93 32 29 90 04 49 92 22 24 40 09 9  
 
1610
  
obvious that the inflexion creep compensation not only 
improves the tip positioning precision at the inflexion points 
on the hysteresis loops, but also the localization effectiveness 
during the whole process of PZT actuation.   
 
V. DISCUSSION AND CONCLUSION  
Hysteresis and creep are the two main nonlinearities 
inherent in PZT actuation and significantly affected 
AFM-based nanomanipulation. In this study, an extended PI 
model has been developed  by adding (subtracting) a creep 
model to (from) the basic hysteretic operators of the PI model. 
The model is the generalization of the work proposed in [22]. 
By comparison of the compensation performances of the 
extended PI model and PI model, it shows that the extended 
PI model can better compensate for the effects of hysteresis 
and creep nonlinearities than the PI model, and the inflexion 
creep compensation not only improves the tip positioning 
precision at the inflexion points on the hysteresis loops, but 
also the localization effectiveness during the whole process of 
PZT actuation.   
The proposed extended PI model in this study has a 
relatively simpler structure and less parameters than the 
compensation methods in [20], [21] , in which the creep 
model depends on the history of input signal and the creep 
effects are compensated  through the whole process of PZT 
actuation. Therefore the hysteresis and creep compensation 
with the extended PI model will consume less time, which is 
especially meaningful for the AFM-based nanomanipulation 
requiring high speed actuation.  
Incorporated with the local scanning strategy [11] or the 
virtual nanohand strategy [14]-[16], the extended PI model 
can improve the scanning accuracy, and therefore reduce the 
effect of the spatial uncertainties caused by the thermal drift.  
REFERENCES 
[1] G. Binnig and C. F. Quate, “Atomic force Microscope,” Appl Phys Lett, 
56(9): 930-933, 1986. 
[2] B. Klehn and U. Kunze, “SiO2 and Si nanoscale patterning with an 
atomic force microscope,” J. Appl. Phys., 85(7): 3897-3903,1999. 
[3] B. Klehn, S. Skaberna and U. Kunze, “Plowing on the Sub-50nm 
Scale:Nanolithography Using Scanning Force Microscopy,” 
Superlattices Microstruct, 11(17): 1473-1475, 1999. 
[4] S. Skaberna, M. Versen, B. Klehn, et al., “Fabrication of a quantum 
point contact by the dynamic plowing technicque and wet-chemical 
etching”  Ultramicroscopy, 82: 153-210, 2000. 
[5] G. Apetrii, S.F. Fischer, U. Kunze, et al. “Influence of processing 
parameters on the transport properties of quantum pointcontacts 
fabricated with an atomic force microscope,” Semicond Sci Technol, 
17:735-744, 2002. 
[6] H. C. Day, and D. R. Allee, “Selective area oxidation of silicon with a 
scanning force microscope,” Appl Phys Lett, 62(21): 2691-2693, 1993. 
[7] E. S. Snow, W. H. Juan, S. W. Pang, et al. “Si nanostructures fabricated 
by anodic oxidation with an atomic force microscope and etching with 
an electron cyclotron resonance source,” Appl Phys Lett, 66(14): 
1729-1731, 1995. 
[8] N. Jiao, Y Wang, N. Xi, et al., “AFM based anodic oxidation and its 
application to oxidative cutting and welding of CNT, ” Journal of Sci 
China Ser E-Tech Sci,  52(11): 3149-3157, 2009. 
[9] H. Chen,  N. Xi and G. Li,  “CAD-Guided Automated Nanoassembly 
Using Atomic Force Microscopy-Based Nonrobotics,” IEEE 
transactions on automation science and engineering,  3(3):208-217, 
2006. 
[10] G. Li, N. Xi, H. Chen, et al. ,“Videolized Atomic Force Microscopy for 
Interactive Nanomanipulation and Nanoassembly,” IEEE transactions 
on nanotechnology, 4(5):605-615, 2005. 
[11] L. Liu, N. Xi, Y. Wang, et al., “Drift Compensation and Faulty Display 
Correction in Robotic Nano Manipulation” Journal of Nanoscience and 
Nanotechnology, 10: 7010-7014, 2010. 
[12] B. Mokaberi and A. A Requicha, “Drift compensation for automatic 
nanomanipulation with scanning probe microscopes,” IEEE Trans. 
Autom. Sci. Eng., 3(3), 199-207, 2006. 
[13] S. Yuan, L.Liu, Z. Wang, et al., “A Probabilistic Approach for On-line 
Positioning in Nano Manipulations” World Congress on Intelligent 
Control and Automation, 450-455,2010. 
[14] Z.. Wang, L.. Liu, Z. Wang et al., “Virtual nano-hand: A stable pushing 
strategy in AFM based sensorless nanomanipulation,” Proc. IEEE 
Int.Robio Conf., 1409-1414, 2011. 
[15] J. Hou, L. Liu, Z. Wang et al., “AFM-Based Robotic Nano-Hand for 
Stable Manipulation at Nanoscale,” IEEE Trans. Autom. Sci. Eng., 
10:285-295, 2013. 
[16] Z.Wang, L.Liu, Y..Wang, et al., “Stable nanomanipulation using 
Atomic Force Microscopy,” Nanotechnology, 7(4):6-11, 2013. 
[17] H. Hu and R. B Mrad, “On the classical Preisach model for hysteresis in 
piezoceramic actuators,” Mechatronics, 13:85-94, 2003. 
[18] Kuhnen K and Janocha H,  “Inverse feedforward controller for complex 
hysteretic nonlinearities in smart-material systems,” Control and 
Intelligent Systems,  2001 
[19] K. Kuhnen and H. Janocha, “Complex hysteresis modeling of a broad 
class of hysteretic nonlinearities,” Proc. 8th Int. Conf. New Actuators, 
Bremen, Germany, 688-691, 2002. 
[20] P. Krejci and K. Kuhnen, “Inverse control of systems with hysteresis 
and creep,” Control Theory and Applications, 148(3):4008-4009, 2001. 
[21] B. Mokaberi and A. A Requicha, “Compensation of Scanner Creep and 
Hysteresis for AFM Nanomanipulation,” IEEE Trans. Autom. Sci. Eng., 
5(2):197-206, 2008. 
[22] Z. Wang, L. Liu, Z. Wang et al., “An extended PI model for hysteresis 
and creep compensation in AFM based nanomanipulation,” Proc. IEEE 
Int.Robio Conf., 992-997, 2010. 
[23] H. J. Shieh and P.K. Huang, “Precise tracking of a piezoelectric 
positioning stage via a filtering-type sliding-surface control with 
chattering alleviation,” IET Control Theory and Applications, 1(3), 
586-594, 2007. 
[24] Q. Xu and Y. Li, “Dahl Model-Based Hysteresis Compensation and 
Precise Positioning Control of an XY ParallelMicromanipulator with 
Piezoelectric Actuation,” ASME Transactions on Dynamics, System, 
Measurement, and Control, 132(2): 041011, 2010. 
[25] Y. Wu and Q. Zou “Iterative control approach to compensate for both 
the hysteresis and the dynamics effects of piezo actuators,” IEEE Trans 
Control Syst Technol, 15(5):906-915, 2007. 
[26] B. E. Helfrich, C. Lee, D. A. Bristow, et al. “Combined H
?
-feedback 
control and iterative learning control design with application to 
nanopositioning systems,” IEEE Trans Control Syst Technol., 
18(2):336-351, 2010. 
0 10 20 30 40 50 60 70 80 90
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
positioning error um
Extended PI model
PI model
Indentation Index
 
Fig.10. positioning error distribution comparison. 
1611
