Turning a Near-hovering Controlled Quadrotor into a 3D Force Effector
Guido Gioioso
1;2
, Markus Ryll
3
, Domenico Prattichizzo
1;2
, Heinrich H. B¨ ulthoff
3
and Antonio Franchi
4;3
Abstract— In this paper the problem of a quadrotor that
physically interacts with the surrounding environment through
a rigid tool is considered. We present a theoretical design that
allows to exert an arbitrary 3D force by using a standard near-
hovering controller that was originally developed for contact-
free ﬂight control. This is achieved by analytically solving the
nonlinear system that relates the quadrotor state, the force
exerted by the rigid tool on the environment, and the near-
hovering controller action at the equilibrium points, during
any generic contact. Stability of the equilibria for the most
relevant actions (pushing, releasing, lifting, dropping, and left-
right shifting) are proven by means of numerical analysis
using the indirect Lyapunov method. An experimental platform,
including a suitable tool design, has been developed and used
to validate the theory with preliminary experiments.
I. INTRODUCTION
Over the past decade, Unmanned Aerial Vehicles (UA Vs)
attracted an increasing interest in the robotics community,
due to their versatility and to the many potential indoor
and outdoor applications, including, e.g., landscape survey,
surveillance and reconnaissance, manufacturing and logistics
automation. In this context UA Vs have been mainly con-
sidered as ﬂying sensors rather than ﬂying actuators, and
the possibility of using ﬂying robots for mobile manipula-
tion, i.e., enabling physical interaction with the surrounding
environment, has not been sufﬁciently investigated yet. In
fact, designing novel ﬂying robotic systems able to perform
this kind of interaction would open a much wider range of
possible applications in the aerial robotics ﬁeld.
Among the UA V platforms, the quadrotor gained a lot
of popularity in the robotic community, due to its me-
chanical simplicity and robustness. Being able to hover
and perform vertical take-off and landing, it represents also
an ideal platform for developing and testing many new
aerial manipulation concepts. In [1] a control law for a
quadrotor equipped with a rigid tool is proposed and tested in
simulation. The controller is based on feedback linearization
thus requiring for a rather precise knowledge of the system
mechanical parameters and state estimation that is sometime
hard to ﬁnd in real application scenarios. Furthermore, some
1
Department of Information Engineering and Mathematics, Uni-
versity of Siena, via Roma 56, 53100 Siena, Italy [gioioso,
prattichizzo]@dii.unisi.it
2
Department of Advanced Robotics, Istituto Italiano di Tecnologia, via
Morego 30, 16163 Genova, Italy
3
Max Planck Institute for Biological Cybernetics, Dept. of Human Per-
ception, Cognition and Action, Spemanstr. 38, 72076, T¨ ubingen, Germany
[markus.ryll,hhb]@tuebingen.mpg.de
4
Centre National de la Recherche Scientiﬁque (CNRS),
Laboratoire d’Analyse et d’Architecture des Syst` emes (LAAS),
7 Avenue du Colonel Roche, 31077 Toulouse CEDEX 4, France.
antonio.franchi@laas.fr
Fig. 1: CAD model of the quadrotor setup developed and used for
our experiments and main frames and symbols used to model it.
caution is needed when dealing with a possible unstable zero
dynamics. A passivity-based controller is presented in [2]
for a quadrotor endowed with a delta-shaped manipulator.
Using a decoupled approach the actuation of the manipulator
is employed to apply forces on a wall relying on the fact
that the ﬂight controller is able to keep steady the UA V
position during contact. The authors in [3] present a hybrid
framework with the goal of letting the quadrotor follow a
desired trajectory while exerting a force on the environment.
The approach relies on the empirical identiﬁcation of a map
that relates the exerted measured wrench with the thrust and
torque inputs of the used quadrotor platform. In [4] a control
framework is presented that allows the one-dimensional
manipulation of a cart performed by one or two quadrotors
through a rigid tool. In [5] a framework for robust control of
a UA V for docking-undocking operation on a vertical surface
based on a path following strategy is developed and tested
in simulation. A recent work [6] proposes an interaction and
damping assignment passivity-based controller (IDA-PBC)
that is able to change the apparent dynamical parameters
of a quadrotor. The authors have shown that this controller
can be successfully used to shape the dynamical behavior
of a quadrotor when in contact with a physical environment.
Finally, studying the physical interaction with the environ-
ment is essential for applications in which UA Vs are used as
mobile manipulating platforms, see, e.g., [7], [8].
In this paper we theoretically formulate the problem of
controlling a quadrotor UA V endowed with a rigid tool
whose tip has to be used in order to exert a prescribed 3D
force on the environment. This is a basic task whose study
may be instrumental for more complex manipulation behav-
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 6278
ior performed by a single or multiple UA Vs. The advantage
of this approach is to obtain a structure that is light-weight,
mechanically simple and with a larger time autonomy than a
single bulky UA V equipped with a manipulator with several
DOFs. Moreover, a system with multiple UA Vs endowed
with simple tools might result even more effective and
versatile as shown, e.g., in [9] where it is presented the
control of a ﬂying hand constituted by multiple simple UA Vs
each one acting as a single ﬁnger.
The model of a quadrotor endowed with a rigid tool is
introduced in Sec. II along with a control law suitable for
force exertion. The control scheme is based on the near-
hovering linearizing control approach that is commonly used
for contact-free ﬂight on many quadrotor UA V platforms.
The adoption of a widely used control law is the main
strength of this approach, which brings many advantageous
consequences: i) our solution can be easily applied by other
research labs by slightly adapting the built-in controller that
is already present on their platform; ii) the same controller is
used both for the free ﬂight phase and for the contact phase
thus being exempt from the need for exact contact detection
and switching-related problems; iii) despite being conceived
for a near-hovering contact-free ﬂight, during contact the
controller can be used with high tilt angles; furthermore,
iv) the control law is based neither on full cancellation,
as feedback linearization, nor on sliding surfaces, thus it is
expected to have a robust behavior in real world conditions.
By virtue of the analytical study carried-out in Sec. III
on the nonlinear equilibria of the controlled system, the
controller can be effectively used to apply, at steady state,
any given 3D contact force at the contact point. Stability
of the controlled system at the equilibria corresponding to
the given forces is numerically proven in Sec. IV for the
most important interaction cases, such as pushing, releasing,
lifting, dropping, and left/right shifting.
The implementation of an experimental platform which
includes the design of a tool that can be easily mounted
on a quadrotor to establish contact with the environment,
is presented in Sec. V where a preliminary experiment in
the dynamic case (i.e., time-varying force proﬁle) is also
shown. Section VI concludes the paper and presents future
developments of this work.
II. MODEL AND STANDARD NH CONTROLLER
In this section we present the notation used throughout
the paper while brieﬂy introducing the standard quadrotor
dynamical model. Refer to Fig. 1 for an illustration. An
inertial world frameW :fO
W
;~ w
1
;~ w
2
;~ w
3
g and a quadrotor
body frameB :fO
B
;;
~
b
1
;
~
b
2
;
~
b
3
g are considered. The origin
of the body frame is coincident with the center of mass
of the quadrotor which is also the geometric center of the
four propellers. We indicate with p=(p
1
; p
2
; p
3
)
T
2 I R
3
the
position of O
B
in W and with v=(v
1
;v
2
;v
3
)
T
2 I R
3
the
corresponding linear velocity. The scalar m2 I R denotes the
mass of the quadrotor and J2 I R
33
its inertia matrix with
respect to the body frame. Finally, let R2 I R
33
represent
the rotation matrix from the body frame to the inertial
world frame and w2 I R
3
be the angular velocity vector that
represents the rotation of B with respect to W , expressed
in B. The orientation of the quadrotor is represented by
h := (f;q;y)
T
2 I R
3
, with f;q;y being respectively the
roll, pitch and yaw angles (RPY). The rotation matrix can
be written using RPY as R(h)= R
z
(y)R
y
(q)R
x
(f), where
R
x
;R
y
;R
z
are the elementary rotation matrices about the
three coordinate axis.
As common practice in literature we assume as control
inputs the total thrust acting on the
~
 b
3
direction, denoted
with l2 I R
+
, and the total moment expressed inB, denoted
witht=(t
1
;t
2
;t
3
)
T
2 I R
3
. Being the four inputs less than six
(the number of conﬁguration parameters p;h) the quadrotor
is an underactuated system. Nevertheless its actuation is
enough to exert any 3D force on the environment.
We assume that the quadrotor is equipped with a tool
whose tip position in body frame is expressed by the constant
vector d=(d
x
;d
y
;d
z
)
T
2 I R
3
. Without loss of generality we
take
~
b
2
aligned with the projection of the tool on the plane
spanned by
~
b
1
and
~
b
2
, thus resulting in d
y
= 0. Let y2 I R
3
be the position of the tool-tip in the world frame:
y= p+ Rd: (1)
The environment interacts with the quadrotor by exerting
a force f
e
2 I R
3
on the tool-tip, which is expressed in the
world inertial frame. The interaction moment at the tool-tip
is assumed negligible. This assumption is widely used in lit-
erature and it is referred to as hard ﬁnger contact model [10].
Under these assumptions, the equations of motion of the
quadrotor can be written as:
˙ p= v (2)
m˙ v= lRˆ z+ mgˆ z+ f
e
(3)
˙ h = T(h)w (4)
J ˙ w = w Jw+t+ d R
T
f
e
; (5)
where ˆ z=(0;0;1)
T
and T(h)2 I R
33
transforms w to the
RPY rates ˙ h.
In the following we adopt the common assumption that
the quadrotor is never in a singular conﬁguration (i.e., f =
q = 0), in fact if this happens, the total thrust l cannot be
used to counterbalance the gravity force, thus consisting in
a useless case for our purposes.
A. Standard Near-hovering Controller
In this section we revise a control law that has been
widely used in literature (see, e.g., [11], [12], [13]) to
perform near-hovering and contact-free trajectory tracking.
Even though this controller is well known in literature, it
is essential to recall its main structure and notation for the
following Sec. III where we will show how this controller
can be effectively used to perform a contact force on the
environment even in far-hovering conditions.
An inner-loop PID controller tracks some desired RPY
angles h
d
=(f
d
;q
d
;y
d
)
T
2 I R
3
, relying on the fact that the
6279
rotational dynamics is fully actuated. In fact, differentiat-
ing (4) and substituting (5), we get
¨ h = T(h)J
 1
( w Jw+t+ d R
T
f
e
)+
˙
T(h)w:
The PID attitude regulation controller is thus deﬁned as:
t = JT
 1
(h)K
A
h
e
(6)
where:
K
T
A
=
2
6
6
6
6
6
6
6
6
6
4
k
f
DA
0 0
k
f
PA
0 0
k
f
IA
0 0
0 k
q
DA
0
0 k
q
PA
0
0 k
q
IA
0
0 0 k
y
DA
0 0 k
y
PA
0 0 k
y
IA
3
7
7
7
7
7
7
7
7
7
5
; h
e
=
2
6
6
6
6
6
6
6
4
 
˙
f
f
d
 f
R
(f
d
 f)dt
 
˙
q
q
d
 q
R
(q
d
 q)dt
  ˙ y
sin(y
d
 y)
R
sin(y
d
 y)dt
3
7
7
7
7
7
7
7
5
(7)
that leads to the closed-loop dynamics:
¨ h+ K
A
h
e
= TJ
 1
( w Jw+ d R
T
f
e
)+
˙
Tw:
It has been shown that, in contact-free ﬂight and under
suitable conditions of the initial state and gain selection,
(h
e
; ˙ h
e
) is locally exponentially stable.
Since in contact-free ﬂight this controller is meant to work
in near hovering T
 1
(h) can be approximated by a 3 3
identity matrix in (6). Furthermore, assuming that the J is
diagonal, as common practice, we can hide J in the gain
matrix K
A
thus obtaining a simpler expression for t:
t = K
A
h
e
: (8)
Note that even if the previous ones seem crude approxima-
tions, they have been proven to work very well in reality,
see the previously cited work, when the task is to ﬂy in
near hovering. Furthermore, we are not interested in having
excellent performances in free ﬂight since our focus is in the
contact case.
An outer-loop controller is then designed by choosing the
thrust such as to actuate the vertical dynamics
l = 
m
cosf cosq
( g  b
z
P
v
3
+ k
z
PP
e
3
) (9)
where b
z
P
and k
z
PP
are two positive scalar gains and e
3
is
an additional control input. Secondly, in order to act on the
horizontal dynamics, the desired roll f
d
and pitch q
d
are set
such that

sinf
d
sinq
d

=
m
l

 s
y
c
y
 c
y
=c
f
 s
y
=c
f

 b
P
v
1
+ k
PP
e
1
 b
P
v
2
+ k
PP
e
2

(10)
where e
1
;e
2
are two additional control inputs, and s

and c

denote sin() and cos() respectively. The interested reader
is referred to [13] for the analytical derivation of (10). We
gather the three additional control inputs in the vector e=
(e
1
;e
2
;e
3
)
T
2 I R
3
.
Remark 1: (Behavior in contact-free ﬂight) In the liter-
ature the controller (8),(9),(10) has been used to steer the
robot during contact-free (i.e., f
e
= 0) motion. In fact, simply
speaking, if we plug (9) in the third row of (3) we obtain
m ˙ v
3
= b
z
P
v
3
+ k
z
PP
e
3
; (11)
furthermore, if the attitude controller is fast enough, i.e.,
s.t. q'q
d
and f'f
d
, the ﬁrst two rows of (3) become
(see [13])
m

˙ v
1
˙ v
2

'

 b
P
v
1
+ k
PP
e
1
 b
P
v
2
+ k
PP
e
2

Therefore, one can choose e= p
d
  p in order to exponen-
tially regulate p to a desired constant position p
d
.
III. NONLINEAR EQUILIBRIA DURING CONTACT
Departing from the assumption that is commonly done
in the literature when dealing with such controller (see
Remark 1) in this paper we consider the case when f
e
6= 0
and possibly q6=q
d
and f6=f
d
. To this aim in this section
we analytically derive the equilibria of the closed loop
system (2)–(5) subject to control (8),(9),(10). In particular
we are interested in the static nonlinear relationship between
 f
e
, i.e., the force exerted at the equilibrium by the quadrotor
on the environment through the tool-tip, and e, i.e., the 3D
control input that is left free by the controller described
in Sec. II. The goal of the following analysis will be to
ﬁnd e given a desired  f
e
. The equations to be solved
in order to ﬁnd the sought relation can be obtained by
writing (3),(5),(8),(9),(10) at the equilibrium (i.e., v= ˙ v=
w = ˙ w = 0). This results in the following nonlinear system
of 12 scalar equations
 lRˆ z+ mgˆ z+ f
e
= 0 (12)
t+ d R
>
f
e
= 0 (13)
t  K
A
h
e
= 0 (14)
lc
q
c
f
  mg+ k
PP
e
3
= 0 (15)

s
f
d
s
q
d

 
mk
PP
l

 s
y
c
y
 c
y
=c
f
 s
y
=c
f

e
1
e
2

= 0 (16)
where the 12 unknowns are the sought e
1
;e
2
;e
3
, together
with f;q;y;f
d
;q
d
;l;t
1
;t
2
;t
3
. The admissible values of
the variables are f;q2( 
p
2
;
p
2
), y2( p;p), and l > 0.
The known parameters are the external force components
f
e
1
; f
e
2
; f
e
3
, and m;g;d;K
A
;k
PP
and y
d
.
A. Total thrust l and e
3
Equation (12) can be rewritten as:
f
e
1
=l(c
y
c
f
s
q
+ s
y
s
f
) (17)
f
e
2
=l(c
f
s
y
s
q
  s
f
c
y
) (18)
f
e
3
+ mg=lc
q
c
f
(19)
from which it descends, after some straightforward algebra,
that the total thrust must be:
l =
q
( f
e
1
)
2
+( f
e
2
)
2
+( f
e
3
+ mg)
2
: (20)
Moreover, using (19) and (15) the unknown e
3
can immedi-
ately be obtained as
e
3
= 
f
e
3
k
PP
: (21)
6280
B. RPY Angles f;q;y, desired roll/pitch f
d
;q
d
, and e
1
:e
2
Operating the following change of variables:
x= c
f
s
q
y= s
f
; (22)
(17) and (18) can be rewritten as a linear system:

c
y
s
y
s
y
 c
y

x
y

=
1
l

f
e
1
f
e
2

(23)
that can be easily solved thus obtaining the following ex-
pressions for s
f
and s
q
s
f
=
1
l
( f
e
1
s
y
  f
e
2
c
y
) (24)
s
q
=
1
lc
f
( f
e
1
c
y
+ f
e
2
s
y
): (25)
Given the admissible values for f;q, it must be c
f
> 0
and c
q
> 0, therefore we have
c
f
=+
q
1  s
2
f
(26)
c
q
=+
q
1  s
2
q
: (27)
Substituting t in (13) from (14), we obtain:
 K
A
h
e
= d R
>
f
e
: (28)
Moreover, from equation (16) it is straightforward to express
s
f
d
and s
q
d
as
s
f
d
=
mk
PP
l
( s
y
e
1
+ c
y
e
2
) (29)
s
q
d
=
mk
PP
lc
f
( c
y
e
1
  s
y
e
2
) (30)
The system composed by (24),(25),(28),(29),(30) is thus
made by 7 equations with 7 unknowns f;q;y;f
d
;q
d
;e
2
;e
3
.
From this point the solution changes depending on the
values of the integral gains in K
A
.
1) No Integral Action (k
f
IA
= k
q
IA
= k
y
IA
= 0): This is the
most complex case. The third row of (28) is
K
PA
s
y
d
 y
= x[ f
1
(c
y
s
q
s
f
  s
y
c
f
)+ f
2
(s
y
s
q
s
f
+ c
y
c
f
)
+ f
3
s
f
c
q
] (31)
If d
x
= 0 then y=y
d
, and the solution for this case is given
in Sec. III-B.2.
In the general case of d
x
6= 0 we ﬁrst show how
f;q;y can be separately found solving the subsystem
formed by (24),(25),(31). In fact, plugging (24),(25),(26),(27)
into (31), after some algebra, we obtain a trigonometric
equation in which the only unknowns are s
y
and c
y
, i.e.,
the yaw y. Using the tangent half-angle substitution (ty
2
=
tan(
y
2
)) the trigonometric equation that can be written as a
8-th order polynomial equation:
(a
(2)
+a
(7)
)t
8
y
2
 2(a
(4)
+a
(8)
)t
7
y
2
 4(a
(2)
 a
(5)
 a
(6)
)t
6
y
2
 
2(4a
(3)
 3a
(4)
+a
(8)
)t
5
y
2
+2(8a
(1)
+3a
(2)
 4a
(5)
+4a
(6)
 a
(7)
)t
4
y
2
+
2(4a
(3)
 3a
(4)
+a
(8)
)t
3
y
2
 4(a
(2)
 a
(5)
 a
(6)
)t
2
y
2
+
2(a
(4)
+a
(8)
)ty
2
+a
(2)
+a
(7)
=0 (32)
where the coefﬁcients are deﬁned as follows:
a
(1)
=(k
a
f
e
1
c
y
d
)
2
; a
(2)
=(k
a
f
e
2
s
y
d
)
2
a
(3)
= 2k
2
a
f
e
1
c
y
d
( f
e
1
s
y
d
+ f
e
2
c
y
d
)
a
(4)
= 2k
2
a
f
e
2
s
y
d
( f
e
1
s
y
d
+ f
e
2
c
y
d
)
a
(5)
= k
2
a
[( f
e
1
s
y
d
)
2
+( f
e
2
c
y
d
)
2
+ 4 f
e
1
f
e
2
s
y
d
c
y
d
]
a
(6)
= a
2
a
 (k
a
lc
y
d
)
2
; a
(7)
= b
2
a
 (k
a
ls
y
d
)
2
a
(8)
= 2a
a
b
a
+ 2(k
a
l)
2
s
y
d
c
y
d
and
a
a
= f
e3
1
+ f
e
1
f
e2
2
  f
e
1
l
2
+ f
e
1
f
e2
3
+ f
e
1
f
e
3
mg
b
a
=  f
e3
2
  f
e2
1
f
e
2
+ f
e
2
l
2
+ f
e
2
f
e2
3
+ f
e
2
f
e
3
mg; k
a
=
 lk
PA
d
x
:
The real solutions of (32), that are efﬁciently found numer-
ically, represent only candidate solutions for y, since some
of them hold for negative values of c
q
and c
f
, which are
not allowed in our setting. In order to prune the candidates
it is then sufﬁcient to plug them in (24),(25),(26),(27) and
validate the found values by substitution in (31).
The variables f
d
and q
d
can be then computed from the
ﬁrst two rows of (28) and from the knowledge of f;q;y:
f
d
=f+
d
z
k
f
PA
[ f
e
1
(c
y
s
q
s
f
 c
f
s
y
)+ f
e
2
(s
y
s
q
s
f
+c
f
c
y
)+ f
e
3
s
y
c
q
]
(33)
q
d
=q 
d
z
k
q
PA
[ f
e
1
(c
q
c
y
)+ f
e
2
(s
y
c
q
)  f
e
3
s
q
]+
d
x
k
q
PA
[ f
e
1
(c
y
c
f
s
q
+ s
q
s
y
)+ f
e
2
(s
y
c
f
s
q
  s
f
c
y
)+ f
e
3
c
q
c
f
]
(34)
Finally, from (29),(30) it is easy to obtain
e
1
=
l
mk
PP
( s
y
s
f
d
  c
y
s
q
d
c
f
) (35)
e
2
=
l
mk
PP
(c
y
s
f
d
  s
y
s
q
d
c
f
): (36)
Fig. 2 shows the evolution of e
1
;e
2
;e
3
in this case, depending
on f
1
; f
2
; f
3
for typical values of the mechanical and control
parameters and y
d
= 0.
2) Integral Action only on y (k
f
IA
= k
q
IA
= 0, k
y
IA
> 0): In
this case, because of the integral action, at the equilibrium
we have that
y =y
d
: (37)
Therefore f;q;f
d
;q
d
can be computed directly by plug-
ging (37) in (24),(25),(26),(29),(30). Finally, as in the previ-
ous case, e
1
;e
2
are obtained from (35) and (36), respectively.
3) Integral Action on f and q (k
f
IA
> 0;k
q
IA
> 0, k
y
IA
any):
In this case the values of y;f and q can be computed as
per Sec. III-B.1 or as per Sec. III-B.2, depending on the
value of k
y
IA
(either equal or greater than zero). Then, because
of the integral actions, at the equilibrium we have f =f
d
6281
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
?0.2
0
0.2
0.4
0.6
0.8
f1
Pushing
 
 
e1 e2 e3
?2 ?1.5 ?1 ?0.5 0 0.5 1 1.5 2
?0.2
0
0.2
0.4
0.6
0.8
f3
Lifting/Dropping
 
 
e1?low f1 e2?low f1 e3?low f1 e1?high f1 e2?high f1 e3?high f1
?2 ?1.5 ?1 ?0.5 0 0.5 1 1.5 2
?0.2
0
0.2
0.4
0.6
0.8
Shifting Left/Right
f2
 
 
e1?low f1 e2?low f1 e3?low f1 e1?high f1 e2?high f1 e3?high f1
Fig. 2: Evolution of e
1
;e
2
;e
3
depending on f
1
; f
2
; f
3
[N] in the case
of ‘no integral action’.
and q =q
d
. Therefore, equating the rhs of (24) with the rhs
of (29) and the rhs of (25) with the rhs of (30) we obtain:
e
1
= 
f
e
1
mk
PP
e
2
= 
f
e
2
mk
PP
: (38)
C. Torques t
In any case can be retrieved by using (14), i.e.,
t = d R
>
f
e
: (39)
D. Short Discussion on the Equilibria
Let’s observe the expressions of e as function of the
desired force f
e
and the desired yawy
d
that we found in the
three different cases considered in Sec. III-B.1, III-B.2 and
III-B.3. First it can be observed that an analytical expression
in closed-form can be written only when at least some
integral actions are considered, while it must be numerically
computed when k
f
IA
= k
q
IA
= k
y
IA
= 0. Moreover, in all the
cases the value of e
3
only depends on the value of f
e
3
while
this decoupling property holds for e
1
and e
2
only in the third
case (where k
f
IA
> 0;k
q
IA
> 0, k
y
IA
any). In this last case it can
be also observed that the value of e does not depend on the
position d of the tool-tip in body frame.
IV. STABILITY OF THE EQUILIBRIUM POINTS
This section presents a numerical stability analysis for the
equilibrium points deﬁned in Sec. III using the indirect Lya-
punov method for the case of ‘no integral action’. We plan to
address the remaining cases in a future work. The dynamical
system deﬁned by (3),(4),(5) subject to control (8),(9),(10)
can be interpreted as nonlinear system ˙ x= f(x;u) with state
x=(p;v;h;w) and inputs u=(e;y
d
). In Sec. III we found
how to efﬁciently compute the equilibrium (x
e
;u
e
) for any
given external force f
e
. It is therefore possible to compute
the Jacobian matrix
¶ f
¶x
in (x
e
;u
e
) and efﬁciently check
its eigenvalues. Negativeness of the largest real part of all
the eigenvalues implies local asymptotical stability of the
equilibrium (x
e
;u
e
) for the nonlinear system [14].
To this aim, we numerically computed the eigenvalues
of the Jacobian matrix considering reasonable values for
the system parameters and letting f
e
;y
d
and d vary over
the domains of interest. In particular, we set m = 1 kg,
J = diagf0:13;0:13;0:22g kgm
2
, k
PP
= 10 b
P
= 9, k
z
PP
=
10, b
z
P
= 9, k
f
PA
= k
q
PA
= k
y
PA
= 12, k
f
DA
= k
q
DA
= k
y
DA
=
7. All the integral gains of the position and the atti-
tude controller were set to zero. In all these cases we
also set y
d
= 0. and consider all the possible positions
of the tool-tip d according to the design described in
Sec. V-A, i.e., d
x
2 f0:25;0:27;0:29;0:31;0:33;0:35g and
d
z
2 f 0:14; 0:11; 0:08; 0:05;0:5;0:8;0:11;0:14g (we
recall that we assumed, without loss of generality, d
y
= 0).
The forces are sampled considering ﬁve clusters that cover
typical interaction cases such as pure pushing/releasing,
lifting/dropping while pushing with low and high pushing
force, and shifting left/right while pushing with low and
high pushing force. Each of the ﬁve plots of Fig. 3 shows
the evolution of the largest real part within each of the ﬁve
clusters for every considered value of d
x
and d
z
. It is possible
to see that in all the cases in exam the largest real part is
negative thus resulting in a Hurwitz
¶ f
¶x
and, consequently,
in a locally asymptotically stable equilibria for the nonlinear
system. We now analyze more in detail each considered case.
1) Pushing/Releasing: In this cluster (ﬁrst plot in Fig. 3)
f
e
1
has been regularly sampled from 0 N to -5 N with a
sampling step 0.01 N while f
e
2
and f
e
3
have been keep equal
to zero. Since y
d
= 0, this corresponds to the case in
which the quadrotor is performing a frontal pushing on the
environment with pushing force  f
e
1
. In every case a smaller
d
x
corresponds to a larger absolute value of the real part.
This behavior is more evident when d
z
> 0, i.e., the tool-tip
is placed below the Center of Mass (CoM). The absolute
value is constant w.r.t. d
z
when d
z
> 0 and monotonically
decreasing w.r.t. d
z
when d
z
< 0.
2) Lifting/Dropping while Pushing: In these two clusters
(second and third plots of Fig. 3) f
e
3
is sampled between 0 N
to 2 N with sampling step 0.01 N and two different (constant)
values are considered for f
e
1
, corresponding to a low (-2.5 N)
and a high (-5 N) pushing force, respectively. The component
f
3
e
is kept equal to zero. The trends w.r.t. to d
x
and d
z
are
qualitatively comparable to the pure pushing case.
3) Shifting Left/Right while Pushing: In these two last
clusters (fourth and ﬁfth plots of Fig. 3) f
e
2
is regularly
sampled from -2 N to 2 N with a sampling step 0.01 N. The
frontal pushing force f
e
1
takes, as in the previous case, two
different constant values (soft and hard pushing) and f
3
e
is
kept equal to zero. Since y
d
= 0 this corresponds to the
case in which the quadrotor has to perform a lateral shift of
the tooltip. It is interesting to note that in the case of low
pushing force, basically d
z
does not affect the largest real
part. Dependency from the distance d
x
is in accordance with
6282
?0.14 ?0.11 ?0.08 ?0.05 0 0.05 0.08 0.11 0.14
?0.62
?0.6
?0.58
?0.56
?0.54
?0.52
Pushing
 
 
dx=0.25 dx=0.27 dx=0.29 dx=0.31 dx=0.33 dx=0.35
?0.14 ?0.11 ?0.08 ?0.05 0 0.05 0.08 0.11 0.14
?0.62
?0.6
?0.58
?0.56
?0.54
?0.52
Lift/Dropping while Pushing? Low Pushing Force
 
 
dx=0.25 dx=0.27 dx=0.29 dx=0.31 dx=0.33 dx=0.35
?0.14 ?0.11 ?0.08 ?0.05 0 0.05 0.08 0.11 0.14
?0.62
?0.6
?0.58
?0.56
?0.54
?0.52
Lift/Dropping while Pushing? High Pushing Force
 
 
dx=0.25 dx=0.27 dx=0.29 dx=0.31 dx=0.33 dx=0.35
?0.14 ?0.11 ?0.08 ?0.05 0 0.05 0.08 0.11 0.14
?0.62
?0.6
?0.58
?0.56
?0.54
?0.52
Shifting Left/Right while Pushing? Low Pushing Force
 
 
dx=0.25 dx=0.27 dx=0.29 dx=0.31 dx=0.33 dx=0.35
?0.14 ?0.11 ?0.08 ?0.05 0 0.05 0.08 0.11 0.14
?0.62
?0.6
?0.58
?0.56
?0.54
?0.52
Shifting Left/Right while Pushing? High Pushing Force
dz
 
 
dx=0.25 dx=0.27 dx=0.29 dx=0.31 dx=0.33 dx=0.35
Fig. 3: Stability of the linearized systems. Each square in the plots
represents the largest real part of the eigenvalues of
¶ f
¶x
when f
e
is
sampled along relevant interaction force trajectories (clusters) for
certain values of d
z
and d
x
.
the previous analyzed cases. Concerning the trend when f
e
1
=
-5 N we see that dependency from d
x
becomes relevant only
when d
z
> 0 (tooltip below the CoM).
V. PRELIMINARY EXPERIMENTS
To further validate the theoretical and numerical analysis
we developed an experimental setup that includes a in-house
developed quadrotor (described in Sec. V-A), a Six-Axis
force torque sensor ‘Gamma’ by ATI and an external motion
capture system aimed at tracking the position and orientation
of the quadrotor (see Fig. 1 for the CAD model and Fig. 5 for
its implementation). In this Sec. V-B we report the outcome
of a preparatory experiment that is designed to approximately
perform a pushing and releasing maneuver.
A. Quadrotor and Tool Design
The quadrotor used to perform the experiments is based
on the MK-Quadro MikroKopter platform. The overall mass
including the tool is 1.2 kg. To increase the agility and
decrease the size of the quadrotor we decided to use
20 cm diameter propellers. The overall diameter between
two opposing propeller axis is l = 0:314 m. The distance
vector between the tool-tip and the quadrotor body frame in
performed experiment is d=(0:334;0:0;0:056) m. A copy
of the tool was mounted on the opposite side in order to
balance the weight of the one actually used to apply force on
Fig. 4: Left: CAD picture of tool tip: 1. Gimbal bearing, 2. Springs
to stabilize gimbal, 3. End effector plate, 4. Micro switch, 5.
Connection to quadrotor, 6. Springs to bring back the plate in rest
position when not in contact; Right: Schematic side view of tool
tip presenting the degrees of freedom of the tool tip.
the sensor (see Fig. 1). The tool tip end effector (see Fig. 4)
includes a gimbal bearing offering degrees of freedom in
all the rotation axis (thus allowing the implementation of a
hard ﬁnger contact). As it was mounted on our quadrotor, a
big degree of freedom (45

) was offered around the pitch
axis. To stabilize this degree of freedom a spring system is
keeping the end effector tool-tip in the zero position when
not in contact. Minor degrees of freedom (15

) are offered
around the roll and yaw axis. The end effector tip additionally
includes a micro switch that detects the contact.
B. Preliminary Result
In Fig. 5 a sequence of snapshots of the performed
experiment is shown. The quadrotor equipped with the tool
was remotely driven by a human operator to establish a
contact with the surface. During the contact-free phase the
operator commands a desired velocity to the UA V . During the
contact phase the operator directly commands e
1
, by means
of a joystick, to let the pushing force applied by the robot
on the surface follow approximately a trapezoidal proﬁle
(relying on the quasi-linear relation of Fig. 2 top). The results
obtained during the experiments are plotted in Fig. 6. The
plots refer only to the contact phase. It is easy to observe how
the force applied by the quadrotor and read by the sensor
follows the shape of the desired e. Moreover the ﬁngertip
position remains practically constant during the experiment
(no slippage occurs at the contact point). Finally in Fig. 7 the
linear relationship between the applied pushing force and the
signal e
1
commanded by the operator is plotted. The expected
hysteresis is due to the fact that it is almost impossible for
a human operator to fulﬁll the quasi-staticity of the motion
due to the coarse control over e
1
allowed by a small joystick.
For the same reason, the increasing and the decreasing phases
are clearly asymmetric in Fig. 6. The reader is encouraged
to watch the video attached to this submission in which the
preliminary experiment is shown.
VI. CONCLUSIONS AND FUTURE WORK
In this paper we presented a control design that allows a
quadrotor to exert a desired 3D contact force on a surface
through a tool rigidly attached on it. We showed how the
same near-hovering controller used for the free ﬂight can be
used in contact with the environment to generate a desired
contact force. The stability of the system has been then
studied and its dependence on the desired 3D force and the
6283
Fig. 5: Snapshots of time series while quadrotor is performing the experiment.
0 5 10 15
?2
?1
0
Center?of?Mass Position
[m]
0 5 10 15
?0.1
0
0.1
Roll and Pitch
[rad]
0 5 10 15
1.4
1.5
1.6
Yaw
[rad]
0 5 10 15
?25
?20
?15
Thrust
[N]
time[s]
0 5 10 15
?0.5
0
0.5
Commanded e
[m]
0 5 10 15
?2
?1
0
Fingertip Position
[m]
0 5 10 15
?0.06
?0.04
?0.02
Tool?tip height ? C?o?M height
[m]
time[s]
0 5 10 15
?2
0
2
Exerted Force
[N]
Fig. 6: The main quantities recorded during the performed experi-
ment.
?0.5 0 0.5 1 1.5
0
0.1
0.2
0.3
0.4
e
?f
e
Fig. 7: The relationship between the commanded signal e
1
and the
force read from the sensor during the contact phase (  f
1
).
position of the tool-tip in body frame has been investigated.
The presented theory has been validated by preliminary
experimental results in which a human operator manually
increased and decreased the value of the error component
e
1
, emulating a “Push and Release” task.
As future work we want to thoroughly study the dynamic
case and perform full experiments with an autonomous robot
in order to validate the approach in the different interaction
cases considered in the paper. The desired interaction forces
will be given as input to the system thus fully exploiting the
theoretical results derived in Section III.
ACKNOWLEDGMENTS
The research leading to these results has received funding
from the European Union Seventh Framework Programme
FP7/2007-2013 under grant agreement n 601165 of the
project WEARHAP WEARable HAPtics for humans and
robots.
REFERENCES
[1] D. J. Lee and C. Ha, “Mechanics and control of quadrotors for tool
operation,” in 2012 ASME Dynamic Systems and Control Conference,
(Fort Lauderdale, FL), Oct. 2012.
[2] M. Fumagalli, R. Naldi, A. Macchelli, R. Carloni, S. Stramigioli,
and L. Marconi, “Modeling and control of a ﬂying robot for contact
inspection,” in 2012 IEEE/RSJ Int. Conf. on Intelligent Robots and
Systems, (Vilamoura, Portugal), pp. 3532–3537, Oct 2012.
[3] S. Bellens, J. De Schutter, and H. Bruyninckx, “A hybrid pose/wrench
control framework for quadrotor helicopters,” in 2012 IEEE Int. Conf.
on Robotics and Automation, (St.Paul, MN), pp. 2269–2274, May
2012.
[4] M. B. Srikanth, A. Soto, A. Annaswamy, E. Lavretsky, and J.-J.
Slotine, “Controlled manipulation with multiple quadrotors,” in AIAA
Conf. on Guidance, Navigation and Control, (Portland, OR), Aug.
2011.
[5] L. Marconi, R. Naldi, and L. Gentili, “Modeling and control of a ﬂying
robot interacting with the environment,” Automatica, vol. 47, no. 12,
pp. 2571–2583, 2011.
[6] B. Y¨ uksel, C. Secchi, H. H. B¨ ulthoff, and A. Franchi, “Reshaping the
physical properties of a quadrotor through ida-pbc and its application
to aerial physical interaction,” in 2014 IEEE Int. Conf. on Robotics
and Automation, (Hong Kong, China), May. 2014.
[7] M. Orsag, C. Korpela, and P. Oh, “Modeling and control of MM-UA V:
Mobile manipulating unmanned aerial vehicle,” Journal of Intelligent
& Robotics Systems, vol. 69, no. 1-4, pp. 227–240, 2013.
[8] V . Lippiello and F. Ruggiero, “Exploiting redundancy in cartesian
impedance control of UA Vs equipped with a robotic arm,” in 2012
IEEE/RSJ Int. Conf. on Intelligent Robots and Systems, (Vilamoura,
Portugal), pp. 3768–3773, Oct. 2012.
[9] G. Gioioso, A. Franchi, G. Salvietti, S. Scheggi, and D. Prattichizzo,
“Hand driven UA V formation for cooperative grasping and trans-
portation: the ﬂying hand,” in RSS 2013 Work. on Aerial Mobile
Manipulation, (Berlin, Germany), June 2013.
[10] D. Prattichizzo and J. C. Trinkle, “Grasping,” in Springer Handbook
of Robotics (B. Siciliano and O. Khatib, eds.), pp. 671–700, Springer,
2008.
[11] N. Michael, D. Mellinger, Q. Lindsey, and V . Kumar, “The GRASP
multiple micro-UA V testbed,” IEEE Robotics & Automation Magazine,
vol. 17, no. 3, pp. 56–65, 2010.
[12] A. Franchi, C. Secchi, H. I. Son, H. H. B¨ ulthoff, and P. Robuffo
Giordano, “Bilateral teleoperation of groups of mobile robots with
time-varying topology,” IEEE Trans. on Robotics, vol. 28, no. 5,
pp. 1019–1033, 2012.
[13] D. J. Lee, A. Franchi, H. I. Son, H. H. B¨ ulthoff, and P. Robuffo
Giordano, “Semi-autonomous haptic teleoperation control architecture
of multiple unmanned aerial vehicles,” IEEE/ASME Trans. on Mecha-
tronics, Focused Section on Aerospace Mechatronics, vol. 18, no. 4,
pp. 1334–1345, 2013.
[14] J. J. E. Slotine and W. Li, Applied nonlinear control. Prentice Hall,
1991.
6284
