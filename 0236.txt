Filter Design for Localization aided by Direction and Doppler
Measurements
Joel Reis, Paulo Oliveira, Pedro Batista and Carlos Silvestre
Abstract—This paper presents a localization solution for the
study of tagged marine animals (sources) based on direction
and Doppler measurements. The source localization, in 3-D,
is supported by a Portable Underwater Robotic Tool (PURT),
comprisingaUltra-ShortBaseline(USBL)aidedINSnavigation
system, carried by a diver (agent). Furthermore, a Surface
RoboticTool(SRT)providestheagentwithitsabsoluteposition
expressed in inertial coordinates. The observability of the
system is studied and realistic simulation results are presented,
in the presence of measurement noise.
I. INTRODUCTION
During the last decades, efforts have often been concen-
trated in large scale observation of marine species, as re-
ported in [1] and [2]. In order to attain satisﬁable localization
results, whether absolute or relative, the species under study
should spend most of their time at the surface, which is
a non-controllable and quite unpredictable behavior of the
animals. In addition, marine animal studies require an innate
need for human approach, i.e. consolidated strategies that
allow the biologist to work underwater and to be provided
with knowledge of the surroundings. Notwithstanding, the
absolute position of the agent could also be a leading
requirement, where acoustic positioning methods based on
time-of-ﬂight measurements [3] or Long Baseline systems
[4] are common solutions.
In another approach, the problem of source localization
may be complemented with a navigation scenario including
path following, where the follower is the agent and the
path is outlined by a surface vehicle, the latter being the
source. Assuming the agent is an Autonomous Underwater
Vehicle (AUV), a solution was recently proposed in [5] for
the navigation problem, whereas in [6] a new method for
simultaneous source localization and navigation is presented.
The previous solutions were shown to be globally asymptot-
ically stable (GAS) under a persistent excitation condition.
Interestingly, the same condition is also evidenced in the
works of Antonelli et. al. [7], despite a trend towards the
use of robotic vehicles presented therein.
Nevertheless, the key aspect in studies has been the iden-
tiﬁcation of the position of the study targets, hereinafter des-
ignated as sources and, in spite of the everyday contributions
for Navigation Systems based on Global Positioning System
This work was supported by project FCT PEst-OE/EEI/LA0009/2013 and
by project FCT MAST/AM - PTFC/EEA - CRO/111107/2009
The authors are with the Institute for Systems and Robotics, Instituto
Superior Técnico, Universidade de Lisboa, Av. Rovisco Pais, 1049-001
Lisboa, Portugal. Carlos Silvestre is also with the Department of Electrical
and Computer Engineering, Faculty of Science and Technology of the
University of Macau.
{joelreis,pjcro,pbatista,cjs} @isr.ist.utl.pt
(GPS), the underwater environment remains incompatible
with the application of such methods, namely RF commu-
nications. Instead, USBL acoustic positioning systems have
become reliable tools, even if with lower quality perfor-
mances, though with satisﬁable accuracy results, which can
be improved in the aftermath of the application of Kalman
ﬁlters and INS tightly-coupled integration techniques [8].
Moreover, with proper processing of acoustic signals, one
can extract more information besides the position, for in-
stance an unambiguous tag identiﬁcation or relative velocity.
Recent developments in acoustic transmitters, mainly the
de facto standard from VEMCO
c 
, have even allowed to
incorporate, through time delay codiﬁcation coding, further
characteristics of the environment like temperature and pres-
sure, with respect to the location of the source. These trans-
mitters, with long periods of autonomy, are an affordable and
effective solution for underwater ﬁelds of research.
Recently, under the scope of the FCT funded MAST/AM
project, an apparatus was designed and built that presents a
convenient solution for maritime biologists (agents) to carry
into the underwater environment. The full set of equipment
includes a Surface Robotic Tool (SRT), presented in [9],
and recent developments allowed to reach a ﬁnal stage on
the Portable Underwater Robotic Tool (PURT) construction.
The latter is essentially an extension of the body of the
diver, providing a high degree of maneuverability in order
to track moving sources (commonly ﬁshes) equipped with
(commercially available) low power consumption acoustic
signal transmitters.
The main contribution of this paper is to provide the
scientiﬁc community with a new ﬁlter design for source lo-
calization problems based on direction and Doppler measure-
ments. The observability of the system is studied and a time-
varying Kalman ﬁlter with GAS error dynamics is proposed,
without any system linearization. Proper simulations sustain
the validity of the projected ﬁlter, thus by the end of the
paper a novel source localization methodology is ready to
attain the imposed requirements by the MAST/AM project.
This paper is organized as follows. Section II describes the
framework of the problem and outlines the system dynamics.
The ﬁlter design together with the proof of observability are
presented in Section III, while Section IV includes simulation
results along with discussions. Conclusions and future work
are reported in Section V.
A. Notation
Throughout the paper, a bold symbol stands for a multi-
dimensional variable, the symbol 0 denotes a matrix of zeros
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2957
and I an identity matrix, both of appropriate dimensions.
A block diagonal matrix is represented as diag(A
1
,...,A
n
)
and the set of unit vectors on R
3
is denoted by S(2). (t)
represents the Dirac delta function. A positive-deﬁnite matrix
M is identiﬁed as M 0.
II. PROBLEM STATEMENT
A. Motivation and Framework
The MAST/AM project, whose mission scenario is de-
picted in Fig. 1, consists of a SRT, commonly a Surface
Buoy (SB) with USBL aided INS and GPS based navigation
system, which may or not be stationary; an agent carrying a
PURT also equipped with a USBL system; lastly, a source
with an attached low power consumption acoustic signal
transmitter. The SRT collaborates with the agent, therefore
it is possible to assume that the agent knows its own current
position p(t) expressed in inertial coordinates, which is
transmitted by the SRT. The goal of the agent is to determine
in the inertial framework the source position s(t) and the
source velocity v
s
(t). The Doppler measurements, v
d
, are
proportional to the relative velocity between the agent and the
source, hence one needs to estimate the agent velocity v
p
(t)
to fully characterize the system. Overall, the relative position
is, truly speaking, the main objective of the MAST/AM
project.
Fig. 1: MAST/AM mission scenario.
The Doppler velocity measurements are obtained through
post processing of the incoming signals. With the knowledge
of their natural frequency of transmission, which is an
immutable speciﬁcation, and by determining the Fast Fourier
Transform (FFT), it is possible to calculate the frequency
shift, which is directly proportional to the absolute relative
velocity between the agent and the source.
B. System Dynamics
Consider a PURT carried by a diver (the full set may be
interpreted as the agent) moving in an underwater scenario
where there is also a moving source, which can be for
example a ﬁsh under a study routine, equipped with a device
that transmits, with a ﬁxed ratio, a known acoustic signal,
allowing the agent to determine the direction and the Doppler
velocity according to its own body frame,B, whose point of
origin is placed in a suitable mechanical location, typically
the centroid of the USBL array. Further, the agent interro-
gates the SRT, thereupon it obtains its position expressed in
an inertial frameI.
To conclude the deﬁnition of the framework, let p(t)2R
3
be the agent position in inertial coordinates, while s(t)2R
3
denotes the source position also in inertial coordinates. The
velocity of the agent, which is unknown, is thus given by
v
p
(t) = _ p(t)2R
3
and the source is moving with velocity
v
s
(t) = _ s(t)2R
3
; both velocities are expressed in inertial
coordinates. The ﬁrst mild assumption here is that both agent
and source have constant velocity, therefore _ v
s
(t) = 0 and
_ v
p
(t) = 0.
The agent measures the direction to the source expressed
inB, d
B
(t)2R
3
, however, after interrogating the SRT, the
agent learns its body orientation according toI, wherewith
he may obtain the direction of the source expressed inI. It
results
d(t) =
I
B
R(t)d
B
(t)2S(2); (1)
where
I
B
R(t)2SO(3) is the rotation matrix used to perform
the rotation in the Euclidean space fromB toI. Another way
to denominate the direction is
d(t) = r(t)kr(t)k
 1
; (2)
with r(t) := s(t)  p(t)2R
3
. The scalar Doppler velocity,
v
d
2R, is seen as the subtraction of the projected velocity
vectors over the radial direction that uniﬁes the agent and the
source, i.e. the direction of the agent to the source. Thus, it
is possible to write
v
d
= (v
T
s
(t)  v
T
p
(t))d(t):
The system dynamics can then be written as
8
>
>
>
>
>
>
>
>
>
<
>
>
>
>
>
>
>
>
>
:
_ s
T
(t) = v
T
s
(t)
_ p
T
(t) = v
T
p
(t)
_ v
T
s
(t) = 0
_ v
T
p
(t) = 0
d(t) = (s(t)  p(t))ks(t)  p(t)k
 1
v
d
= (v
T
s
(t)  v
T
p
(t))d(t)
(3)
and the problem is to estimate the position of the source
s(t) and its velocity v
s
(t), even if the latter is not a primary
requirement for the project, and ﬁnally the velocity of the
agent v
p
(t). In other words, it is intended to design an
estimator for the non-linear system (3).
III. LOCALIZATION FILTER DESIGN
This section presents a ﬁlter design methodology for the
problem stated in Section II. First, a linear time-varying
system is introduced in Section III-A. Afterwards, in Section
III-B the observability of this system is analysed. The ﬁlter
design is then discussed in Section III-C.
2958
A. System States
As seen in (3), the agent velocity has to be estimated so
that the source velocity can also be estimated. That means
the agent position, although a known variable, will also be
part of the states vector. Furthermore, being a transmitted
information from the SRT into the PURT, the agent position
is affected by sensor noise, thus becoming a measurement
for all purposes.
The state vector is
x(t) = [s
T
(t) p
T
(t) v
T
s
(t) v
T
p
(t)]
T
2R
12
:
However, this will not be enough to design an estimator
for the nonlinear system dynamics, having considered the
direction to the source as part of the measurements. To
circumvent this impasse, add the distance between the agent
and the source as one state, resulting in
x(t) = [s
T
(t) p
T
(t) v
T
s
(t) v
T
p
(t) kr(t)k]
T
2R
13
:
Next, the derivative of the range is given by
d
dt
kr(t)k =
d
dt
q
[s
T
(t)  p
T
(t)][s(t)  p(t)]
=
 
_ r
T
(t)r(t)+ r
T
(t)_ r(t)

(2kr(t)k)
 1
=
 
v
T
s
(t)  v
T
p
(t)

d(t) =v
d
;
which comes as no surprise, since the distance between
the source and the agent is expected to remain constant if
v
d
= 0. Still, this does not necessarily mean that both agent
and source are at rest; one of them may be stopped while
the other travels around the ﬁrst in perfect circles, i.e. the
internal product between the direction and the velocity of
the moving target returns zero, such as they can also be both
moving with the same speed and orientation. These situations
must be avoided, leading to the requirement of some kind of
persistent excitation condition.
The states vector derivative can be written as
_ x(t) = [v
T
s
(t) v
T
p
(t) 0 0 v
d
]
T
2R
13
:
Since there exists no inputs in neither the agent nor the
source, the system dynamics can be written as an LTV system
expressed by
(
_ x(t) = A(t)x(t)
y(t) = C(t)x(t)
; (4)
where
A(t) =
2
6
6
6
6
4
0 0 I 0 0
0 0 0 I 0
0 0 0 0 0
0 0 0 0 0
0 0 d
T
(t)  d
T
(t) 0
3
7
7
7
7
5
2R
1313
:
Exploiting the fact of adding the range as a state, a subtle
trick can be made in order to avoid the nonlinearity caused
by direction measurements.
From (2), it can be written
0 = s(t)  p(t) ks(t)  p(t)kd(t);
and the measurements vector, y(t)2R
7
, becomes
y(t) =
2
6
4
p(t)
0
v
d
3
7
5 =
2
6
4
s(t)  d(t)ks(t)  p(t)k
s(t)  p(t)  d(t)ks(t)  p(t)k
(v
s
(t)  v
p
(t)) d(t)
3
7
5;
(5)
hence the system matrix C(t) follows as
C(t) =
2
4
0 I 0 0 0
I  I 0 0  d(t)
0 0 d
T
(t)  d
T
(t) 0
3
5
2R
713
:
B. Observability Analysis
The observability of the problem of source localization
with Doppler velocity readings and direction measurements
is studied in this section. The following proposition [Propo-
sition 4.2, [10]] is useful in the sequel.
Proposition: Let f(t) : [t
0
;t
f
]R!R
n
be a continuous
and i-times continuously differentiable function on T :=
[t
0
;t
f
];T :=t
f
 t
0
> 0, and such that
f(t
0
) =
_
f(t
0
) =::: = f
i 1
(t
0
) = 0:
Further assume that there exists a nonnegative constant C
such thatkf
(i+1)
(t)kC for allt2T . If there exist> 0
and t
1
2T such thatkf
(i)
(t
1
)k  then there exist 0 <
T and  > 0 such thatkf(t
0
+k.
To prove the observability is to guarantee the outputs are
enough to determine the correspondent current state. That
said, a generic response y(t) must determine uniquely an
initial state x(t
0
).
From the Peano-Baker series it follows the transition
matrix associated to A, denoted by (t;t
0
)2 R
1313
, and
given by
(t;t
0
) =
2
6
6
6
6
4
I 0 (t t
0
)I 0 0
0 I 0 (t t
0
)I 0
0 0 I 0 0
0 0 0 I 0
0 0
R
t
t0
d
T
()d  
R
t
t0
d
T
()d 1
3
7
7
7
7
5
:
The condition to guarantee the observability of the LTV
expressed in (4) is to ensure that the Observability Gramian
is invertible, which is deﬁned by
W(t
0
;t
f
) :=
Z
t
f
t0

T
(;t
0
)C
T
()C()(;t
0
)d:
Theorem: The LTV system (4) is observable onT if and
only if the direction vector d(t) does not remain constant
between two successive moments. Mathematically speaking,
9
t12T
: d
T
(t
0
)d(t
1
)< 1: (6)
Proof: Obviously, if the direction remained constant
the internal product between the two vectors would wind up
to be the norm of d raised to second power, i.e. 1.
Let c = [c
T
1
c
T
2
c
T
3
c
T
4
c
5
]
T
2 R
13
, with c
i
2 R
3
, for
i = 1;2;3;4, and c
5
2R, be a unit vector. Since it must be
kck = 1 for all c,
c
T
W(t
0
;t
f
)c6= 0
2959
in order to the LTV system be observable. Then,
c
T
W(t
0
;t
f
)c =
Z
t
f
t0
kf()k
2
d;
where
f() =

f
T
1
() f
T
2
() f
3
()

T
2R
7
;2T;
with
f
1
() = c
2
+( t
0
)c
4
2R
3
;
f
2
() = c
1
  c
2
+
+

( t
0
)I  d()
Z

t0
d
T
()d

(c
3
  c
4
)  d()c
5
2R
3
;
and
f
3
() = d
T
()(c
3
  c
4
)2R:
As for the ﬁrst two derivatives of f() in order to , they
are given by
df()
d
=
2
4
c
4
df2()
d
_
d
T
()(c
3
  c
4
)
3
5
2R
7
;
with df
2
()=d resulting in
df
2
()
d
=

I 
_
d()
Z

t0
d
T
()d  d()d
T
()

(c
3
  c
4
)
 
_
d()c
5
;
and
d
2
f()
d
2
=
2
4
0
d
2
f2()
d
2

d
T
()(c
3
  c
4
)
3
5
2R
7
;
where
d
2
f
2
()
d
2
=

 

d()
Z

t0
d
T
()d 3
_
d()d
T
()

(c
3
  c
4
)
 

d()c
5
:
Assume then that the condition in (6) is not veriﬁed, i.e.
the direction vector remain constant and equal to d(t
0
) for
all t2T , and let c
2
= c
3
= c
4
= 0. It results
f
2
() = c
1
  d()c
5
:
Since c is a unit vector one can deﬁne c
1
=
p
2
2
d(t
0
) and
c
5
=
p
2
2
, therefore
f
2
() =
p
2
2
d(t
0
)  d()
p
2
2
= 0 8t2T;
the Observability GramianW is not invertible and the LTV
system is not observable. As one may conclude, the condition
in (6) has to be true on T for the LTV system to be
observable also onT .
A different procedure is employed to show that (6) is also
a sufﬁcient condition. Start by evaluating f() att
0
, yielding
f(t
0
) =
2
4
c
2
c
1
  c
2
  d(t
0
)c
5
d
T
(t
0
)(c
3
  c
4
)
3
5
:
Firstly, two cases may be considered: i) if c
2
6= 0,
then kf(t
0
)k > 0, and it follows from Proposition that
c
T
W(t
0
;t
f
)c > 0; ii) c
2
= 0 and c
1
6= d(t
0
)c
5
leads
again tokf(t
0
)k> 0, succeeding c
T
W(t
0
;t
f
)c> 0.
Now, if c
3
6= c
4
, f
3
(t
0
)6= 0)kf(t
0
)k > 0, resulting
c
T
W(t
0
;t
f
)c> 0. For further analysis on combinations of
possible values of c, one needs the evaluation of df()=d
at  =t
0
, which is given by
df()
d




=t0
=
2
4
c
4

I  d(t
0
)d
T
(t
0
)

(c
3
  c
4
) 
_
d(t
0
)c
5
_
d
T
(t
0
)(c
3
  c
4
)
3
5
:
Suppose now that c
2
= 0, c
1
= d(t
0
)c
5
, for any scalar
c
5
, and c
3
= c
4
so that f(t
0
) = 0. If c
4
6= 0, df
1
=d 6=
0 ) kdf()=dj
=t0
k > 0 and it follows from using
twice the Proposition introduced in the beginning of this
section that c
T
W(t
0
;t
f
)c> 0. In opposition, if c
3
= 0)
c
4
= 0 one obtains
df()
d



=t0
=
h
0  
_
d
T
(t
0
)c
5
0
i
T
and
d
2
f()
d
2




=t0
=
h
0  

d
T
(t
0
)c
5
0
i
T
.
Sincekck = 1, and if c
1
had been 0 before, then it must
bec
5
= 1 to hold the fact thatkck is a unit vector, however
proceed considering c
1
= d(t
0
)c
5
.
If
_
d(t
0
)6= 0,kdf()=dj
=t0
k > 0 and, using Propo-
sition twice, c
T
W(t
0
;t
f
)c > 0. The direction is under
a continuous-time function and according to (6) it is true
that at least there is a moment, suppose t
1
, when the
direction derivative can not be zero, i.e.
_
d(t
1
) 6= 0, re-
sulting kdf()=dj
=t1
k > 0. Using Proposition twice,
c
T
W(t
0
;t
f
)c> 0.
The proof is thus concluded as it is shown that
c
T
W(t
0
;t
f
)c > 0 for all kck = 1, which means that
the observability Gramian is invertible and as such (4) is
observable.
C. Kalman Filter
Section III-A introduced a LTV system for source local-
ization based on direction and Doppler measurements and
its observability was studied in Section III-B. In particular,
it was shown that the LTV system (3) is observable if (6) is
satisﬁed. The Kalman ﬁlter follows as the natural estimation
solution and, as it is widely known, its design is omitted in
this paper. The system dynamics, including additive system
disturbances and sensor noise, can be written as
(
_ x(t) = A(t)x(t)+ w(t)
y(t) = C(t)x(t)+ n(t)
;
where w(t)2R
13
is zero-mean white Gaussian noise, with
E[w(t)w
T
(t )] = (),  0, n(t)2R
7
is zero-mean
white Gaussian noise, with E[n(t)n
T
(t )] = () and
 0. The noises are uncorrelated, thereforeE[w(t)n
T
(t 
)] = 0. Finally, the case considered here is the common
one, where the noises are additive, however, that might not
be the reality and thus the proposed solution is sub-optimal.
2960
IV. SIMULATION RESULTS
This section presents the simulation results for the source
localization problem in order to evaluate the performance
of the proposed solutions. Since (6) must be satisﬁed so
that the system is observable, one must add some kind of
persistent excitation capable of changing the evolution of
direction in the course of time. Therefore, since the behavior
of the source is stochastic in most cases, the aforementioned
excitation should be properly added as part of the agent
movement. The resulting trajectories are depicted in Fig. 2.
The initial position of the agent and the source were set
0
200
400
600
800
1000
1200
?5
0
5
0
1
2
3
4
5
z (m)
 
 
x (m)
y (m)
Source
Agent
Fig. 2: Source and agent trajectories.
to p(0) = [0 0 2]
T
m and s(0) = [0 0 4]
T
m, respectively.
The source velocity is assumed to be constant and the
agent velocity is based on a sinusoidal evolution along the
longitudinal axis. Note that despite a sinusoidal behavior,
the inertial acceleration of the agent _ v
p
is indeed close
to 0, whereby the assumption of v
p
being constant is not
overridden.
Noise was considered for both the directions measure-
ments and the Doppler quantities. Notwithstanding, note that
according to (5), since three entries of the measurements
are considered to be zero, noise can be left outside in what
concerns those same measurements as a consequence of a lin-
earization manipulation. Thereby, zero-mean additive Gaus-
sian noise was considered for the Doppler measurements,
with standard deviation of 0:01m/s. The direction readings
were assumed perturbed by rotations about random vectors
of an angle modelled by zero-mean white Gaussian noise,
with standard deviation of 1

. Zero-mean additive Gaussian
noise with standard deviation of 0:1m was considered for
p(t).
The Kalman ﬁlter parameters were set to  = diag(10
 5
I,
10
 5
I,10
 5
I,10
 1
I,10
 3
) and  = I. The initial estimates
were all set to zero.
The evolution of the estimation error for the source
position is depicted in Fig. 3 and for the source velocity
is depicted in Fig. 4, along with their respective detailed
evolutions. Fig. 5 presents the same results for the agent
velocity. With the chosen ﬁlter parameters, the transients in
both ﬁgures quickly fade out and the estimation error con-
verges to zero with small deviations, proving the efﬁciency
of the proposed solution.
0 50 100 150 200 250 300
?10
?5
0
5
Time (s)
Error (m)
 
 
sx
sy
sz
(a) Initial convergence.
300 400 500 600 700 800 900 1000
?0.2
?0.1
0
0.1
Time (s)
Error (m)
 
 
sx
sy
sz
(b) Detailed evolution.
Fig. 3: Evolution of the source position estimation error.
0 50 100 150 200 250 300
?1
?0.5
0
0.5
Time (s)
Error (m/s)
 
 
vx
vy
vz
(a) Initial convergence.
300 400 500 600 700 800 900 1000
?4
?2
0
2
4
x 10
?3
Time (s)
Error (m/s)
 
 
vx
vy
vz
(b) Detailed evolution.
Fig. 4: Evolution of the source velocity estimation error.
So far the source was considered to move with linear ve-
locity. However, some marine species of reduced dimensions
possess a unique way of motion characterized by constant
oscillations with high frequency. When v
s
is updated to a
more realistic behavior, the estimations do not follow up to
the references, which means the ﬁlter has no capability of
processing such fast variations of amplitude. The solution to
this problem consists in improving the dynamics model of
the velocity.
The source velocity oscillations can be interpreted as an
output of a second order oscillator. The latter could be in fact
the output of a narrow band-pass ﬁlter when injected with
white noise. Recalling the band-pass ﬁlter transfer function,
it follows
V
s
(s)
W(s)
=k
2!
s
s
s
2
+2!
s;y
s+!
2
s
: (7)
2961
0 50 100 150 200 250 300
?1
?0.5
0
0.5
Time (s)
Error (m/s)
 
 
vx
vy
vz
(a) Initial convergence.
300 400 500 600 700 800 900 1000
?0.05
0
0.05
Time (s)
Error (m/s)
 
 
vx
vy
vz
(b) Detailed evolution.
Fig. 5: Evolution of the agent velocity estimation error.
where is the dumping factor,!
n
is the natural frequency of
the oscillations,k is the ﬁlter gain and V
s
(s) is the Laplace
transform of v
s
(t). As for the Laplace transform of the noise,
W(s), it was assumed additive noise in order to maintain the
system with linear properties. Presupposing now that only the
y-component of the source velocity is mutable, converting (7)
into a time domain formalism yields
 v
s;y
(t)+2!
s;y
_ v
s;y
(t)+!
2
s;y
v
s;y
(t) = 2k!
s;y
_ w(t): (8)
The noise derivative is likely to be avoided. The same is valid
for the derivative of the acceleration, i.e.  v
s;y
(t). Integrating
both sides of (8) returns
_ v
s;y
(t)+2!
s;y
v
s;y
(t)+!
2
s;y
s
y
(t) = 2k!
s;y
w(t):
The dumping factor is a pseudo-indicator of how perfect the
oscillations are, whereby it can be left as  = 0:005. As
for the natural frequency of oscillations it was speculated a
value around 0:05Hz.k is a rather ambiguous parameter and
it can be interpreted as a gain adjustment.
After ﬁne-tuning of the ﬁlter parameters, new simulation
results were obtained. The evolution of the estimation error
can be found in Fig. 6, while the evolution of the estimate
can be seen in Fig. 7 along with the comparison with the
real value evolution.
V. CONCLUSIONS
This paper presented a novel time-varying Kalman ﬁlter
with globally asymptotically stable error dynamics for the
problem of localization based on direction and Doppler
measurements to a single source. The observability of the
system was fully characterized, which allowed to conclude
about the asymptotic stability of the ﬁlter. Simulations results
were presented that illustrate the good performance achieved
by the proposed solution. Future work includes sea tests
under the scope of the MAST/AM project.
REFERENCES
[1] P. Tsang, M.C. Melynchuk, and D.W. Welch. A continental-scale
ocean observation system to gather biological and oceanographic data
for marine resource management. In OCEANS, 2005. Proceedings of
MTS/IEEE, pages 2179–2182 V ol. 3, 2005.
0 50 100 150 200 250 300
?0.1
?0.05
0
0.05
0.1
Time (s)
Error (m/s)
 
 
e y
(a) Initial convergence.
300 400 500 600 700 800 900 1000
?0.1
?0.05
0
0.05
0.1
Time (s)
Error (m/s)
 
 
e y
(b) Detailed evolution.
Fig. 6: Evolution of the source velocity estimation error.
0 50 100 150 200 250 300
?0.1
?0.05
0
0.05
0.1
Time (s)
Velocity (m/s)
 
 
vy
ˆ vy
Fig. 7: Source velocity: true vs. estimated evolutions.
[2] H. Martin, W. Evans, and C. Bowers. Methods for radio tracking
marine mammals in the open sea. In Engineering in the Ocean
Environment, IEEE 1971 Conference on, pages 44–49, 1971.
[3] A. Caiti, A. Garulli, F. Livide, and D. Prattichizzo. Localization
of autonomous underwater vehicles by ﬂoating acoustic buoys: a
set-membership approach. Oceanic Engineering, IEEE Journal of,
30(1):140–152, 2005.
[4] Pan-Mook Lee, Bong-Huan Jun, Hyun-Taek Choi, and Seok-Won
Hong. An integrated navigation systems for underwater vehicles based
on inertial sensors and pseudo lbl acoustic transponders. In OCEANS,
2005. Proceedings of MTS/IEEE, pages 555–562 V ol. 1, 2005.
[5] P. Batista, C. Silvestre, and P. Oliveira. Globally asymptotically stable
ﬁlter for navigation aided by direction and depth measurements. In
Decision and Control (CDC), 2012 IEEE 51st Annual Conference on,
pages 6603–6608, 2012.
[6] Pedro Batista, Carlos Silvestre, and Paulo Oliveira. Globally expo-
nentially stable ﬁlters for source localization and navigation aided by
direction measurements. Systems & Control Letters, 62(11):1065 –
1072, 2013.
[7] G. Antonelli, F. Arrichiello, S. Chiaverini, and G. Sukhatme. Observ-
ability analysis of relative localization for auvs based on ranging and
depth measurements. In Robotics and Automation (ICRA), 2010 IEEE
International Conference on, pages 4276–4281, May 2010.
[8] M. Morgado, P. Oliveira, C. Silvestre, and J.F. Vasconcelos. Usbl/ins
tightly-coupled integration technique for underwater vehicles. In
Information Fusion, 2006 9th International Conference on, pages 1–8,
2006.
[9] P. Oliveira, C. Silvestre, M. Morgado, K. Erzini, L. Bentes, A. Afonso,
F. Hazin, and B. Block. Preliminary results from project mast/am-
advanced tracking and telemetry methodologies to study marine ani-
mals. In OCEANS, 2011 IEEE - Spain, pages 1–6, 2011.
[10] P. Batista, C. Silvestre, and P. Oliveira. On the observability of linear
motion quantities in navigation systems. Systems & Control Letters,
60(2):101 – 110, 2011.
2962
