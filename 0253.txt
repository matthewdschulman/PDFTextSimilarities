Hybrid Predictive Control for Aerial Robotic Physical Interaction
towards Inspection Operations
Georgios Darivianakis, Kostas Alexis, Michael Burri, and Roland Siegwart
AbstractÑThechallengeofaerialroboticphysicalinteraction
towards inspection of infrastructure facilities through contact
is the main motivation of this paper. A hybrid model predictive
control framework is proposed, based on which a typical
quadrotor vehicle becomes capable of stable physical interac-
tion, accurate trajectory tracking on environmental surfaces as
well as force control with only minor structural adaptations.
Convex optimization techniques enabled the explicit computa-
tion of such a controller which accounts for the dynamics in
freeÐßight and duringphysical interaction, ensures the stability
of the hybrid system as well as response optimality, while
respecting system constraints and imposed logical rules. This
controlframeworkisfurtherextendedtoincludeobstacleavoid-
ance capabilities. Extensive experimental studies that included
complex ÒaerialÐwritingÓ tasks, interaction with nonÐplanar
and textured surfaces and obstacle avoidance maneuvers, indi-
cate the efÞciencyof theapproach andthepotentialcapabilities
of such aerial robotic physically interacting operations.
I. INTRODUCTION
Miniature Aerial Vehicles (MAVs) have proven to be a
highly efÞcient class of systems with great potential on
inspection operations. Utilizing vision, LiDARs or other
sensing devices, MAVs are capable of executing complex
remote aerial inspection tasks. However, infrastructure in-
spection operations are not limited to remote sensing but
oftenrequirephysicalcontacttoo.Duetothisfactandfurther
motivations, several research groups [1Ð4] have focused on
addressing the problem of aerial physical interaction. This
work proposes a control framework that provides advanced
robotic physical interaction capabilities with only minor
structural adaptations of the vehicle.
As shown in Figure 1, a typical quadrotor vehicle is
utilized with the only mechanical adaptation being the inte-
gration of a simple rigid docking mechanism. The dynamics
of the aerial robot are modeled during freeÐßight as well as
during physical interaction and a global model is assembled
employingthetheoryofhybridautomataandtheirequivalent
translation to piecewise afÞne (PWA) systems. Based on the
great breakthroughs in the Þeld of convex optimization, the
derived hybrid model becomes the basis for the computation
of a powerful explicit hybrid model predictive control law
(hybrid MPC). This controller provides a set of key features
that are of critical importance for the Þeld of aerial contactÐ
based inspection and physical interaction in general. Most
This work was supported by the European project ICARUS funded by
the European Commision under the 7th Framework Programm.
All authors are with the Autonomous Systems Lab at ETH
Zurich, Tannenstrasse 3, 8092 Zurich, Switzerland. email: konstanti-
nos.alexis@mavt.ethz.ch
importantly, it ensures stable transitioning between freeÐ
ßight and physical contact and achieves response optimality
whilesatisfying the modeledsystem constraintsand imposed
missionÐrelated logical rules. Consequently, accurate inÐ
contact trajectory tracking is achieved along with force
control capabilities. Furthermore, this control framework is
extended to include means of obstacle avoidance. Being
explicitly computed, it allows for fast realÐtime execution.
Fig. 1. Aerial robotic physical interaction experiments.
The properties of the controlled system were evaluated
experimentally. Mounting a marker on the vehicle, a wide
set of ÒaerialÐwritingÓ operations were conducted in order
to evaluate the capabilities of aerial physical interaction and
inspection through contact. Such an ÒaerialÐwritingÓ task
may be considered similar to that of nonÐdestructive testing
(NDT) of infrastructureusing ultrasound probes. Despite the
constraintsimposedfromtheenvironmentandtheunderactu-
ated nature of the vehicle dynamics, sufÞciently accurate inÐ
contact trajectory tracking and force control was achieved.
Moreover, the capacity for achieving smooth approaching
and docking maneuvers even subject to temporal faults of
the position localization subsystem was evaluated. Finally,
the capabilities of obstacle avoidance are presented.
This paper is structured as follows. In Section II, the
hybrid model of the system dynamics is presented, followed
by the developmentof the hybridmodel predictivecontroller
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 53
in Section III. Extended experimental studies are presented
in Section IV, while conclusions are drawn in Section V.
II. HYBRID MODELING
The utilized ÒASLquadÓ is a quadrotor aerial robot that
adopts an inÐhouse airframe development,the electronic and
actuation components of an AscTec Hummingbird and a
modularsoftwareframework.Theairframehasanarmlength
l
a
=0.3m and A docking mechanism has been mounted on
its front and back side to ensure a safe physical interaction.
Suchamechanismcorrespondstotheonlyrequiredstructural
modiÞcation to any multirotor, so that similar aerial physical
interactiontasksbecomepossible.Onthefrontside,amarker
is mounted so that writing tasks are executed and visually
veriÞed. The overall mass is m=0.65kg.
A. Attitude Dynamics IdentiÞcation
An attitude controller was already implemented for this
vehicle. The choice of not designing a specialized attitude
controller was motivated by the fact that nowadays, a huge
market of multirotors and other unmanned rotorcrafts exists
with such a lowÐlevel controller already integrated. As long
asphysicalinteractiontaskscanbeexecutedsafelyandaccu-
rately by only adapting the highÐlevel controller, the choise
of redesigning the attitude loop was considered unjustiÞed.
However, a model of the closedÐloop attitude dynamics had
to be derived. Using greyÐbox frequency domain methods,
second order models of the roll, pitch and yaw dynamics
are computed. The employed greyÐbox structures take the
following form:

ú
?
¬
?

=

0 1
?b
ú
?,?
?b
ú
?,
ú
?

?
ú
?

+

0
c
ú
?,?
r

?
r
(1)
where ? refers to each one of the roll, pitch, yaw angles
?,?,? and ?
r
to their reference signals.
B. Hybrid Physical Interaction Dynamics
In order to developan aerial robotcapableof active physi-
calinteractionwithitsenvironment,amodelingmethodology
that capturesthesystem dynamicsduringall the modesof its
operation has to be employed. Since the collision dynamics
are expressed in time scales that are orders of magnitude
smaller than those of the vehicle motion dynamics, the sys-
temisconsideredtochangemodeinstantaneously.Therefore,
the powerful theoretical tools of hybrid systems are utilized
to develop a global model of such an aerial robot during
freeÐßight as well as physical interaction.
Extending the approaches presented in [2,3], a hybrid au-
tomaton that captures the behavior of the system in all of its
modesas well as theeventmechanismthat triggersthe mode
transitionsis derived and becomesthe basis for modelÐbased
control synthesis. The problem is decoupled in three loops,
namely, a) the forwardÐmotion longitudinal dynamics that
are constrained during physical interaction,b) the lateral and
c) the altitude dynamics which are both affected by friction
once contact is established. Correspondingly, three hybrid
automata are formulated. Figure 2 presents the structure of
each of these hybrid automata, its modes Q={FF,PI} and
event mechanism as well as the utilized coordinate frame.
Fig. 2. The structure of the freeÐßight and physical interaction hybrid
automaton and the employed coordinate frame.
Each of the three hybrid automata is formulated along
the lines of [5]. Either in freeÐßight or during physical
interaction, the inputs of each of the longitudinal,lateral and
altitude subsystems belongs to a bounded set u
?
?U
?
, ??
lon, lat, alt. Similarly, the states of each subsystem may be
constrained in a bounded setS
?
once contact is established.
Consequently, a Domain Map is deÞned for the continuous
states of each of the modes of every hybrid automaton:
D
?
(FF) : R
4
?U
?
(2)
D
?
(PI) : S
4
?
?U
?
A locally Lipschitz Flow Map f(x
?
,D
?
) acts on these
domain maps and describes the continuous evolution of the
states for every operative mode. Each of the ßow maps
consists of two components f(x
?
,D
?
(FF)), f(x
?
,D
?
(PI))
for the freeÐßight and physical interaction modes respec-
tively.ThefollowingstateÐspacerepresentationsdescribethe
evolution of the longitudinal dynamics:
?
?
?
f(x
lon
,D
lon
(FF)) : ú x
lon
=A
FF
lon
x
lon
+B
FF
lon
u
lon
f(x
lon
,D
lon
(PI)) : ú x
lon
=A
PI
lon
x
lon
+B
PI
lon
u
lon
+G
PI
lon
F
E
(3)
x
lon
=[x,ú x,?,
ú
?]
T
, y
lon
=[x,ú x,?,
ú
?,F
x
]
T
, u
lon
=?
r
where,
A
FF
lon
=
?
?
?
?
0 1 0 0
0 ??
FF
lon
?g 0
0 0 0 1
0 0 ?bú
?,?
?bú
?,
ú
?
?
?
?
?
, B
FF
lon
=
?
?
?
0
0
0
cú
?,?
r
?
?
?
A
PI
lon
=
?
?
?
0 1 0 0
0 0 0 0
0 0 0 1
0 0 ?bú
?,?
?bú
?,
ú
?
?
?
?, B
PI
lon
=
?
?
?
0
0
0
cú
?,?
r
?
?
?, G
PI
lon
=
?
?
?
0
0
0
l
E
?
?
?
and F
E
is the force exerted from the environment and under
rigidÐbodyassumptionsisequalandoppositetotheprojected
54
force on the xÐaxis (F
E
=?F
x
, F
x
=?Tsin?) during stable
contact. As shown, the ßow map during physical interaction
encodes the fact that the system is physically constrained
in the forward direction. The lever arm l
E
= l
a
sin(???),
(? = 0.14rad), is approximated for ? =?0.035rad which
correspondstoatypicaldockingangle,whilethelongitudinal
position x is deÞned as the distance of the vehicle CoG to
the closest surface of the environment minus the distance of
the CoG to the contact point and is considered negative in
freeÐßight and zero during contact (x?(?°,0]). The output
vector is set as y
lon
= [x,ú x,?,
ú
?,F
x
]
T
, F
x
Å?mg? in order
to enable output tracking with force control capabilities. The
lateral motion ßow map takes the following form:
?
?
?
f(x
lat
,D
lat
(FF)) : ú x
lat
=A
FF
lat
x
lat
+B
FF
lat
u
lat
f(x
lat
,D
lat
(PI)) : ú x
lat
=A
PI
lat
x
lat
+B
PI
lat
u
lat
(4)
x
lat
=[y,ú y,?,
ú
?]
T
, y
lat
=x
lat
, u
lat
=?
r
where,
A
FF
lat
=
?
?
?
?
0 1 0 0
0 ??
FF
lat
g 0
0 0 0 1
0 0 ?b ú
?,?
?b ú
?,
ú
?
?
?
?
?
, B
FF
lat
=
?
?
?
0
0
0
c ú
?,?
r
?
?
?
A
PI
lat
=
?
?
?
?
0 1 0 0
0 ??
PI
lat
g 0
0 0 0 1
0 0 ?b ú
?,?
?b ú
?,
ú
?
?
?
?
?
, B
PI
lat
=
?
?
?
0
0
0
c ú
?,?
r
?
?
?
As shown the ßow map during physical interaction accounts
for the viscous friction effects through the adapted damping
coefÞcient ?
PI
lat
. Similarly, for the altitude subsystem:
?
?
?
f(x
alt
,D
alt
(FF)) : ú x
alt
=A
FF
alt
x
alt
+B
FF
alt
u
alt
f(x
alt
,D
alt
(PI)) : ú x
alt
=A
PI
alt
x
alt
+B
PI
alt
u
alt
(5)
x
alt
=[z,ú z]
T
, y
alt
=x
alt
, u
alt
=T
r
where,
A
FF
alt
=

0 1
0 ??
FF
alt

, B
FF
alt
=

0
?
1
m

A
PI
alt
=

0 1
0 ??
PI
alt

, B
PI
alt
=

0
?
1
m

and T
r
is the reference thrust signal. Again the adapted ?
PI
alt
captures the effects of viscous friction.
The possible mode switchings are represented using the
Set of EdgesE as visualized in Figure 2. Since the vehicle
may encounter elastic collisions, a rebound loop is added
to the hybrid system{FF,FF}. The logic that governs the
mode switchings, is encoded in the Guard MapG (Table I)
which identiÞes the set G(q
i
,q
j
) to which the outputs of
the system have to belong so that transition from the mode
q
i
?Q to q
j
?Q may occur. By integrating tactile sensors
and combining their data with the state variables, a robust
contact detection strategy is engineered. For the lateral and
altitude hybrid automata, an auxiliary boolean state is added
and switches from 0 to 1 based on the aforementioned
longitudinal guard maps in order to trigger mode switching.
Value ?ú x
min
?0
+
is a close to zero tunable threshold.
TABLE I
GUARD MAPS MODE SWITCHING LOGIC
ú x s
G(FF,FF) ú x
+
ú x
?
<0,|ú x|³?ú x
min
0 or 1
G(FF,PI) ú x
+
ú x
?
²0,|ú x|²?ú x
min
s=1?x=0
G(PI,FF) |ú x|³ ú x
min
s=0?x<0
Finally, for completeness and simulation reasons, a Reset
Map R is formulated for each hybrid automaton and de-
scribes, for every edge ({FF,FF},{FF,PI},{PI,FF}), the
values to which the continuous states x
?
are set during a
mode transition. This reset map encodes the jump on the
attitude rate and velocity of the vehicle in case of elastic
collisions and follows the methodology presented in [6].
These hybrid automata represent a global model of the
ASLquad during freeÐßight and physical interaction. Their
implementation was achieved using the HYbrid System
DEscription Language (HYSDEL) 3.0 [7] which provides
a rapid prototyping framework integrated with MATLAB
r
and the Multiparametric Toolbox (MPT) 3.0 [8].
While hybrid automata provide an intuitive way for
modeling, piecewise afÞne systems are more powerful for
numerical control computation. Different hybrid systems
representationsarehowevertranslatablefromonetotheother
with equivalence, in the sense that the same input sequences
will lead to identical state trajectories. The equivalent PWA
system takes the following form in discrete time:
x
?
(k+1) = A
?
i(k)
x
?
(k)+B
?
i(k)
u
?
(k)+f
?
i(k)
y
?
(k) = C
?
i(k)
x
?
(k)+D
?
i(k)
u
?
(k)
(6)
where i(k) indicates which hybrid mode (PWA model) is
active and the switching rule is now represented in a matrix
inequalities form based on the states and inputs vectors:
H
?
i(k)
x
?
(k)+J
?
i(k)
u
?
(k)²K
?
i(k)
÷
H
?
i(k)
x
?
(k)+
÷
J
?
i(k)
u
?
(k) <
÷
K
?
i(k)
(7)
where the matrices A
?
i(k)
, B
?
i(k)
, f
?
i(k)
, C
?
i(k)
, D
?
i(k)
, H
?
i(k)
,
J
?
i(k)
, K
?
i(k)
,
÷
H
?
i(k)
,
÷
J
?
i(k)
,
÷
K
?
i(k)
are constant and have suitable
dimensions, i(k) = 1,...,?, where ? is the number of the
PWA systems required to express the hybrid system (? =2).
III. HYBRID MODEL PREDICTIVE CONTROL
The proposed control law exceeds the classical synthesis
of MPCÐbased autopilots [9Ð12] and provides a set of key
features for aerial robotic physical interaction operations.
Utilizing the concept of receding horizon control over the
hybrid model of the vehicle, it ensures its global stability as
well as responseoptimality,while it also makes use of recent
advancements in the Þeld of convex optimization to provide
a ßexibleframeworkthatcan incorporateartiÞcially imposed
missionÐrelated logical rules together with the system state
and input constraints. Finally, obstacle avoidance capabil-
ities are incorporated in the same framework. MPT and
YALMIP [13] are the main computational tools that enabled
the design and explicit computation of such a controller.
55
A. State and Input Constraints
The following, state and input constraints are imposed in
the optimization process in order to enforce the vehicleÕs
operation in a safe subset of its ßight envelope:

I
3?3
0
3?3
0
3?3
?I
3?3

?
?
?
?
?
?
?
ú x
?
?
r
ú x
?
?
r
?
?
?
?
?
?
?
²
?
?
?
?
?
?
?
1.5m/s
¹/4rad
¹/4rad
1.5m/s
¹/4rad
¹/4rad
?
?
?
?
?
?
?
(8)

I
3?3
0
3?3
0
3?3
?I
3?3

?
?
?
?
?
?
?
ú y
?
?
r
ú y
?
?
r
?
?
?
?
?
?
?
²
?
?
?
?
?
?
?
1.5m/s
¹/4rad
¹/4rad
1.5m/s
¹/4rad
¹/4rad
?
?
?
?
?
?
?
(9)

I
2?2
0
2?2
0
2?2
?I
2?2

?
?
?
ú z
T
r
ú z
T
r
?
?
? ²
?
?
?
1.5m/s
5N
1.5m/s
5N
?
?
? (10)
B. Imposed Logical Rules
Consequently, a second class of constraints that encode
missionÐrelated logical rules are also imposed. Although
not captured from simple rigid body modeling, the vehicle
has to apply at least a minimum force in order to retain
contact due to the aerodynamic turbulence that occasionally
creates repelling forces. Correspondingly,a safety constraint
that enforces a minimum force threshold is imposed during
physical interaction. Moreover, to prevent the vehicle from
tipping over the wall due to the external moments, a tight
hard constraint on the maximum pitch angle is imposed
during contact. These logical rules take the following form:
IF contact THEN F
x
³0.2N (11)
IF contact THEN ?²¹/12rad (12)
YALMIP enables the incorporation of these nonÐconvex
logical rules in the optimization.
C. Control Computation
Provided the PWA representations of the hybrid systems
as in (6),(7) as well as the constraints (8),(9),(10) and the
logical rules (11), (12) three hybrid predictive controllers
are computed in a multiparametric fashion [8,14]. Using
a quadratic norm as a metric of optimality and adding
terminal set constraints, the hybrid predictive controller, for
a prediction horizon N, consists of computing the optimal
controlsequenceU
N
?
= [u
?
(0),...,u
?
(N?1)]thatminimizes
the following objective:
J(x
?,0
,U
N
?
) = min
U
N
?
{x
T
?,N
P
M?M
x
?,N
+ (13)
N?1
·
k=0
x
T
?,k
Q
M?M
x
?,k
+u
T
?,k
R
L?L
u
?,k
}
s.t. equation (6),(7),[(8)/(9)/(10)], [(11),(12)]
??lon
x
?,N
?T
set
where P
M?M
0, Q
M?M
0, R
L?L
0 are the weighting
matrices of the terminal state, of the states and the manipu-
lated variables respectively and T
set
is the terminal set which
is speciÞed as the LQR terminal set in order to guarantee
stability properties [14]. For each subsystem, such a hybrid
MPC is computed based on state feedback. However, for
the purposes of varying force reference, the aforementioned
objective is reformulated in output feedback form.
D. Obstacle Avoidance
The proposed control framework may also be extended
to provide obstacle avoidance capabilities by coupling the
three hybrid automata, modifying the objective function and
adding polyhedricconstraints. In an infrastructureinspection
scenario it is very likely that some knowledge of the main
structure is available a priori, which then allows modeling
of most of the obstacles in the workspace. Let P
w
be a
polyhedron that describes the total workspace of the robot,
P
1
o
,P
2
o
,...,P
p
o
polyhedra that enclose the known obstacles
and also provide additional thresholds to account for the
vehicledimensionsandsomefurthersafetyboundsthatallow
limited penetration. The ÒsafeÓ robot workspace is deÞned
as the Pontryagin differenceP
s
=P
w
\{P
1
o
,P
2
o
,...,P
p
o
}.
In order to enforce operation within P
s
, the following
adaptation in the optimization problem is required:
min
U
N
?
J(x
?,0
,U
N
?
) (14)
s.t. [x, y, z]?P
s
equation (6),(7),(8),(9),(10),(11),(12)
where ? indicates that the coupled 3D hybrid automaton
is used. Despite this problem is of increased complexity,
once an explicit solution is computed, its realÐtime imple-
mentation is very efÞcient. It is noted that this obstacle
avoidance strategy is not proposed in order to substitute the
needforpropertrajectorygenerationbutratherasalastresort
mechanismthatensuresthesystemsafetyatthecontrollevel.
E. Explicit Implementation
One additional important property of the proposed control
strategy is its explicit character. This is a result of the fact
that the control action takes a piecewise afÞne form [15]:
u
?
(k) = F
r
?
x
?
(k)+G
r
?
, if x
?
(k)??
r
?
(15)
where?
i
?
,??lon,lat,alt or?, r=1,...,N
r
?
are the regions
of the receding horizon control strategy. The rÐth control
law is valid if the state vector x
?
(k) is contained in a
convex polyhedral region ?
r
?
={x
?
(k) |H
r
?
x
?
(k)² K
r
?
}
computed and described in hÐrepresentation during the ex-
plicitcontrollerderivation[16].Thecontrollerisequivalently
translated to a mapping between feedback gains and afÞne
termsF
r
?
,G
r
?
and correspondingpolyhedricregions?
r
?
. This
explicit controller is equivalent to its online counterpart in
the sense that for identical state trajectories, both produce
the same control actions, and therefore share the same
stabilizing and optimality properties. This fact enables the
seamless realÐtime implementation of this controller. In the
framework of this work, the real time code is described in
Algorithm 1 and corresponds to an extension of the table
traversal algorithm [16] that also supports multiple inputs.
Finally, in order to compensate for the possibly rotated
yaw angle (?), the derived ?
r
,?
r
reference signals are
rotated accordingly.
56
Algorithm 1: Extended Sequential Table Traversal
Data: Regions: H
r
, K
r
Regions feedback laws: F
r
, G
r
, Regions Cost
Matrices: Q
r
,f
r
,g
r
, Number of regions: N
r
, Input Penalization
Matrix: R
p
, State : x(k),Previous Optimal Control input: u
prev
Result: Explicit Hybrid MPC control input u
?
0
(x(k))
J
min
?+°
u
opt
?u
prev
for r =1,...,N
r
do
if H
r
x
k
²K
r
then
J
r
?x(k)
T
Q
r
x(k)+ f
T
r
x(k)+g
r
; /
*
region cost
*
/
u
r
?F
r
x(k)+G
r
; /
*
region control input
*
/
if J
r
<J
min
then
J
min
?J
r
;
u
opt
?u
r
;
else if J
r
=J
min
then
if u
T
r
R
p
u
r
²u
T
opt
R
p
u
opt
then
J
min
?J
r
;
u
opt
?u
r
;
end
end
end
end
u
?
0
(x(k))=u
opt
;
IV. EXPERIMENTAL EVALUATION
The efÞciency of the proposed control framework was
experimentally evaluated.Mounting a marker on the vehicle,
a wide set of ÒaerialÐwritingÓ tasks were performed. Such
tasks assess the capabilities of aerial contactÐbased inspec-
tion at the control level. Measurements of the thickness of
powerplantboilerpipesusingultrasoundprobescorresponds
to an indicative example of such applications. Three sets
of experiments were conducted, namely a) complex ÒaerialÐ
writingÓ, b) sliding on a real segment of boiler pipes also
subject to temporal sensor faults and c) obstacle avoidance
and docking. In all the conducted experiments position
feedback was provided by a Vicon motion capture system,
while the onboard inertial measurement unit provided the
attitude estimates. The sampling time was set to T
s
=0.02s
and N =10. The x reference is always set 5cm behind the
environmental surface.
Figure 3 depicts an inspection maneuver that ÒscansÓ a
prespeciÞed area on a wall with the reference precomputed
ofßine. This, essentially imitates a mission of inspecting
the walls of industrial facilities, in order to detect potential
damages or developing hazards.
Fig. 3. Aerial writing experiment, executing a wall inspection through
contact path. A recording of this response is available at the video Þle.
Subsequently,thevehiclewascommandedtowriteaword,
and speciÞcally to writeÒASLÓ (acronymof theAutonomous
Systems Lab at ETH Zurich). The derived results, shown in
Figure 4, present high accuracy compared to the challenging
nature of the reference path, the underactuated dynamics of
the vehicle and its limited force generation mechanism.
Fig. 4. Aerial writing of the Autonomous Systems Lab acronym (ASL).
A recording of this response is available at the video Þle.
The next testÐcase evaluates the physical interaction capa-
bilitieson nonÐplanartexturedsurfaces,asit canbeexpected
in industrialinspection operations.As shown in Figure5, the
robot is commanded to dock and ÒwriteÓ a vertical line on
a segment of a real power plant boiler pipeÐwall.
Fig. 5. Vertical sliding on a segment of a real boiler pipeÐwall. A video
recording of this response is available at the supplementary video Þle.
During real inspection operations, it may be expected that
the position localization subsystem may encounter temporal
faults. Such a situation becomes even more challenging if
it happens during a docking maneuver. Towards providing a
last resort safety mechanism, Figure 6 depicts that a smooth
docking maneuver can still be achieved as long as a model
57
of sufÞcientÞdelity is available.As shown,for the last 0.4m,
the position feedback was based only on forward simulation
of the identiÞed dynamics, while once contact is detected
the ground truth data were again provided to the system. As
illustrated, in such an experiment, the maximum errors are
small and the maneuver remains practically unaffected.
Fig. 6. Docking maneuver in case of position information loss by relying
only on forward simulation of the identiÞed models.
Finally, the obstacle avoidance capabilities were evaluated
and the results are depicted in Figure 7. With prior knowl-
edge of the obstacle position and dimensions, a bounding
polyhedron P
o
, is deÞned and the controller described in
Subsection III-D is applied. As demonstrated, a last resort
obstacle avoidance mechanism is achieved and ensures the
safety of the system.
V. CONCLUSIONS AND FUTURE WORK
A hybrid model predictive control framework that handles
the problem of aerial physical interaction and inspection
through contact with only minor structural adaptations of
the aerial vehicle is proposed. Employing hybrid systems
approaches, a global model of the system dynamics in freeÐ
ßight as well as during physical interaction is derived and
becomes the basis for modelÐbased control. The proposed
controllerensuresthestabilityofthesystemandachievesop-
timal responses while satisfying constraints, imposed logical
rules and avoiding obstacles. The efÞciency of the proposed
method was evaluted using extensive experimental studies
that included ÒaerialÐwritingÓtasks, nonÐplanarand textured
surfaces inspection and obstacle avoidance.
REFERENCES
[1] D. Mellinger, M. Shomin, N. Michael, and V. Kumar, ÒCooperative
grasping and transport using multiple quadrotors,Ó in Distributed Au-
tonomous Robotic Systems, ser. Springer Tracts in Advanced Robotics.
Springer Berlin Heidelberg, 2013, vol. 83, pp. 545Ð558.
[2] L. Marconi, R. Naldi, and L. Gentili, ÒModelling and control of a
ßying robot interacting with the environment,Ó Automatica, vol. 47,
no. 12, pp. 2571 Ð 2583, 2011.
[3] K. Alexis, C. Huerzeler, and R. Siegwart, ÒHybrid modeling and con-
trol of a coaxial unmanned rotorcraft interacting with its environment
through contact,Ó in 2013 International Conference on Robotics and
Automation (ICRA), Karlsruhe, Germany, 2013, pp. 5397Ð5404.
[4] C. Papachristos and A. Tzes, ÒLarge object pushing via a direct
longitudinally-actuated unmanned tri-tiltrotor,Ó in Mediterranean Con-
ference on Control Automation (MED), 2013, pp. 173 Ð178.
[5] R. Goebel, R.G. Sanfelice, and A.R. Teel, Hybrid Dynamical Systems:
Modeling, Stability, and Robustness. 41 William Street, Princeton,
NJ, USA: Princeton University Press, 2012.
Fig. 7. Experiment presenting the obstacle avoidance capabilities of the
proposed modelpredictive controller. Theguarding (transparent) polyhedron
P
o
is larger than the real obstacle to account for the quadrotor size and
provide safety thresholds. As shown rapid safety action takes place once
short intervention to the guarding polyhedron is detected. A video recording
of this response is available at the supplementary video Þle.
[6] C. Huerzeler, ÒModeling and design of unmanned rotorcraft systems
for contact based inspection,Ó Ph.D. dissertation, Swiss Federal Insti-
tute of Technology Zurich, 2013.
[7] G. B. Fabio Dabilo Torrisi, Alberto Bemporad, HYSDEL - HYbrid
System DEscription Language, The Hybrid Systems Group, IFAÐ
ETHZ, http://control.ee.ethz.ch/
÷
hybrid/hysdel/.
[8] M. Herceg, M. Kvasnica, C. Jones, and M. Morari, ÒMulti-Parametric
Toolbox 3.0,Ó in Proc. of the European Control Conference, Z¬ urich,
Switzerland, July 17Ð19 2013, pp. 502Ð510.
[9] K. Alexis, G. Nikolakopoulos, and A. Tzes, ÒConstrained-control
of a quadrotor helicopter for trajectory tracking under wind-gust
disturbances,Ó in MELECON 2010-2010 15th IEEE Mediterranean
Electrotechnical Conference. IEEE, 2010, pp. 1411Ð1416.
[10] K. Alexis, G. Nikolakopoulos and A. Tzes, ÒModel predictive quadro-
tor control: attitude, altitude and position experimental studies,Ó Con-
trol Theory & Applications, IET, vol. 6, no. 12, pp. 1812Ð1827, 2012.
[11] K. Alexis and G. Nikolakopoulos and A. Tzes, ÒSwitching model
predictive attitude control for a quadrotor helicopter subject to atmo-
spheric disturbances,Ó Control Engineering Practice, 2011.
[12] C. Papachristos, K. Alexis, and A. Tzes, ÒModel predictive hoveringÐ
translation control of an unmanned triÐtiltrotor,Ó in 2013 International
Conference on Robotics and Automation, Karlsruhe, Germany, 2013,
pp. 5405Ð5412.
[13] J. Loefberg, ÒYalmip : A toolbox for modeling and optimization
in MATLAB,Ó in Proceedings of the CACSD Conference, Taipei,
Taiwan, 2004. [Online]. Available: http://users.isy.liu.se/johanl/yalmip
[14] M. Baotic, ÒOptimal control of piecewise afÞne systems,Ó Ph.D.
dissertation, Swiss Federal Institute of Technology Zurich, 2005.
[15] M. Kvasnica, RealÐTime Model Predictive Control via MultiÐ
Parametric Programming: Theory and Tools. VDM Verlag, 2009.
[16] M. Kvasnica, I. Rauova, and M. Fikar, ÒAutomatic code generation for
real-time implementation of model predictive control,Ó in Computer-
Aided Control System Design (CACSD), 2010 IEEE International
Symposium on, sept. 2010, pp. 993 Ð998.
58
