  
? 
Abstract— A torque estimation method with adaptive 
robustness and optimality adjustment according to the load for 
modular and reconfigurable robot joint with harmonic drive 
transmission is proposed, on the basis of harmonic drive 
compliance model and redundant adaptive robust extended 
Kalman filter (RAREKF). The proposed approach can adapt 
torque estimation filtering optimality and robustness to the load 
variations by self-tuning the filtering gain and self-switching the 
filtering modes between optimal and robust. The redundant 
factor of RAREKF is designed as a function of the load to 
provide desirable tolerant capability to the modeling error and 
load-dependent filtering mode switching. The proposed joint 
torque estimation method has been experimentally studied in 
comparison with a commercial sensor, and the results have 
demonstrated the effectiveness of the proposed torque 
estimation technique.  
I. INTRODUCTION 
Harmonic drives, invented in the 1950s [1], are widely 
used in robotic systems, due to their desirable features of 
near-zero backlash, compactness, light weight, high torque 
capacity, high gear ratio and coaxial assembly. These 
distinctive characteristics of harmonic drives vindicate their 
widespread applications, especially in electrically-driven 
robot manipulators. Joint torque feedback (JTF) has been 
widely recognized to improve the performance of robot 
control in the robotics community [2], [3]. The JTF is 
generally used in motion control of robot manipulators to 
suppress the effect of load torques [4]. In addition, joint torque 
sensors can considerably ease the necessity to model the link 
dynamics. JTF can be used in the dynamic control of robots 
without the need of computing the robot inverse dynamics. In 
addition, joint torque sensing is necessary for collision 
detection and reaction. 
Measurement or estimation of the torque transmitted by 
the harmonic drive transmission is required for the 
implementation of JTF control methods. Conventionally, to 
implement such control strategies, the robot is equipped with 
joint torque sensors or a multi-axis force/torque (F/T) sensor. 
When using F/T sensor at the robot wrist, the estimation of 
joint torques requires additional calculations, and the results 
 
This work is supported in part by the Natural Sciences and Engineering 
Research Council (NSERC) of Canada and in part by the Canada Research 
Chair program. The first author is also supported by NSFC under Grant No. 
60903067 and Beijing Natural Science Foundation under Grant No. 
4122049. 
The authors are with the Department of Aerospace Engineering, Ryerson 
University, 350 Victoria Street, Toronto, Ontario, Canada M5B 2K3. Z. Shi 
is a Visiting Professor from the School of Computer and Communication 
Engineering, University of Science and Technology Beijing, 100083, China. 
G. Liu is the corresponding author. Email:gjliu@ryerson.ca. 
may be affected by computation delays and model errors [5]. 
There are several techniques of direct joint torque sensing, 
including joint torque sensors based on elastic elements that 
are placed in the output transmission line of each joint of the 
robot [6], [7].  
In [8], a linear encoder is used to measure the torsional 
deformation of the additional elastic body of a joint torque 
sensor. As measurement accuracy is in inverse proportion to 
sensor stiffness, low sensor stiffness is desirable in order to 
achieve high measurement resolution, which leads to 
complicated joint dynamics. Another joint torque sensing 
technique is based on the method proposed by Hashimoto et al. 
[9]. Joint torque sensing is achieved by mounting strain gages 
directly on the harmonic drive, which is usually referred to as 
built-in torque sensing for harmonic drives [9], [10], [11]. The 
torsional compliance of harmonic drives lends itself to torque 
sensing, but the measurement signals contain substantial 
ripples. It is difficult to extract the applied torque from the 
signals with ripples [12].  
Torque estimation using harmonic drive compliance model 
provides an effective way of torque estimation for robot joints 
with harmonic drive and accurate link-side position 
measurement [13]. The joint torque estimation technique uses 
measurements of both the link-side and motor shaft positions 
along with a proposed harmonic derive model to realize stiff 
and sensitive torque estimation, obtaining joint torque with 
minimal mechanical modifications. However, a low-pass 
filter is used in [13] to filter the output of the harmonic drive 
model, which presents a simple and convenient way to resist 
high frequency noises, but the influence of the load variation 
is not taken into consideration and the estimation response 
speed is limited by the filter bandwidth.  
In [10], to minimize sensing inaccuracy, four rosette strain 
gauges are used with accurate positioning on the flexspline. 
To cancel the torque ripples, the oscillation observed on the 
measured torque and caused mainly by gear teeth meshing, 
standard Kalman filter estimation is used. With on-line 
implementation of a Kalman filter, it has been demonstrated 
with experiments that this method is a fast and accurate way to 
filter torque ripples and torque due to misalignment.  
Kalman optimal filtering technique is commonly used in 
torque estimation algorithms. However, the filter gain is 
optimal and cannot be self-adjusted in the standard Kalman 
filter algorithm, and the external environment is only reflected 
by the pre-set measurement noise variance, which makes it 
difficult to adapt to changes in the actual external disturbance 
and respond timely. Disturbances are taken into account in 
real time according to the actual measurement in the robust 
filtering algorithm [14], [15], where the online estimation of 
Torque Estimation of Robot Joint with Harmonic Drive 
Transmission Using a Redundant Adaptive Robust Extended 
Kalman Filter 
Zhiguo Shi and Guangjun Liu, Senior Member, IEEE 
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 6382
  
particularly the issues of optimality and robustness, the 
difference between the estimated torque and torque sensor. 
Three different filtering algorithms have been implemented 
for comparison.  
The harmonic drive of the test joint is driven by a brushed 
DC motor from Maxon, which is capable of delivering up to 
0.191 Nm. The Maxon DC motor is coupled with a harmonic 
drive system model SHD-17-1002SH, with gear ratio of 
100:1, and rated torque of 16 Nm from harmonic drive AG. 
The DC motor is instrumented with an optical incremental 
encoder with 4096 counts/rev to measure the rotor angular 
displacement.  
The efficiency of the proposed torque estimation method 
is verified by comparing the estimated joint torque to the 
torque measurement from the ATI F/T sensor mounted on the 
output of the test joint.  
A.  Experiment on the Test Joint 
The test joint setup is as shown in Fig. 4, which integrates 
a DC motor with incremental encoder, harmonic drive, 
link-side absolute encoder and an ATI F/T sensor. The 
correctness of the modeling part and the filtering results are 
verified with this experimental setup. 
 
 
Figure 4.  Joint with torque sensor. 
The test joint is rotated 180
o
 in 80 seconds. Without 
additional load, the working mode of the filtering algorithm is 
in optimal to achieve more accurate estimation result. The 
estimated torque is compared to the torque sensor output in 
Fig. 5. 
15 20 25 30 35 40 45 50 55 60 65
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Time (s)
Link-side torque (Nm)
 
 
Torque Sensor
Estimated Torque
Difference
 
Figure 5.  Experiment results of test joint without link-joint. 
The curve of torque sensor in Fig. 5 is quickly followed by 
the estimated torque after a transient period. The difference 
between the estimated torque and sensor output is lower than 
0.1 Nm. 
B.  Experiment with Link-joint Without External Force 
In a general working state, the test joint is deployed with a 
link-joint, as normally for a robotic arm. A complete set of 
experiment system is set up as shown in Fig. 6 to verify the 
proposed torque estimation method.  
 
 
Figure 6.  The experiment setup with link-joint. 
In this experiment, the test joint is controlled to rotate with 
a desired trajectory: the initial position of the link-joint is in 
the vertical position, then the joint slowly rotates to the 
horizontal position in the clockwise direction. The load of the 
test joint will change gradually with its motion. 
When the link-joint moves to the designated location, it 
will stop and maintain the location. In this process, the load of 
the test joint is gradually increasing, and reaches the 
maximum value when it stops. The difference between the 
estimated torque and torque sensor is presented in Fig. 7. 
0 10 20 30 40 50 60 70 80
-2
0
2
4
6
8
10
Time (s)
Link-side torque (Nm)
 
 
Torque Sensor
Estimated Torque
Difference
 
Figure 7.  Experiment results with link-joint but no external force. 
It can be seen that the RAREKF is in optimal mode at the 
beginning. The load increases with the link-joint rotation, and 
the working mode of RAREKF is gradually transiting to the 
robust mode. When the link-joint stops at the designated 
location, the torque is fixed. The difference between 
estimated torque and estimated torque is relatively high in the 
stage of RAREKF switching from optimality to robustness, 
but the error of the estimated torque is acceptable overall.  
The working mode switching between optimal and robust 
according to the load variation is necessary. In the optimal 
mode, the torque estimation can effectively suppress the 
noises, but responds slowly to the load variation. In the robust 
6386
  
mode, the torque estimation can respond quickly to the load 
variation, with reduced effectiveness in noise suppression.  
 C.  Experiment with External Force 
Sudden external force is added to the previous experiment. 
The moving links and joints attached to the base joint 
introduce only gradual load change. To introduce fast torque 
changes, external torque is applied manually in both 
directions. The response of the proposed torque estimation 
method to sudden changes was verified by adding external 
force. The experimental procedure is almost the same with 
the previous experiment. The difference between the 
estimated torque and torque sensor is presented in Fig. 8. The 
details of the experimental result with sudden external force 
disturbance, as indicated in Fig. 8, are shown in Fig. 9. 
0 10 20 30 40 50 60 70 80
-1
0
1
2
3
4
5
6
7
8
9
Time (s)
Link-side torque (Nm)
 
 
Torque Sensor
Estimated Torque
Difference
 
Figure 8.  Experiment results of link-joint with external force. 
44 44.5 45 45.5 46 46.5 47
5
5.2
5.4
5.6
5.8
6
6.2
6.4
6.6
6.8
7
Time (s)
Link-side torque (Nm)
 
 
Torque Sensor
Estimated Torque
 
Figure 9.  Zoomed view of the portion indicated in Fig. 8. 
VI. CONCLUSION 
The proposed torque estimation method provides 
desirable tolerant capability to the modeling error and 
dynamic balance of optimality and robustness according to 
the load variation. The effectiveness of the redundant 
adaptive robust extended Kalman filter for joint torque 
estimation has been demonstrated with experimental results.  
In practice, the change rate of the filtering gain can be 
manually pre-set to get the better torque estimation 
performance and better noise resistance and external force 
response, according to the requirements of the systems. The 
future work will focus on the estimation optimization, as well 
as compensating the effect of the frictions.  
ACKNOWLEDGMENT 
The authors would like to thank Dr. Saleh Ahmad for the 
help on the experimental setup and Dr. Yuankai Li for 
insightful discussions on the RAREKF algorithm. 
REFERENCES 
[1] C. W. Musser, “Strain wave gearing,” Patent US 2 906 143, [Online]. 
Available: http://www.google.com/patents?vid=2906143. 1955. 
[2] F. Aghili, M. Buehler, and J. M. Hollerbach, “Motion control systems 
with h-infinity positive joint torque feedback,” IEEE Trans. on Control 
System Technology, vol. 9, no. 5, pp. 685–695, 2001. 
[3] G. Liu, S. Abdul, and A. Goldenberg, “Distributed modular and 
reconfigurable robot control with torque sensing,” in Proc. IEEE Int. 
Conf. on Mechatronics and Automation,  pp. 384–389. 2006. 
[4] F. Aghili, J. Hollerbach, and M. Buehler, “A modular and 
high-precision motion control system with an integrated motor,” 
IEEE/ASME Trans. on Mechatronics, vol. 12, no. 3, pp. 317–329, 
2007.  
[5] M. Randazzo, M. Fumagalli, F. Nori, L. Natale, G. Metta, and G. 
Sandini, “A comparison between joint level torque sensing and 
proximal F/T sensor torque estimation: implementation on the icub,” in 
Proc. IEEE/RSJ Int. Conf. on Intelligent Robots and Systems, pp. 
4161–4167, 2011.  
[6] D. Vischer and O. Khatib, “Design and development of 
high-performance torque-controlled joints,” IEEE Trans. on Robotics 
and Automation vol. 11, no. 4, pp. 537–544, 1995.  
[7] D. Tsetserukou, R. Tadakuma, H. Kajimoto, and S. Tachi, “Optical 
torque sensors for implementation of local impedance control of the 
arm of humanoid robot,” In Proc. IEEE Int. Conf. on Robotics and 
Automation, pp. 1674–1679. 2006. 
[8] T. Kawakami, K. Ayusawa, H. Kaminaga, and Y. Nakamura, 
“High-fidelity joint drive system by torque feedback control using high 
precision linear encoder,” In Proc. IEEE Int. Conf. on Robotics and 
Automation, pp. 3904–3909, 2010.  
[9] M. Hashimoto, Y. Kiyosawa, and R. Paul, “A torque sensing technique 
for robots with harmonic drives,” IEEE Trans. on Robotics and 
Automation vol. 9, no. 1, pp. 108–116, 1993.  
[10] H. Taghirad and P. Belanger, “Torque ripple and misalignment torque 
compensation for the built-in torque sensor of harmonic drive systems,” 
IEEE Trans. on Instrumentation and Measurement. vol. 47, no. 1. pp. 
309-315, 1998.  
[11] I. Godler, M. Horiuchi, M. Hashimoto, and T. Ninomiya, “Accuracy 
improvement of built-in torque sensing for harmonic drives,” 
IEEE/ASME Trans. on Mechatronics. vol. 5, no. 4, pp. 360–366, 2000. 
[12] J. Sensinger and R. Weir, “Improved torque fidelity in harmonic drive 
sensors through the union of two existing strategies,” IEEE/ASME 
Trans. on Mechatronics. vol. 11, no. 4,  pp. 457–461, 2006.  
[13] H. Zhang, S. Ahmad, and G. Liu, “Torque estimation of robot joint with 
harmonic drive transmission,” In Proc. IEEE International Conference 
on Robotics and Automation, Karlsruhe, Germany, pp. 3019-3024, 
2013.  
[14] J. Seo, M.J. Yu, C.G. Park, and J.G. Lee, “An extended robust H∞ 
filter for nonlinear constrained uncertain systems,” IEEE Transactions 
on Signal Processing. vol. 54, no. 11. pp. 4471-4475, 2006. 
[15] K. Xiong, H. Zhang, and L. Liu, “Adaptive robust extended Kalman 
filter for nonlinear stochastic systems,” IET Control Theory and 
Applications, vol. 2, no. 3, pp. 248-250, 2008.  
[16] Y.K. Li, Z.L. Jing, and S.Q. Hu, “Redundant adaptive robust tracking 
of active satellite and error evaluation,” IET Control Theory and 
Application, vol. 4, no. 11, 2010. pp. 2539-2553.  
[17] Harmonic Drive Technologies. Ultra-flat component sets and 
gearheads. [Online]. http://www.harmonicdrive.net/ support/catalogs/. 
2012.  
[18] R. Knorad, G. Stefan, and Y. Engin, “Stochastic stability of the 
discrete-time extended Kalman filter,” IEEE Transactions on 
Automatic Control, vol. 44, no. 4, pp. 714-728, 1999.  
6387
