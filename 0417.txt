Worst Case Braking Trajectories for Robotic Motion Simulators
Andreas Labusch
 
, Tobias Bellmann
 
, Karan Sharma
à
, Johann Bals
 
AbstractÑ Motion simulators based on industrial robots can
produce high dynamic accelerations and velocities compared to
classical hydraulic hexapod systems. In case of emergency stops,
large and possibly harmful accelerations can occur. This paper
aims to provide an optimization procedure to generate worst
case trajectories in order to test for these harmful accelerations,
by maximizing the kinetic energy prior the emergency stop. The
dynamical and mechanical limits of the robot are considered
as constraints of the optimization criterion. An exemplary
worst case trajectory is simulated using a braking model and
the resulting Head Injury Criterion (HIC) is calculated and
compared with older tests, using non-optimized trajectories.
A signiÞcant higher, yet with the current robot dynamics not
harmful HIC value can be generated.
I. INTRODUCTION
Motion simulators based on serial kinematics have lately
come into focus of research [1], [2], [3] and commercial use
as ßight simulators
1
. The safety of the pilot is generally en-
sured by several certiÞed safety systems, as for instance low-
level surveillance through robot control, safety precautions in
path planning, limited joint angles preventing self-collisions
and hardware stops in case of a fatal structural failure.
Nevertheless, during operation of such a robotic motion
platform, software errors can occur, making an emergency
stop necessary, for example missing motion data due to
network errors or power failure [4]. Recently we investigated
the accelerations [5], [6] caused by such emergency stops
from high-speed robot trajectories using an anthropomorphic
test device (also called Òcrash test dummyÓ). We showed that
the resulting movements are harmless according to the Head
Injury Criterion (HIC) [7], [8] and Neck Injury Criterion
(NIC) [7].
Although we found the resulting accelerations being far
below the threshold for neck and head injuries, the tested
trajectories for evaluating the HIC have been selected by
maximizing only the velocities of axes working in the same
direction, e.g. Axis 2, 3 and 5 of the used robot (DLR
Robotic Motion Simulator, see Þgure 1), followed by trig-
gering the emergency stop when reaching the highest joint
velocities. Most studies concerning the safety of humans
in Human-Robot systems consider humans to be in the
immediate vicinity of the robotic systems. In the RMS, in
contrast, the pilot is part of the robot system.
In this paper we present a method to deduce a worst case
This work is supported by KUKA Roboter GmbH
 
Institute of System Dynamics and Control - German Aerospace Center
(DLR), 82234 Oberpfaffenhofen, Germany
à
Institute of Robotics and Mechatronics - German Aerospace Center
(DLR) , 82234 Oberpfaffenhofen, Germany
Contact: andreas.labusch@dlr.de
1
http://www.grenzebach.com/index.php/grenzebach/technologien/ßightsim
q
1
q
2
q
3
q
4
q
5
q
6
q
7
Fig. 1. The DLR Robotic Motion Simulator with its 7 axes q
1
,...,q
7
,
performing a whiplash trajectory using the axes 2, 3 and 5. This maneuver
has been investigated with a crash test dummy in [6] and is used as a hand-
selected reference trajectory for comparison with the optimized worst case
trajectory in this paper.
trajectory by optimizing the maximum kinetic energy of the
passengerÕs head, considering the mechanical and dynamical
constraints of the robot arm as well as the workspace needed
to accelerate the arm to the necessary joint velocities.
II. METHODS
A worst case braking trajectory (WCBT) is deÞned as
a robot motion, designed to increase the danger of the
pilot getting injured by emergency braking. To quantify the
danger for the pilot, we are using the HIC but it is also
possible to consider other kinds of criteria [7]. As per [9]
the HIC is deÞned as follows:
HIC(?t
max
)= max
?t

?t

1
?t

t
2
t
1
 ö adt

5/2

. (1)
The scaled acceleration of the head, with respect to g,
ö a=
a
/g, g= 9.81m/s
2
, is integrated from t
1
to t
2
, over the
time period ?t=t
2
?t
1
²t
max
. The acceleration of the head
a is the second derivative of the position and does not take
the gravity into account. The considered time frame t
max
is
15ms for HIC
15
or 36ms for HIC
36
. The start time t
1
is
varied around the peak to maximize the resulting value.
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 European Union 3297
This criterion is used e.g. for head injury analysis in car
crashes by EuroNCAP [10].
The NIC rather takes the spine into account. It can be
calculated by
NIC= 0.2áa
rel
+v
2
rel
(2)
where a
rel
is the relative acceleration between the Þrst spinal
vertebra and Þrst thoracic vertebra andv
rel
is the time integral
of a
rel
[11].
These two criteria show the important inßuence of the
duration and amount of acceleration. As done in other studies
[8] we want to increase the kinetic energy to get an intensive
and long braking acceleration. Because of the workspace
limitations of the robot and its inhomogeneous capabilities
of acceleration, the solution for optimal conÞgurations is
not obvious. In the literature review we undertook, we
found no comparable work considering worst case trajectory
generation for industrial robots.
A. Structure of the DLR Robotic Motion Simulator
The DLR Robotic Motion Simulator is an interactive mo-
tion simulator based on a six-axis industrial robot arm. The
used robot (The DLR Robotic Motion Simulator, based on
KUKA KR500-2 T
¬
UV , see Þgure 1) is certiÞed to transport
humans safely by mechanical and software limitations. At
the tool center point (TCP), a simulator cell is mounted
sitting the pilot. The setup inside the cell includes two stereo
projectors, exchangeable instruments, input devices like a
steering wheel or a side stick. Together with the motion
cues of the robot, they generate a virtual reality environment
providing the pilot with an immersive simulation experience
[4].
The robot is mounted on an additional linear axis increasing
the workspace and allowing redundancy for movements.
For the presented method we derive the rigid dynamic
equations of the used industrial robot arm. These can
be formulated through the Newton-Euler approach or via
Lagrange[12]: Let q be the joint angles of each joint, M the
mass matrix of the system and h

q, ú q

the vector including
Coriolis and frictional forces. Additionally, the robot has a
hydraulic counterbalance cylinder at the second axis, reduc-
ing the necessary motor torque. This unit is modeled and
included inh

q, ú q

. The vectorg

q

describes gravitational
effects. The required motor torques ? of each axis can be
calculated by
M

q

¬ q+h

q, ú q

+g

q

=? . (3)
These dynamic equations are modeled in Modelica
2
and
have been veriÞed for simulation purposes.
The conÞguration of the robot can be described by q and
ú q. Figure 1 shows the robot with its joints numbered from
1to 7.
2
Modelica and the Modelica Association, https://www.modelica.org/
B. Maximizing the Kinetic Energy
The HIC only takes translational accelerations into ac-
count. Maximizing the HIC means to optimize a trajectory
for a 7 DOF system including the critical transition when the
brakes are applied. Performing such a trajectory optimization
for every possible path in the workspace requires a vast
amount of computational time. Instead, we will maximize
the translational kinetic energy in a single conÞguration
with respect to necessary constraints which will be outlined.
The translational kinetic energy of the pilotÕs head can be
computed by:
E
kin,head
=
1
2
m
head
v
2
head
(4)
=
1
2
m
head
ú r
T
head
ú r
head
(5)
=
1
2
m
head
ú q
T
J
head
(q)
T
J
head
(q) ú q, (6)
where J
head
is the translational Jacobian matrix of the direct
kinematics f
dir,r
(q) from the position of the robot base to
the position of the head r
head
:
J
head
(q)=
¶ f
dir,r
(q)
¶q
, r
head
= f
dir,r
(q). (7)
To achieve maximum kinetic energy of the head, we gen-
erate an optimal trajectory that is followed by braking. The
conÞguration at the end of the trajectory, that is also the
beginning of the braking, is given by q
e
and ú q
e
.
Thus we deÞne the optimization criterion which reduces to
the norm of translational velocity of the head:
max
q
e
, ú q
e

ú q
e
T
J
T
head
(q
e
)J
head
(q
e
) ú q
e

, (8)
subject to the constrained joint angles q
min,?
, q
max,?
to
prevent a collision with the hardware stops,
q
min,?
²q
e
²q
max,?
, (9)
with
q
min,?
=q
min
+?

q
max
?q
min

, (10)
q
max,?
=q
max
??

q
max
?q
min

. (11)
Further constraints are given through the robot control re-
stricting the joint velocities and accelerations,
?? ú q
max
² ú q
e
²? ú q
max
(12)
?? ¬ q
max
² ¬ q
e
²? ¬ q
max
. (13)
The limits can be modiÞed with ?, ? and ? to simulate
different conÞguration settings and to leave a safety gap that
the braking does not end in any hardware stop:
0²?,?,? ² 1. (14)
Furthermore the torque?
e
of each motor has to remain inside
its limits,
??
max
²?
e
²?
max
. (15)
For a feasible solution to the optimization problem it
is additionally necessary that the end conÞguration can be
3298
reached. Therefore we are assuming joint-wise maximum
acceleration and calculating the starting position for each
joint. The time to reach the end velocity is
t
e
=
	
	
ú q
e
	
	
? ¬ q
max
(16)
thus the starting position q
s
is given by
q
s,i
=q
e,i
?
1
2
? sgn( ú q
e,i
) ¬ q
max,i
t
2
e,i
?i (17)
which leads to another constraint
q
min
²q
s
²q
max
. (18)
The starting positions of the joints are only limited by the
workspace of the robot and do not have a safety limit like
the end positions. For the starting velocities we are deÞning
ú q
s
= 0. (19)
C. Finding a Trajectory
To reduce the complexity of the optimization procedure,
we are only calculating end conÞgurations with maximum
kinetic energy. The trajectory to reach these conÞgurations
has to be reverse calculated from the optimized end position
prior to the emergency stop. FulÞlling the constraints of
maximum velocities, accelerations and the limits of the
joint angles for the whole trajectory are implicitly granted
due to the constraints (9) (12) (13). To ensure that the
motor torques are not exceeded during acceleration, they are
simulated using the rigid dynamics model (3). As each axis
has different maximum acceleration and velocity and thus,
a different start angle (17), the durations of the acceleration
phases vary between the axes. This leads to different starting
times t
s
for each joint:
t
s,i
=t
max
?t
e,i
?i (20)
with t
max
being the longest acceleration time of the slowest
axis:
t
max
= max(t
e,i
) ?i. (21)
Each joint accelerates with its maximum possible accelera-
tion from t
s,i
to t
max
. To ensure that the calculated trajectory
does not exceed the motor torques, the resulting motor
torques are simulated and compared to their limits. If the
motor torques violate their constraints during the trajectory,
the result of the optimization is discarded as unfeasible and
the constraints of the optimization criterion are reduced using
the parameter?. This extends the acceleration distance to the
optimized end position but reduces the motor torques.
D. Braking Model
To simulate the accelerations of the emergency stop, a
simple braking model of the axes has been implemented. The
KUKA robot control provides three different braking modes
[13]. ÒSTOP 2Ó does normal deceleration through motor
torques without brakes. In ÒSTOP 1Ó the drives decelerate
for one second and after that the brakes are closed
and the drives are detached. With ÒSTOP 0Ó the brakes
are immediately closed and drives become unpowered. To
determine the braking torques for simulation, former braking
tests and data sheet information are used to calculate the
applied torques of the brakes.
Each joint of the derived braking model consists of a drive,
a clutch and a brake. Figure 2 shows the implementation
of the power train to the rigid dynamics. While driving
the trajectory the clutch is closed and the brakes are left
open. With the brakes activated, the clutches are released
to decouple the drives from the power train. The inertia of
the motors are added to the joint inertia in our model. This
braking behavior corresponds to ÒSTOP 0Ó of the robot. The
Fig. 2. The Modelica model of the simpliÞed braking model. By coupling
clutch and braking models from the Modelica standard library with a
complete rigid dynamics model with friction and counterbalance unit, the
braking behavior of the robot is simulated and the inputs for the HIC
Criterion are generated.
values of the braking torques calculated during the simulation
are equivalent to the evaluated braking behavior of the robot.
Figure 3 illustrates an example of the end position of the
experiment (left) and the simulation of the same trajectory
(right). Nevertheless the acting acceleration at the TCP is
very different because of the missing structural dynamics
caused by stiffnesses and dampings of the robot, the cell
and the dummys body.
III. RESULTS
For analyzing the resulting accelerations, an acceleration
sensor is installed at the position of the pilotÕs head both
in real experiments and simulations. For the simulation, the
body is assumed to be totally Þxed at the simulator cell
and unable to move. The reason for not modeling the head-
neck-system is because of its complexity and the tremendous
inßuence on the results. The outcome of this work is meant
to give a tendency of the found WCBT. Thus no damping
terms except of the counterbalance unit are modeled. These
approximations lead to much higher accelerations at the head
due to the fact that the whole kinetic energy has to be
completely absorbed by the brakes.
For veriÞcation and comparison of the results, former
experiments [6] are simulated with this new approach. Af-
terwards, WCBT are primarily simulated and evaluated.
3299
Fig. 3. Estimating the braking torques from experiments to simulate the
robot behavior during emergency braking.
A. Optimization setup
The optimization problem is solved using the DLR Op-
timization Library for Modelica [14] using a sequential
quadratic programming algorithm because of the nonlinearity
of (6) and its capability of taking inequality constraints
into account. Because of local maxima there is initially a
rasterization of the workspace by systematic tuner variation
done for the tuner parameters q
e
and ú q
e
. The maximum
kinetic energy can only be reached if all joints move with
their maximum possible velocities which in turn is not
possible for every position because of the limiting motor
torques.
The tuner variation needs discrete steps which are the min-
imum and maximum velocity for each joint, ú q
e
=±? ú q
max
and for q
e
5 equidistant values from q
min,?
to q
max,?
for
each joint.
The best result out of this Þrst rasterization is taken as
starting position for the sequential quadratic programming
algorithm.
The values used as constraints are listed in table I.
B. Comparisonbetweenformer experiments andsimulations
To verify the model, experimental data of the whiplash
maneuver is taken from [6] and the trajectory is reused for
the simulation. The measured accelerations at the head of
the pilot have been compared to the simulated accelerations.
The commanded joint angles of axes 2, 3 and 5 are shown in
Þgure 4. After the emergency stop, the behavior of the joint
angles of the simulated robot during braking can be seen
in Þgure 4 on the right side of the dashed line. The scaled
acceleration of the experiment (see Þgure 5, upper diagram),
and simulation (see Þgure 5, lower diagram), differ especially
because of the missing movability of the dummyÕs body. The
maximum scaled acceleration of the experiment was 5.33g
and for the simulation 6.97g. From this point on, we will use
these results to compare them with the optimized simulations
and to determine whether the generated trajectory could lead
to a more dangerous situation in a real experiment, not to
predict quantitative values of experiments.
Fig. 4. Joint angles during the whiplash trajectory from [6]. The values after
the emergency stop result from the simulated emergency braking model.
Fig. 5. Scaled head acceleration of the dummyÕs head sensors of the
real whiplash experiment [6] (upper diagram) and scaled head acceleration
during the simulated whiplash trajectory (lower diagram).
C. Generation and simulation of WCBT
The maximization of the kinetic energy with the con-
straints from table I and a load of 350kg at the tool center
point (TCP) lead to the WCBT as seen in Þgure 6.
Figure 7 shows the position of the joints 1 to 7. At t= 2.5s
the brakes become active and the clutches are released. The
possible limits of the joint angles are not exploited. Using the
presented method, the joint accelerations of the acceleration
phase are at their maximum, which can be seen by the
constantly increasing joint velocity (see Þgure 8). Figure
9 shows the percentage of the used scaled motor torques
ö ? =
?
/?
max
. Because of its low dynamics, the linear axis
deÞnes the time for the whole trajectoryt
max
= 2.5s, and thus
is the Þrst of the robot axes starting accelerating (t
s
= 0).
At the end conÞguration the kinetic energy of the head is
maximized.
3300
Fig. 6. Movement of the DLR Robotic Motion Simulator performing the
optimized worst case braking trajectory.
Fig. 7. Position of the robot axes during the worst case braking trajectory.
Changing the load at the TCP has only a weak inßuence
on the trajectory. In comparison to the simulation of the
unoptimized whiplash trajectory, the scaled head acceleration
of the WCBT is 3 times higher, see Þgures 10 and 5 (lower
diagram). Table III shows the HIC values and the maximum
scaled acceleration of the experiments and the simulations.
The HIC value for the real experiment was measured to be
2.34, the HIC value for the simulated whiplash is 4.52. In
comparison to this the HIC value of the WCBT increased
to 14.87, highlighting the importance of selecting worst case
test trajectories for safety assessments.
As per [15], the lower limit for the HIC
36
value considered
threatening is 135. Although the simulated trajectories lead
to a HIC value that is well within the aforementioned
threatening limit, these values are higher than the ones
Fig. 8. Velocities of the robot axes during the worst case braking trajectory.
Fig. 9. Usage of motor torques normed to limits.
Fig. 10. Scaled acceleration of the worst case braking trajectory.
3301
observed during the tests in [6]. This can be attributed to
missing dynamics of the head-neck system, the non-frontal
direction of the acceleration vector, etc.
IV. CONCLUSION AND FUTURE WORK
In this work, a method for the generation of optimized
worst case braking trajectories (WCBT) for safety tests of
robotic motion simulators has been presented. The simulation
of the test results, based on a model for the emergency
brakes, shows a considerable increase of the HIC value
compared to heuristic trajectories like the whiplash trajectory
from [6]. Because of the approximations assumed in the
simulation model, it is necessary to validate these results
with dummy tests on the real robot system to check for
neglected effects like structural dynamics, the dynamics of
the pilotÕs head and body in the simulator cell and the
inßuence of the simpliÞed braking model. In the next steps,
the braking model should be extended and validated for the
different stop modes. Finding the maximum kinetic energy
is still a gradient based procedure and thus prone to local
maxima. The rasterization minimizes the threat of getting
stuck in a smaller local maxima but does not prevent it.
By using heuristic optimization methods like particle swarm
optimization or Þner rasterization, the likelihood to Þnd the
global maximum could be improved.
In order to examine other dangerous braking maneuvers for
example such leading to rotation around the yaw axis of the
pilotÕs head, the optimization criterion can be changed easily
to generate a trajectory leading to this dangerous motion.
Joint q
min
q
min,?
q
max,?
q
max
? ú q
max
? ¬ q
max
1 ?°
?
?°
?
+°
?
+°
?
70
?
/s 78
?
/s
2
2 ?128
?
?110.8
?
?59.2
?
?42
?
56
?
/s 58
?
/s
2
3 ?30
?
?8.6
?
55.6
?
77
?
69
?
/s 102
?
/s
2
4 ?90
?
?54
?
54
?
90
?
76
?
/s 34
?
/s
2
5 ?58
?
?34.8
?
34.8
?
58
?
76
?
/s 76
?
/s
2
6 ?90
?
?54
?
54
?
90
?
120
?
/s 54
?
/s
2
7 ?9.4m ?7.6m ?2.2m ?0.4m 1.5m/s 0.6 m/s
2
TABLE I
JOINT LIMITS FOR OPTIMIZATION CONSTRAINTS.
Joint q
s
q
e
ú q
e
¬ q
e
t
s
179.9
?
95.7
?
69.9
?
/s 78
?
/s
2
1.59 s
2 ?88.9
?
?75.6
?
55.6
?
/s 58
?
/s
2
1.54 s
3 ?6.8
?
4.8
?
68.8
?
/s 102
?
/s
2
1.83 s
4 ?12.0
?
30.5
?
75.6
?
/s 34
?
/s
2
0.25 s
5 ?18.0
?
0.55
?
75.6
?
/s 76
?
/s
2
1.50 s
6 ?13.0
?
53.6
?
119.7
?
/s 54
?
/s
2
0.27 s
7 ?5.9m ?5m 1.5m/s 0.6 m/s
2
0s
TABLE II
WORST CASE TRAJECTORY FOR THE DLR ROBOTIC MOTION
SIMULATOR WITH 350kg AT TCP.
whiplash
experiment
simulation
whiplash
WCBT
HIC
36
2.34 4.52 14.87
ö a
max
5.64 6.97 21.93
TABLE III
MAXIMUM ACCELERATIONS OF EXPERIMENT AND SIMULATIONS.
ACKNOWLEDGMENT
We want to thank Johann Heindl, Miguel Neves, Sami
Haddadin, Sebastian Minning, Sven Parusel and Tim Rokahr
for their help with the Þrst experiments leading to the
motivation for this paper and the availability of real data.
REFERENCES
[1] T. Bellmann, M. Otter, and G. Hirzinger, ÒThe DLR Robot Motion
Simulator Part II: Optimization based path-planning,Ó in Robotics and
Automation (ICRA), 2011 IEEE International Conference on, 2011,
pp. 4702Ð4709.
[2] M. Kleer, O. Hermanns, K. Dre§ler, and S. M¬ uller, ÒDriving simula-
tions for commercial vehicles-a technical overview of a robot based
approach,Ó Proceedings of the driving simulation conference europe
2012, 2012.
[3] H. Teufel, H. Nusseck, K. Beykirch, J. Butler, M. Kerger, H. B¬ ulthoff
et al., ÒMPI Motion Simulator: Development and Analysis of a Novel
Motion Simulator,Ó in AIAA Modeling and Simulation Technologies
Conference and Exhibit, 2007, pp. 1Ð11.
[4] T. Bellmann, J. Heindl, M. Hellerer, R. Kuchar, K. Sharma, and
G. Hirzinger, ÒThe DLR Robot Motion Simulator Part I: Design and
Setup,Ó in Robotics and Automation (ICRA), 2011 IEEE International
Conference on, 2011, pp. 4694Ð4701.
[5] K. Sharma, S. Haddadin, J. Heindl, T. Bellmann, S. Parusel, T. Rokahr,
S. Minning, and G. Hirzinger, ÒSerial kinematics based motion sim-
ulator - evaluation of safety of the passenger,Ó in The International
Conference on the Safety of Industrial Automated Systems (SIAS),
2012.
[6] K. Sharma, S. Haddadin, S. Minning, J. Heindl, T. Bellmann,
S. Parusel, T. Rokahr, and A. Albu-Schaeffer, ÒEvaluation of Human
Safety in the DLR Robotic Motion Simulator using a Crash Test
Dummy,Ó in Robotics and Automation (ICRA), 2013 IEEE Interna-
tional Conference on, 2013.
[7] K. H. Digges, ÒInjury Measurements and Criteria,Ó Models for Aircrew
Safety Assessment: Uses, Limitations and Requirements, 1999.
[8] S. Haddadin, A. Albu-Sch¬ affer, and G. Hirzinger, ÒSafety Evaluation
of Physical Human-Robot Interaction via Crash-Testing,Ó in Robotics:
Science and Systems, 2007.
[9] J. Versace, ÒA Review of the Severity Index,Ó in 15th Stapp Car Crash
Conference Proceedings, 15th Stapp Car Crash Conference Proceed-
ings, Ed., 1971, pp. 771Ð796.
[10] Assemessment Protocol - Adult Occupant Protection,
EuroNCAP, January 2013. [Online]. Available:
http://www.euroncap.com/Þles/Euro-NCAP-Assessment-ProtocolÑ
AOPÑv5.5Ñ0-c9cbb083-b4e6-4788-8496-81394a8788a7.pdf
[11] O. Bostroem, M. Y . Svensson, B. Aldman, H. A. Hansson, Y . Haaland,
P. Loevsund, T. Seeman, A. Suneson, A. Saeljoe, and T. Oertengren,
ÒA new neck injury criterion candidate-based on injury Þndings in the
cervical spinal ganglia after experimental neck extension trauma,Ó in
Proceedings Of The 1996 International Conference On The Biome-
chanics Of Impact (IRCOBI), Dublin, Ireland, no. 00767056, 1996,
pp. 123Ð36.
[12] M. V . Mark W. Spong, Seth Hutchingson, Robot Modeling and
Control. John Wiley & Sons, 2006.
[13] KUKA KR 360-3; KR 500-3 SpeciÞcation, on-
line, KUKA Roboter GmbH. [Online]. Avail-
able: http://www.kuka-robotics.com/res/sps/e6c77545-9030-49b1-
93f5-4d17c92173aa Spez KR 360-3 KR 500-3 en.pdf
[14] A. Pfeiffer, ÒOptimization Library for Interactive Multi-Criteria Opti-
mization Tasks,Ó in 9th International Modelica Conference, 2012.
[15] A. Patel and T. Goswami, ÒComparison of Intracranial Pressure by
Lateral and Frontal ImpactsÐValidation of Computational Model,Ó
2012.
3302
