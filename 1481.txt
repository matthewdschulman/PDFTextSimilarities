Dynamic Frictional Constraints in Translation and Rotation
Stuart A. Bowyer and Ferdinando Rodriguez y Baena
Abstract— Active constraints and virtual ﬁxtures are pop-
ular control strategies used within human-robot collaborative
manipulation tasks, particularly in the ﬁeld of robot-assisted
surgery. Recent research has shown how active constraints,
which robotically regulate the motion of a tool that is primarily
manipulated by a human, can be implemented in dynamic
environments which change and deform throughout a proce-
dure. In a dynamic environment, movement of the constraint
boundary can cause active forcing of the surgical tools, poten-
tially reducing the surgeon’s control and jeopardising patient
safety. Dynamic frictional constraints have been proposed as a
method for enforcing dynamic active constraints which do not
generate energy of their own, and simply dissipate or redirect
the energy of the surgeon to provide assistance. In this paper,
dynamic frictional constraints are reformulated to allow formal
proof that they are indeed dissipative, and hence also passive.
This new formulation is then extended such that dynamic
frictional constraints can simultaneously constrain the position
and orientation of a tool. Experimental results show that the
method is of signiﬁcant beneﬁt in performing a dynamic task
when compared to cases without any assistance; with position
and orientation constraints individually and with a conventional
frictional constraint without energy redirection.
I. INTRODUCTION
Active constraints [1] (also known as virtual ﬁxtures [2])
are robot control strategies used to provide assistance in
human-robot collaborative manipulation tasks [3]. Within the
literature there are different variations on the concept, but
in general, active constraints use a robot to anisotropically
regulate the motion of a tool which is primarily manipulated,
either directly or remotely, by a human user. The motion
regulation imparted by the robot is typically used to either
bound the tool to within a certain spatial region, or guide the
tool in moving along a pathway.
The majority of active constraint research focuses specif-
ically on methods for robot assisted surgery. Active con-
straints are well suited to this ﬁeld because of the way in
which they can combine the complementary proﬁciencies of
humans and robots.
Much of the early active constraint research was applied
in rigid environments, where the constraint geometries could
be considered to be static throughout a procedure. Recently,
however, several research groups have investigated the ap-
plication of active constraints to soft tissue environments
which deform or move over time, so called dynamic active
constraints [4], [5].
In a previous publication by the authors of this paper,
the energetic interaction between a user and a dynamic
S. A. Bowyer and F. Rodriguez y Baena are with the Department of
Mechanical Engineering, Imperial College London, London. SW7 2AZ. UK.
f.rodriguez@imperial.ac.uk
active constraint was investigated [6]. It was shown that
implementing a conventional elastic constraint in a dynamic
environment can lead to energetic activity in a robot, which
could in turn cause active forcing of the surgical tools,
reducing the surgeon’s overall control of the procedure. This
transfer in motive control from the surgeon to the robot can
have implications for patient safety and clinical certiﬁcation,
therefore a new constraint formulation was proposed.
In [6], a constraint based on friction was selected as the
solution to the problem of energy generation. Previously,
Kikuuwe et al. created the non-energy storing simulated
plasticity method of implementing constraints in static en-
vironments [7]. Simulated plasticity uses an anisotropic
proxy model to compute a large (plastic) friction force
when moving into a constrained region and a low (plastic)
force when moving out. The challenge with implementing
friction models, such as simulated plasticity, is that, once
the user has penetrated the constraint, they could continue to
remain within the constraint, moving parallel to the surface,
indeﬁnitely. Frictional redirection was the novel method
proposed in [6] to overcome this. The method operated by
applying the friction model non-orthogonally to the surface
so that some component of the user’s parallel motion would
generate a force which guided them back to the surface,
while continuing to remain dissipative.
In this paper, two developments to the dynamic frictional
constraint formulation from [6] are made. Firstly, the model
is reformulated in Euclidean space R
3
in such a way that
it can be proven to be dissipative. Secondly, it is shown
how rotations in the 3-D special orthogonal group SO(3)
can be mapped into Euclidean space such that six degree of
freedom (DOF) dynamic frictional constraints can be applied
simultaneously in position and orientation.
In section II the reformulation of dynamic frictional con-
straints in R
3
and their extension to SO(3) is explained.
Section III details the experimental method used to validate
the efﬁcacy of the proposed method, the results for which
are given in section IV. A discussion of the results is given
in section V and conclusions are drawn in section VI.
II. 6-DOF DYNAMIC FRICTIONAL CONSTRAINTS
In [6], 3-D constraints were achieved by rotating a modi-
ﬁed version of the 1-D elasto-plastic (EP) friction model [8]
in 3-D space. It operated so that when the user attempted to
move into a constrained region, they were opposed by the
friction force and when they retracted from the constraint
they were not.
The primary novelty in the initial publication, which ex-
tended earlier work on friction based constraints by Kikuuwe
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 2685
et al. [7], was the conception of frictional redirection. It was
noticed that, if a frictional constraint is applied which simply
opposes penetration and permits retraction, then, once a user
penetrates the constraint, they will never be pushed back out.
The user will be able to move parallel to the surface, inside
the constrained region, indeﬁnitely. It could be argued that
in a static constraint a high friction force will prevent any
penetration; however, in a dynamic environment, the surface
can move past the tool making constraint penetration likely.
Frictional redirection is illustrated in ﬁgures 3 and 5 of
[6]. The method works by rotating the 1-D friction model
as a function of the user’s direction of motion. When the
user moves directly into, or out, of the constraint, the friction
model acts as stated above. Importantly, when the user moves
approximately parallel to the constraint surface, the friction
model is oriented at an angle so that some component of the
friction force is towards the constraint surface, redirecting the
user’s motion to reduce the magnitude of the penetration.
The experiments in [6] showed the efﬁcacy of the method
in a dynamic path following task. For extension into SE(3) a
reformulation of frictional redirection was employed which
maintained the same energetic properties but permitted a
uniﬁed consideration of translation and rotation. Details of
this formulation are given in this section.
A. Elasto-plastic Friction Model in SE(3)
At the core of the dynamic frictional constraint concept
was the discrete EP friction model conceived by Hayward
et al. [8]. There are two primary reasons for the selection
of the EP model. The ﬁrst is that it is based on the well-
established LuGre friction model [9] and the second is that
it avoids issues with slow drift which would be unacceptable
for a constraint.
The EP model is illustrated in ﬁgure 1. In this model,
an object under friction has two components to its total dis-
placementx(t). The elastic displacementz(t) deﬁnes a small
amount of elastic pre-sliding and the plastic displacement
w(t) deﬁnes the position to which the object would return
if all external forces were removed.
Constrained
region
Unconstrained
region
w(t) z(t)
x(t)
p(t)
Object under friction
Origin
Frictional surface
Fig. 1. Illustration of the vectorial EP model used within dynamic frictional
constraints. An object’s total displacement x(t) is the sum of plastic w(t)
and elasticz(t) components. In a dynamic frictional constraint, the variable
p(t) is included to identify the depth of constraint penetration.
In the EP model, z(t) is an internal state variable which
is updated, based on the object’s total displacement x(t), at
each time-step. Using an elastic model of z(t), the friction
forcef
f
can then be computed using gains
0;1;2
, as follows:
f
f
(t) =
0
z(t) +
1
_ z(t) +
2
_ x(t) (1)
In the EP model, the value of z(t) is updated at each
time-step using two saturation operations (equations (12)
and (13) in [8]). The EP model was originally developed
as a way to simulate physical frictional properties such as
Stribeck curves; however, for application to constraints these
are unnecessary. A simple Coulomb friction model, where
the Coulomb forcef
C
is the maximum renderable constraint
force, is sufﬁcient. As proven in the appendix, in this case
the full EP model at discrete time-step k reduces to:
z
k
=
8
<
:
z
c
jz
c
j<z
css
z
css
z
c
z
css
 z
css
z
c
 z
css
(2)
where z
c
is the candidate z value and z
css
is the Coulomb,
steady state z value:
z
c
=z
k 1
+ x
k
(3)
z
css
=f
C
=
0
(4)
Intuitively, this shows that z
k
is computed by ﬁrst es-
tablishing what its value would be if the displacement was
purely elastic z
c
and then clamping this value toz
css
.
To extend the 1-D, discrete EP model into 6-D, each of
the displacement components (i.e.x(t),w(t) andz(t)) must
be represented in the special Euclidean group SE(3). In this
work, the total displacement of an object from an inertial
frame in SE(3) is deﬁned as x(t)2 R
6
. x(t) and its time
derivative _ x(t) are deﬁned as follows:
x(t) = [x
t
(t);x
r
(t)] (5)
_ x(t) = [_ x
t
(t); _ x
r
(t)] (6)
where x
t
(t)2R
3
is the translational displacement, x
r
(t)2
R
3
is the rotational displacement in SO(3), represented as
a rotation vector, _ x
t
(t) 2 R
3
is the translational velocity
and _ x
r
(t)2R
3
is the angular velocity in SO(3). These R
6
vectors are deﬁned similarly for w(t), z(t) and p(t).
Using these vector representations for the three compo-
nents of the frictional displacement, equation (1) becomes:
f
f
(t) = 
0
z(t) + 
1
_ z(t) + 
2
_ x(t) (7)
where f
f
(t)2 R
6
is the frictional force-torque value, and
the three gain matrices 2R
66
are deﬁned as follows:

i
= diag(
t;i
;
t;i
;
t;i
;
r;i
;
r;i
;
r;i
) (8)
where i = 0; 1; 2. In these matrices, the scalar coefﬁcients

t;0
and 
r;0
deﬁne the friction stiffness in translation and
rotation respectively; the scalar coefﬁcients 
t;1
and 
r;1
deﬁne the tangential compliance damping in translation and
rotation respectively; and the scalar coefﬁcients 
t;2
and

r;2
deﬁne the viscous friction coefﬁcients in translation and
rotation respectively.
In the remainder of this section the extension of the SE(3)
EP model to dynamic frictional constraints will be explained.
Due to the disconnection between translations in R
3
and
2686
rotations in SO(3), these will be considered independently
in this work. Constraints which couple motion in translation
and rotation are left for future work.
B. Dynamic Frictional Constraints inR
3
For translations in R
3
, the scalar clamping operation in
equation (2) can be thought of as clamping a candidate z
t;c
value to within a 3-D sphere, centred at the origin, with a
radius z
t;css
:
z
t;k
=

z
t;c
z
t;c
<z
t;css
z
t;css
^ z
t;c
otherwise
(9)
where:
z
t;c
= z
t;k 1
+ x
t;k
(10)
^ z
t;c
= z
t;c
=kz
t;c
k (11)
z
t;css
=f
C
=
t;0
(12)
Implementing the model in equation (9) would generate
isotropic friction forces which oppose motion in all directions
ofR
3
. Anisotropy and frictional redirection can be included
by projecting z
t;c
into a closed conical set C
t
R
3
rather
than a spherical one. The conical subset of R
3
is deﬁned
such that its axis is aligned with the constraint penetration
vector p
t;k
, with an apex angle , as follows:
C
t;k
=

w : w2R
3
; (w;p
t;k
);jjwjjz
t;css
	
(13)
where the binary function (;) deﬁnes the angle between
two vectors.
The computation ofz
t;k
for a dynamic frictional constraint
in R
3
is then given by the projection of z
t;c
into C
t;k
as
follows:
z
t;k
= arg min
w2C
t;k
kw z
t;c
k (14)
The closed-form expression of equation (14) for C
t;k
as
deﬁned in equation (13) is as follows:
z
t;k
=
8
<
:
z
t;c
(z
t;c
;p
t;k
)^kz
t;c
kz
t;css
z
t;css
^ z
t;c
(z
t;c
;p
t;k
)^kz
t;c
k>z
t;css
~ z
t;c
^ y otherwise
(15)
where ^ y is a unit vector deﬁning the edge of the cone C
t;k
on the plane through z
t;c
and p
t;k
; and ~ z
t;c
is the scalar
projection of z
t;c
onto ^ y, clamped between 0 and z
t;css
.
~ z
t;c
=
8
<
:
0 z
t;c
 ^ y 0
z
t;c
 ^ y 0< z
t;c
 ^ y<z
t;css
z
t;css
otherwise
(16)
An illustration of the conical constraint formulation is
given in ﬁgure 2. To understand its behaviour, the three
constraint violation states used in [6] can be considered.
When the user is orthogonally moving into the constraint
(orthogonal violation) the angle between z
c
and p is small
and the projection operation will limit the magnitude of z
c
toz
css
. Here the model acts in the same way as the standard
EP model in equation (9).
When the user is orthogonally retracting from the con-
straint (orthogonal retraction) the angle between z
c
and p
Constraint boundary
Target
position
Tool
position
p
t
Inertial
frame
x
t
z
t,c
z
t
?
C
t
Fig. 2. Illustration of the proposed dynamic frictional constraints. Shown
is an example of projecting the candidatezt;c into the conical vector subset
Ct to compute zt . The axis of the conical set is the constraint penetration
vector pt and it has an apex angle .
is almost 180

and the projection operation will set z
k
, and
subsequently the friction force, to zero.
When the user is moving parallel to the surface of the
constraint, but within it (parallel violation), z
c
will be
projected onto the edge of the cone. This projection means
that some component of the friction force will be pushing
the user towards the surface. It is in this case where the
constraint exhibits frictional redirection such that the user is
encouraged to retract from the constraint.
If  is low, then the constraint will not exhibit much
frictional redirection and will act largely like a conventional
frictional constraint, such as in [7]. However, as increases,
a larger and larger component of the motion parallel to the
constraint will generate frictional redirection forces, reducing
the constraint violation.
As this constraint formulation is based on a friction model,
it dissipates the majority of the energy that is put in. Formal
proof of the dissipativity of dynamic frictional constraints is
shown in the appendix. It is known that a dissipative system
is also passive [10], therefore it can be deduced that dynamic
frictional constraints are also passive (subject to the inherent
limitations of a discrete time system).
C. Dynamic Frictional Constraints in SO(3)
When applying dynamic frictional constraints to SO(3),
the choice of rotation formalism requires consideration.
Firstly, it must be possible to project a rotation into a ﬁnite,
conical subset of the rotation space with a deﬁned apex angle
and radius. Secondly, when projecting into the conical subset,
it must minimise the rotation angle between the candidate
and projected orientations.
Initially, unit quaternions [11] were selected for use in
applying dynamic frictional constraints in SO(3). Quaternion
rotations have the unique property that the angle between any
two vector representations (i.e. arccos(q
1
 q
2
)) is exactly
half the minimum angle between the two rotations that
they represent. Moreover, the set of unit quaternions can be
considered as a unit 3-sphere, S
3
 R
4
and therefore the
geodesic distance between any two quaternions onS
3
is also
exactly half the minimum angle between the two rotations
2687
that they represent. Subsequently, the direction of a geodesic
between two quaternions gives the most direct rotation
between them. It is this property that makes quaternions
adept at interpolating between rotations using the spherical
linear interpolation (SLERP) method [11].
The importance of the relationship between geodesics on
S
3
and minimum rotation angles is that quaternions can
be used to accurately describe a ﬁnite conical subset and
they guarantee that a projection minimises the true rotational
angle. An illustration of how the conical vector subset would
look on a quaternion sphere is shown in ﬁgure 3. Here,
rotations z
q
, z
q;c
, x
q
and p
q
are the quaternion equivalents
of the rotation vectors z
r
, z
r;c
, x
r
and p
r
respectively.
Target
orientation
Tool
orientation
p
q
Inertial
frame
x
q
z
q,c
z
q
?
C
q
Fig. 3. Illustration of the conical projection method on the surface of a
unit quaternion 3-sphere.
Ideally, it would be possible to apply the method from
equation (15) directly to quaternion vectors inR
4
. However,
these operations would not guarantee that the output remains
as a valid unit quaternion in S
3
. Instead, it is necessary to
map the surface of the quaternion 3-sphere intoR
3
Euclidean
space where the validity of the output is guaranteed.
In general, it is not possible to ﬁnd a mapping from
a manifold, such as S
3
, into a Euclidean space where all
relative distances and directions are preserved. However, for
performing a conical projection, the azimuthal equidistant
projection (AEP) [12] provides a suitable approximation.
Fortunately, the result of applying AEP to a unit quaternion
onS
3
is known, and the mapping is in fact equivalent to the
conversion of quaternions into rotation vectors [13].
The AEP can be visualised as ﬂattening out S
3
, starting
from the projection point, where both distances and azimuth
angles of all points with respect to the projection point are
preserved. By taking the AEP at the apex of the cone (i.e.
x
q
), the preservation of distances means that the radius of
the cone will be correct, and the preservation of azimuth
angles means that the apex angle of the cone will also be
correct. The problem with AEP is that the distance between
point pairs which do not include the projection point are not
preserved. This means that minimising the distance between
z
r;k
and z
r;c
does not necessarily minimise the geodesic
distance betweenz
q;k
andz
q;c
onS
3
. However, as the radius
of the cone is small, both z
r;k
and z
r;c
will be close to the
origin, where the projection is almost Euclidean making, this
difference negligible (as the results in section IV show).
To apply frictional redirection to rotational motion using
the conical projection method, the constraint penetration
vector p
r;k
and the candidate z vector z
r;c
must both be
represented as rotation vectors. As combining rotation vec-
tors is inefﬁcient, the candidate z
t;c
should ﬁrst be computed
as a quaternion, before converting into a rotation vector, as
follows (taking consideration of the reference frame for each
rotation):
z
q;c
= x
q;k
z
q;k 1
(17)
where is the quaternion product operation and x
q;k
is the
change in x orientation, with respect to the inertial frame:
x
q;k
= x
q;k
x
 1
q;k 1
(18)
Frictional redirection for rotation can be applied (similarly
to equation (14)) by projecting the candidate rotation vector
into the conical subset, as shown below. The actual imple-
mentation of this projection is the direct parallel of that for
translation in equation (15) and is not reproduced here.
z
r;k
= arg min
w2C
r;k
kw z
r;c
k (19)
where the conical subset is given as:
C
r;k
=

w : w2R
3
; (w;p
r;k
);jjwjjz
r;css
	
(20)
and where the cone’s radius is computed from the Coulomb
torque 
C
and rotational stiffness as follows:
z
r;css
=
C
=
r;0
(21)
It can be shown that this projection operation in rotation is
also dissipative by following the proof for translation in the
appendix and assuming that the magnitude of z
r;k
is small.
III. EXPERIMENTAL VALIDATION
A. Experimental Apparatus
The effectiveness of the proposed dynamic frictional con-
straint formulation was quantiﬁed with a simulated version
of The Steady-hand Game. In this game, a user moves a ring
along a curving wire pathway, while attempting to avoid the
ring and wire making contact. This game is a test of both
manual dexterity and hand-eye coordination for the user. The
primary reason for selecting this game to validate dynamic
frictional constraints is that the user must simultaneously
control both the position and orientation of the ring.
The visualisation for the simulation was created using The
Visualisation Toolkit (VTK, Kitware Inc.) and is shown in
ﬁgure 4. To assist the user in determining the depth of the
ring and wire within the scene, it was displayed on a 3-D
monitor using NVIDIA 3D Vision (NVIDIA Corp.).
A W5D haptic device (Entact Robotics Inc.) allowed the
user to control the position of the ring within the simulation
and rendered the constraint forces and torques back to them.
As the W5D only has ﬁve actuated degrees of freedom, the
2688
Fig. 4. Simulation of the steady-hand game used within the experiments.
Shown is the user controlled ring, the deforming wire pathway and the
active target towards which the user is moving.
non-actuated tool axis was aligned with the centre axis of the
ring. As the ring is rotationally invariant around this axis, the
lack of constraint torques had no effect on the task.
To validate the dynamic nature of the dynamic frictional
constraints, the wire pathways within the simulated steady-
hand game randomly deformed over time. The deformation
was achieved by applying a bounded random walk to each
control point of the cardinal spline that deﬁned the wire
pathway. For these experiments the speed of each deforming
control point was set at approximately 20 mm.s
 1
. The inner
diameter of the ring was 14 mm and the diameter of the wire
pathway was 8 mm.
The constraint control algorithms were implemented in
C++ on a Linux PC with a 3 GHz Core 2 Duo CPU (Intel
Corp.) at a haptic rate of 1 kHz. The 3-D visualisation was
implemented in C++ on a Windows PC (Microsoft Corp.)
with a 2.93 GHz Core i7-870 CPU (Intel Corp.)/Quadro 4000
GPU (NVIDIA Corp.) at a display rate of approximately
40 Hz. The user datagram protocol (UDP) was used to relay
ring positions from the control PC to the visualisation PC.
B. Experimental Procedure
Five constraint methods were used to assist the test sub-
jects within the experiments. These are shown below.
 UC- Unconstrained, no constraint forces or torques
were applied.
 DFC3T - 3-D translational dynamic frictional con-
straints. As in section II-B, with no constraint torques.
 DFC3R - 3-D rotational dynamic frictional constraints.
As in section II-C, with no constraint forces.
 FC6 - 6-D frictional constraints without frictional redi-
rection. Equivalent to DFC3T and DFC3R being applied
simultaneously with  = 0 rad. This approximates a
conventional static frictional constraint similar to that
described in [7].
 DFC6 - 6-D dynamic frictional constraints with fric-
tional redirection in translation and rotation. Equivalent
to DFC3T and DFC3R being applied simultaneously
with  = 0:4 rad.
The constraints were applied based on an optimal target
pose for the ring which maximised its separation from the
wire. The target position was deﬁned at the closest point on
the centreline of the pathway to the ring’s current position.
The target orientation was deﬁned as a coordinate frame at
the target position where the axis of the ring was aligned with
the tangent of the pathway. The closest points were found
by exhaustively searching a discretised set of line segments
which represented the centreline.
The parameters for the constraints were deﬁned empiri-
cally based on the capabilities of the selected haptic device
and are shown in table I.
TABLE I
PARAMETERS USED IN THE FRICTIONAL CONSTRAINTS.
Parameter Value Parameter Value
f
C
3.0 N 
C
20 N.mm

t;0
1.0 N.mm
 1

r;0
100 N.mm.rad
 1

t;1
0 N.s.mm
 1

r;1
0 N.mm.s.rad
 1

t;2
0.0025 N.s.mm
 1

r;2
0.002 N.mm.s.rad
 1
Each subject was given a document explaining the ex-
perimental procedure and then they were allowed a period
of time to familiarise themselves with the haptic device,
simulation and task. After this training period, 36 test runs
were undertaken. Six different wire pathways were used in
the tests, each of which was run with all ﬁve of the constraint
methods above. This gave a total of six runs, per subject,
per constraint method. The ordering of the test runs was
randomised and the users were not informed of the nature
of the constraints, or which one was assisting them. The
sole requirement placed upon the subject was that they avoid
contact between the ring and the wire.
A total of 7 people took part in the experiments. This
consisted of 6 (1) males (females), 5 (2) right (left) handed
people and 2 (5) surgeons (non-surgeons), all of whom had
previous experience with haptic simulations.
IV. RESULTS
Two primary metrics of the effectiveness of the constraint
methods are presented. The ﬁrst metric was the mean sepa-
ration between the ring and pathway for each test run. The
second metric was the percentage of the traversal for which
the ring and pathway were in contact.
The means and standard deviations for each of these met-
rics, across all 42 test runs with each constraint method, is
given in table II. The distributions within this table for ring-
pathway separation and contact percentage are visualised in
the box plots in ﬁgures 5 and 6 respectively.
One-way analysis of variance (ANOV A) tests were applied
to the results from both ring-pathway separation and contact
percentage; and in both cases they were found to be signiﬁ-
cantly affected by the constraint method used (p < 10
 6
).
Pairwise comparisons were subsequently made between each
constraint method using Tukey’s honest signiﬁcant difference
(HSD) test [14] at the 90 % and 95 % conﬁdence intervals.
The results from these pairwise comparisons are given for
the ring-pathway separation and contact percentage in tables
III and IV respectively. As expected, in all cases the mean
2689
TABLE II
RESULTS FOR RING-PATHWAY SEPARATION AND CONTACT
PERCENTAGES.
Mean ring-pathway
separation
Contact percentage
Mean Stdev Mean Stdev
UC 0.14 mm 0.09 mm 82.2 % 9.5 %
DFC3T 1.20 mm 0.50 mm 23.4 % 22.4 %
DFC3R 0.17 mm 0.11 mm 82.1 % 10.8 %
FC6 1.06 mm 0.56 mm 34.0 % 23.9 %
DFC6 1.57 mm 0.50 mm 12.8 % 13.3 %
0
0.5
1
1.5
2
2.5
UC DFC3T DFC3R FC6 DFC6
Separation (mm)
Fig. 5. Distributions of the mean separation between the ring and pathway.
power for each test was negative therefore these plots are
not shown.
TABLE III
RESULTS OF THE TUKEY HSD TEST FOR RING-PATHWAY SEPARATION
AT THE 95 % () AND 90 % () CONFIDENCE INTERVALS.
DFC3T DFC3R FC6 DFC6
UC   
DFC3T  
DFC3R  
FC6 
TABLE IV
RESULTS OF THE TUKEY HSD TEST FOR CONTACT PERCENTAGE AT THE
95 % () AND 90 % () CONFIDENCE INTERVALS.
DFC3T DFC3R FC6 DFC6
UC   
DFC3T   
DFC3R  
FC6 
V. DISCUSSION
The mean values for ring-pathway separation ranged be-
tween 0.14 mm and 1.57 mm. The mean contact percentages
ranged between 12.8 % and 82.2 %. Higher mean separations
and lower contact percentages identify constraint methods
which were more effective at assisting the users.
The results show that, for both metrics, the lowest perfor-
mance was unsurprisingly recorded during the unconstrained
case (UC). The randomised deformation of the pathway
meant that the task itself was difﬁcult as it required quick re-
actions and high dexterity from the user. Without assistance,
0
20
40
60
80
100
UC DFC3T DFC3R FC6 DFC6
Contact percentage (%)
Fig. 6. Distributions of the contact percentage.
the majority of the test subjects were not physically able to
successfully navigate along the pathway.
During the experiments where translational dynamic fric-
tional constraints were applied (DFC3T), the average perfor-
mance under both metrics signiﬁcantly improved from UC.
These results conﬁrm those presented in [6] and, importantly,
also show that constraining position is beneﬁcial even when
orientation is a factor in the task. The likely cause of this
is that the cognitive load involved in positioning the ring is
reduced to such a degree that the user has the time to actively
consider and control the orientation as required for the task.
When dynamic frictional constraints were applied to ro-
tation in isolation (DFC3R), the average performance under
both metrics increased slightly from UC; however, this differ-
ence was not found to be statistically signiﬁcant. During the
tests of UC and DFC3R the users spent most of the time with
the ring deeply embedded in, or completely pushed through,
the pathway. The magnitude of the assistance that a rotational
constraint can offer is much smaller than that for translation
as at most it can only separate the ring and pathway by
the inner radius of the ring. This limited improvement from
controlling orientation implies that it was not possible for
the users to overcome the positional difﬁculty of the task.
The 6-DOF frictional constraints without frictional redi-
rection (FC6) were included within the experiments to
identify if, and how, the frictional redirection assisted the
user. The results show that the average performance for
FC6 was signiﬁcantly lower than DFC6 and lower than
DFC3T. These results conform to the hypothesis behind
frictional redirection that, once a user penetrates a constraint,
a conventional frictional constraint will permit them to move
parallel to the constraint indeﬁnitely. It is expected that, if
the speed of deformation on the pathway was increased,
the difference between FC6 and those employing frictional
redirection would become even more pronounced.
Full 6-DOF dynamic frictional constraints led to the best
average user performance. It was signiﬁcantly better than all
methods in both metrics at the 95 % conﬁdence interval,
except DFC3T in contact percentage, for which it was at
90 %. The interesting aspect of this result is that DFC3R in
isolation was of no signiﬁcant beneﬁt; however, combining it
with DFC3T made a signiﬁcant improvement. Hence, DFC6
was shown to be greater than the sum of its parts.
2690
VI. CONCLUSIONS
A previous publication by the authors introduced the
concept of a dynamic frictional constraint. This is a novel
control formulation for robot assisted surgery, intended to
assist a surgeon while operating within a dynamically chang-
ing environment. The core aspect of a dynamic frictional
constraint is that it generates its assistance by redirecting
and dissipating a surgeon’s energy and never generates any
energy of its own. This property prevents active forcing of the
surgical tool by the robot, ensuring that the surgeon always
maintains overall control.
In this paper the dynamic frictional constraint concept
has been rederivied for translations in R
3
, proven to be
dissipative and has been extended for rotations in SO(3). The
energy redirection in the new formulation is based around the
abstracted projection of a vector into a cone. The abstraction
of this operation means that it can be applied to constrain
both rotation and translation in an almost identical way.
To validate the effectiveness of the constraint formulation,
a simulation of a dynamic task relying on accurate position-
ing and orientation was implemented. The experimental re-
sults showed that the method was of signiﬁcant beneﬁt when
compared to cases without any assistance; with position and
orientation constraints individually and where a conventional
frictional constraint (without energy redirection) were used.
It was identiﬁed during these experiments, and stated
previously in the literature [15], that due to their disconnect,
often a user will not notice an error in either position
or orientation if they are focussed on the other. It would
therefore be likely that applying this concept of energy
redirection between translation and rotation will improve
the performance of dynamic frictional constraints even fur-
ther. Implementing this coupling and integrating the method
within a more clinical task will be the focus of future work.
APPENDIX
Simpliﬁcation of the elasto-plastic friction model
When using the EP model to represent Coulomb fric-
tion, without elastic pre-sliding, the discrete operations in
equations (12) and (13) of [8] reduce to a single saturation
operation upon a candidate z value z
c
which represents a
fully elastic displacement.
Proof: By settingf
max
=f
C
in the standard Coulomb
model for EP friction (equation (6) in [8]), the steady-state
z value z
ss
( _ x) (equation (9) in [8]) becomes:
z
ss
( _ x) =

z
css
_ x 0
 z
css
otherwise
(22)
where z
css
=f
C
=
0
.
This representation ofz
ss
( _ x) allows the fractional inequal-
ity used in the EP model’s saturation operations (equations
(12) and (13)) to be represented as follows:
z
z
ss
( _ x)
< 1, (jzj<z
css
)_ (sgn( _ x)6= sgn(z)) (23)
Using this notation, a bi-directional step function, equiv-
alent to that shown in ﬁgure 5 of [8] without the breakaway
deﬂection, can be used to deﬁne (z; _ x):
(z; _ x) =

0 (jzj<z
css
)_ (sgn( _ x)6= sgn(z))
1 otherwise
(24)
By the equivalence in equation (23), when the expres-
sion for (z; _ x) in equation (24) is substituted into the
top subfunction of equation (12) in [8] it is clear that
8z8 _ x (z; _ x) = 0. The function subsequently simpliﬁes to:
y
k
=

x
k
z
k 1
zss(v
k
)
< 1
0 otherwise
(25)
From equation (25) it is known that:
z
k 1
z
ss
(v
k
)
 1 =) y
k
= 0 (26)
Therefore it must also hold that:
z
k 1
z
ss
(v
k
)
 1 =)

z
k 1
z
ss
(v
k
)

=

z
k 1
+y
k
z
ss
(v
k
)

(27)
Consolidation of the two saturation operations gives:
z
k
=
(
z
c

z
k 1
zss(v
k
)
< 1

^

zc
zss(v
k
)
< 1

z
ss
(v
k
) otherwise
(28)
wherez
c
=z
k 1
+x
k
is the candidatez value representing
a fully elastic displacement.
By expressing the conditions in equation (28) using the
alternate form in equation (23), it can be seen that the ﬁrst
clause of the top subfunction is redundant and therefore this
operation further simpliﬁes to:
z
k
=

z
c
(jz
c
j<z
css
)_ (sgn( _ x)6= sgn(z
c
))
z
ss
(v
k
) otherwise
(29)
As the magnitude of z
css
is constant, it can be proven by
induction that:
jz
c
jz
css
=) sgn( _ x) = sgn(z
c
) (30)
Such that equation (29) reduces to:
z
k
=

z
c
jz
c
j<z
css
z
ss
(v
k
) otherwise
(31)
Substituting the deﬁnition forz
ss
(v
k
) from equation (22),
and using the implication in equation (30), the ﬁnal simpli-
ﬁed equation for z
k
is:
z
k
=
8
<
:
z
c
jz
c
j<z
css
z
css
z
c
z
css
 z
css
z
c
 z
css
(32)
Dissipativity of dynamic frictional constraints inR
3
In general, a system is said to be dissipative [16] if8t
1
 0
and8t
2
t
1
:
Z
t2
t1
s (u(t);y(t)) dtV (a(t
2
)) V (a(t
1
)) (33)
where u(t) and y(t) are the system inputs and outputs at
timet respectively,s() is the supply rate of energy into the
2691
system, V () is a continuous, non-negative storage function
and a(t) is the system state variable. Dynamic frictional
constraints conform to this deﬁnition of dissipativity.
Proof: Dissipativity can be proven by substituting the
robot power for the supply rate, the spring energy for the
storage function and the elastic displacement for the system
state variable in equation (33). The inequality subsequently
becomes:
Z
t2
t1
f(t) _ x(t)dt
1
2

0
kz(t
2
)k
2
 
1
2

0
kz(t
1
)k
2
(34)
It is possible to prove this inequality by showing that
8t  0 the derivative of the storage function is never greater
than the supply rate:
f(t) _ x(t)
d
dt
1
2

0
kz(t)k
2
(35)
f(t) _ x(t)
0
kz(t)k
dkz(t)k
dt
(36)
Assuming that the damping elements of the constraint
force are dissipative:

0
z(t) _ x(t)
0
kz(t)k
dkz(t)k
dt
(37)
^ z(t) _ x(t)
dkz(t)k
dt
(38)
where the overhat symbol identiﬁes a normalised vector.
Discretising the model at time k and dividing through by
the time-step (making the assumption that the time-step is
small such that _ x
k
 _ x
k 1
):
^ z
k
 x
k
kz
k
k kz
k 1
k (39)
Equation (39) is initially proven for the ﬁrst and second
subfunctions of equation (15) by substituting in:
x
k
=z
k
 z
k 1
where  1 (40)
Giving:
^ z
k
 (z
k
 z
k 1
)kz
k
k kz
k 1
k (41)
kz
k
k kz
k
k +kz
k 1
k ^ z
k
z
k 1
(42)
Applying Cauchy’s inequality to the right hand side:
kz
k
k kz
k
k +kz
k 1
kkz
k 1
k (43)
 1 (44)

Equation (39) is next proven for the third subfunction of
equation (15) when ^ yz
c
 0. Considering equation (16):
^ yz
c
 0 =) kz
k
k = 0 (45)
By substitutingkz
k
k = 0 into equation (37), both left and
right hand sides become zero proving the inequality. 
Equation (39) is ﬁnally proven for the third subfunction
of equation (15), when ^ yz
c
> 0, by substituting in:
z
k
= (^ yz
c
) ^ y where 1 0 (46)
x
k
= z
c
 z
k 1
(47)
and considering equation (16) such that:
^ yz
c
> 0 =) kz
k
k> 0 =) ^ z
k
= ^ y (48)
Giving:
^ y (z
c
 z
k 1
) (^ yz
c
) kz
k 1
k (49)
^ yz
c
  (^ yz
c
) +kz
k 1
k ^ yz
k 1
(50)
Applying Cauchy’s inequality to the right hand side:
^ yz
c
  (^ yz
c
) +kz
k 1
kkz
k 1
k (51)
1 (52)
ACKNOWLEDGMENT
This work was supported by EU Grant FP7-ICT-2009-6-
270460. The authors thank Dr Fernando Bello and the Sim-
ulation and Modelling in Medicine and Surgery (SiMMS)
research group at Imperial College London for the use of
their research facilities.
REFERENCES
[1] B. Davies, M. Jakopec, S. J. Harris, F. Rodriguez y Baena, A. Barrett,
A. Evangelidis, P. Gomes, J. Henckel, and J. Cobb, “Active-constraint
robotics for surgery,” Proc. IEEE, vol. 94, no. 9, pp. 1696–1704, 2006.
[2] L. B. Rosenberg, “Virtual ﬁxtures: Perceptual tools for telerobotic
manipulation,” in Proc. IEEE Virt. Real. Annual Int. Symp., sept. 1993,
pp. 76 –82.
[3] S. A. Bowyer, B. L. Davies, and F. Rodriguez y Baena, “Active
constraints/virtual ﬁxtures: A survey,” IEEE Trans. Robot., vol. 30,
no. 1, pp. 138–157, feb. 2014.
[4] K.-W. Kwok, K. H. Tsoi, V . Vitiello, J. Clark, G. Chow, W. Luk, and
G.-Z. Yang, “Dimensionality reduction in controlling articulated snake
robot for endoscopy under dynamic active constraints,” IEEE Trans.
Robot., vol. 29, no. 1, pp. 15–31, 2013.
[5] J. G. Petersen and F. Rodriguez y Baena, “A dynamic active constraints
approach for hands-on robotic surgery,” in Proc. IEEE/RSJ Int. Conf.
Intell. Robot. Syst., 2013, pp. 1966–1971.
[6] S. A. Bowyer and F. Rodriguez y Baena, “Dynamic frictional con-
straints for robot assisted surgery,” in Proc. IEEE World Haptics Conf.,
2013, pp. 319–324.
[7] R. Kikuuwe, N. Takesue, and H. Fujimoto, “A control framework to
generate nonenergy-storing virtual ﬁxtures: Use of simulated plastic-
ity,” IEEE Trans. Robot., vol. 24, no. 4, pp. 781–793, aug. 2008.
[8] V . Hayward, B. S. R. Armstrong, F. Altpeter, and P. E. Dupont,
“Discrete-time elasto-plastic friction estimation,” IEEE Trans. Control
Syst. Technol., vol. 17, no. 3, pp. 688 –696, may 2009.
[9] C. Canudas de Wit, H. Olsson, K. Astrom, and P. Lischinsky, “A
new model for control of systems with friction,” IEEE Trans. Autom.
Control, vol. 40, no. 3, pp. 419–425, mar. 1995.
[10] B. Brogliato, R. Lozano, B. Maschke, and O. Egeland, Dissipative
Systems Analysis and Control: Theory and Applications. Springer-
Verlag, 2007.
[11] E. B. Dam, M. Koch, and M. Lillholm, “Quaternions, interpolation
and animation,” Department of Computer Science, University of
Copenhagen, Tech. Rep. DIKU-TR-98/5, 1998.
[12] F. Pearson, Map Projections: Theory and Applications. CRC Press
Inc., 1990.
[13] R. I. Hartley and F. Kahl, “Global optimization through rotation space
search,” Int J. Comput Vis., vol. 82, pp. 64–79, 2009.
[14] R. G. D. Steel, J. H. Torrie, and D. A. Dickey, Principles and
Procedures of Statistics: A Biometrical Approach, 3rd ed. McGraw-
Hill, Inc., 1997.
[15] R. Castillo-Cruces and J. Wahrburg, “Virtual ﬁxtures for autonomous
error compensation for human-robot cooperative tasks,” Robotica,
vol. 28, pp. 267–277, 2010.
[16] J. C. Willems, “Dissipative dynamical systems,” Euro. J. Control,
vol. 13, pp. 134–151, 2007.
2692
