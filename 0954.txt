A Hybrid Feedback Controller for Robust Global Trajectory Tracking of
Quadrotor-like Vehicles with Minimized Attitude Error
Pedro Casau, Ricardo G. Sanfelice, Rita Cunha, David Cabecinhas, Carlos Silvestre
AbstractÑIn this paper, we tackle the problem of trajectory
tracking for a particular class of underactuated vehicles with
full torque actuation and a single force direction (thrust) that
is Þxed relative to a body attached frame. Additionally, we
consider that thrust reversal is not available. We present the
design of a hybrid controller that, under some given assump-
tions, is able to globally asymptotically stabilize the vehicle to a
reference position trajectory while minimizing the angle to the
desired attitude trajectory. This objective is achieved robustly
and globally, in the sense that small perturbations do not lead
to instability and it is achieved regardless of the initial state
of the vehicle. The algorithm is tested in a experimental setup,
using a small scale quadrotor vehicle and the VICON motion
capture system.
I. INTRODUCTION
There exist several vehicles that are usually modeled as
rigid-body vehicles for controller design purposes, namely,
aircraft, spacecraft, marine vessels, among others. New sen-
sor and processor technology have enabled their miniatur-
ization and, ultimately, the development of automatic control
and planning algorithms, which, in turn, have increased their
autonomy, allowing for complex tasks to be carried out with
little human intervention. These vehicles can be used for
targeting, surveillance, inspection, among a plethora of other
applications [14], [19].
More often than not, autonomous vehicles need to move
within cluttered and unstructured environments. In order to
avoid collisions or any other hazardous situation, several
path planning algorithms have been proposed such as the
ones given in [25], [2] and [5]. However, these strategies
require a reference tracking controller to work as intended.
To this end, trajectory tracking controllers were developed
for fully-actuated vehicles (see e.g. [28], [27], [7], [6]) and
also for underactuated vehicles (see e.g. [12], [1], [16],
[8], [31]). Since the rotation of a rigid-body vehicle is
represented by an element ofSO(3), the application of these
controllers to such vehicles is hindered by the topological
Pedro Casau, Rita Cunha, David Cabecinhas and Carlos
Silvestre are with the Department of Electrical Engineering and
Computer Science, and Institute for Robotics and Systems in
Engineering and Science (LARSyS), Instituto Superior TŽcnico,
Universidade TŽcnica de Lisboa, 1049-001 Lisboa, Portugal.
{pcasau,rita,dcabecinhas,cjs}@isr.ist.utl.pt
Ricardo G. Sanfelice is with the Department of Aerospace and Mechan-
ical Engineering, University of Arizona 1130 N. Mountain Ave, AZ 85721.
sricardo@u.arizona.edu
C. Silvestre is with the Department of Electrical and Computer Engineer-
ing, Faculty of Science and Technology of the University of Macau.
The work of Pedro Casau and David Cabecinhas was supported with
grantsSFRH/BD/70656/2010andSFRH/BD/31439/2006,respectively,from
Funda‹o para a Cincia e a Tecnologia.
This research has been partially supported by the National Science
Foundation under CAREER Grant no. ECS-1150306 and by the Air Force
OfÞce of ScientiÞc Research under Grant no. FA9550-12-1-0366.
obstructions to global stabilization in SO(3) by means of
continuous feedback. In fact, given a vector Þeld deÞned
in SO(3), there exists no equilibrium point that is globally
asymptotically stable (see [4] for an enlightening discussion
on this topic). In other words, if a continuous feedback
law is used in order to stabilize the attitude of a rigid
body to a given set-point (or trajectory), there are certain
initial states that do not allow the accomplishment of such
objective. The controller presented in [11] works around this
issue by globally stabilizing a given set point by means of
discontinuous feedback. However, it has been proved in [21]
that a given point in a compact manifold cannot be globally
robustly stabilized by means of continuous nor discontinuous
feedback. In this context, the design of hybrid controllers
has been shown to be able to overcome the topological
hindrances of attitude stabilization for fully-actuated rigid-
bodies, by means of hybrid quaternion feedback [22] and
rotation matrix feedback [22].
In this paper, we address the trajectory tracking problem
for an underactuated vehicle with a single thrust force direc-
tion and full torque maneuverability. This class of vehicles
encompasses most UAVs and AUVs, as long as the externals
disturbances are within reasonable bounds. Similarly to [16],
[8], to deal with the problem of unmodeled dynamics, we
propose a saturated controller with disturbance rejection
properties. Also, due to the underactuation of the class of
vehicles that we are considering, it is not possible to follow
arbitrarytrajectories.Therefore,similarlyto[12],wepropose
a controller that performs position tracking with asymptoti-
callystablepositionerror,whilekeepingaminimumdistance
to an arbitrary attitude trajectory. Moreover, we achieve this
objective globally by resorting to hybrid quaternion feedback
strategies, as in [23]. The work presented in this paper
expands that of [10] by adding robustness to unmodeled
dynamics, achieving optimal tracking of a reference attitude
trajectory and providing both simulation and experimental
results. The experimental results are obtained using a motion
capture system which, over the last few years, has become
instrumental in the test of novel control methodologies (see
e.g. [25]).
The remainder of this paper is organized as follows. In
Section II, we present notational conventions that are used
throughout the paper. Section III describes the problem setup
that is addressed in the subsequent sections. In Section IV,
we describe the controller design for the position subsystem
and in Section V we present the control law that achieves
the desired goal. Experimental and simulation results are
provided in Section VI considering a quadrotor vehicle.
Finally, some concluding remarks are given in Section VII.
Proofs of the results presented in this paper will appear
2014 IEEE International Conference on Robotics & Automation (ICRA)
Hong Kong Convention and Exhibition Center
May 31 - June 7, 2014. Hong Kong, China
978-1-4799-3684-7/14/$31.00 ©2014 IEEE 6272
elsewhere.
II. PRELIMINARIES
Let SO(n) denote the set of n?n matrices that satisfy
det(R) = 1 and R
?
R = RR
?
= I
n
. Furthermore, let
SE(n) :=R
n
?SO(n), and S
n
:={x?R
n+1
|x
?
x = 1}.
Two very common representations of the attitude of a rigid-
body are the rotationmatrices and theunit quaternions, given
by R ? SO(3) and q =

? ?
?

?
? S
3
, respectively. The
mapping R :S
3
?SO(3), given by
R(q) :=I
3
+2?S(?)+2S(?)
2
,
with
S(x) =
?
?
0 ?x
3
x
2
x
3
0 ?x
1
?x
2
x
1
0
?
?
,
is known as the Rodrigues formula and it maps a given
quaternion to a rotation matrix. This mapping is a local
diffeomorphism but many-to-one globally, since R(q) =
R(?q). Quaternion multiplication is given by the mapping
q
1
q
2
=

?
1
?
2
??
?
1
?
2
?
1
?
2
+?
2
?
1
+S(?
1
)?
2

.
The inverse of the unit quaternion is given by q
?1
= [? ?
?
?
]
?
and is such thatqq
?1
=q
?1
q = [1 0 0 0]
?
. Moreover,
the following relationship holds: ?(R(q)v) = q?(v)q
?1
for
anyv?R
3
, with?(v) := [0v
?
]
?
. For more information on
quaternion algebra, the reader is referred to [30] or [17].
Another representation of the attitude of a rigid-body is
the angle-axis representation, described as follows: given
a angle-axis pair (?,v) ? [0,¹]?S
2
, the rotation matrix
associated with a rotation of ? around the unit vector v is
given by
R(?,v) :=I
3
+sin(?)S(v)+(1?cos(?))S(v)
2
.
The following notation is also used in the sequel: the
canonical basis forR
n
is the set
n
S
i=1
{e
i
}, wheree
i
?R
n
is a
vectorwhoseentriesarezeros,exceptforthei-thentrywhich
is 1; the inner product between two matrices A,B?R
m?n
is given by hA,Bi := trace
 
A
?
B

. If n = 1, then the
previous inner product reduces to the standard vector inner
product hA,Bi := A
?
B; the closed unit ball B ? R
n
is
given by B := {x ? R
n
|kxk ² 1}. Given a set valued
mapping M :R
m
?R
n
, the range of M is the set
rge(M) ={y?R
n
|?x?R
m
such that y?M(x)}.
In this paper, we follow the same notation in [20] to
represent the derivatives of differentiable functions. Let F :
R
m?n
?R
p?q
be a differentiable function, then
D
X
(F) :=
¶vec(F)
¶vec(X)
?
,
where vec(A) :=

e
?
1
A
?
... e
?
n
A
?

?
, for any A ?
R
m?n
. In some particular cases, we use a more conventional
notation. Given a differentiable function V : R
n
? R,
the gradient is deÞned as [?V]
i
:=
¶V
¶xi
, for each i ?
{1,2,...,n}. Let v?R
m
, then we deÞne
?
v
V :=

¶V
¶v1
¶V
¶v2
...
¶V
¶vm

?
.
Given a function H :R?R
m?n
we deÞne

dH
dt

ij
:=
dH
ij
dt
,
for each i?{1,2,...,m} and for each j?{1,2,...,n}.
In this paper, we also make use of the function ? :
SO(3)?R
9
, given by
?(R) :=?

S(Re
1
) S(Re
2
) S(Re
3
)

?
,
with the following property
vec(RS(?)) =??(R)R?, (1)
and of the K-saturation function, deÞned as follows.
DeÞnition 1: A K-saturation function is a smooth non-
decreasing function ?
K
:R?R that satisÞes the following
properties:
1) ?
K
(0) = 0,
2) s?
K
(s)> 0 for all s6= 0,
3) lim
s?±°
?
K
(s) =±K, for some K > 0.
Moreover, for each x?R
n
we deÞne
?
K
(x) :=

?
K
(x
1
) ... ?
K
(x
n
)

?
.

Also, we make use of recent developments on hybrid
systems theory which are described in [13]. Under this
framework, a hybrid system H is deÞned as
H =
(
ú x?F(x) x?C
x
+
?G(x) x?D
,
where: the set-valued mapF :R
n
?R
n
is the ßow map and
governs the continuous dynamics (also known as ßows) of
the hybrid system; the setC ?R
n
is the ßow set and deÞnes
the set of points where the system is allowed to ßow; the set-
valued map G :R
n
?R
n
is the jump map and deÞnes the
behavior of the system during jumps; the setD?R
n
is the
jump set and deÞnes the set of points where the system is
allowed to jump.
ThedeÞnitionofglobalasymptoticstabilityofaclosedset
A?R
n
forahybridsystemHisgivenin[13,Chapter7]. In
the next section, we proceed to establish the problem setup.
III. PROBLEM SETUP
In this paper, we consider the problem of designing a
controller for a class of rigid bodies with a single thrust
direction and full torque actuation. This includes, for exam-
ple, helicopters, quadcopters and underactuated underwater
vehicles. For controller design purposes, we consider the
following equations of motion
ú p =v, (2a)
ú v =?R(q)e
3
T
m
+ge
3
+b, (2b)
ú q =
1
2
q?(?), (2c)
where p ? R
3
denotes the position of the rigid body in
the inertial reference frame, v ? R
3
represents its linear
velocity, q ? S
3
denotes the unit quaternion that represents
the orientation of the body Þxed frame with respect to
the inertial reference frame, ? ? R
3
denotes the angular
velocity, g ? R denotes the acceleration of gravity, b ? R
3
represents a constant unknown disturbance, T ? R is the
thrust magnitude and m ? R denotes the mass of the rigid
6273
body. For more information on this model the reader is
referred to [26] and [3]. Notice that we have not explicitly
included aerodynamic/hydrodynamic effects in (2) because
these are application dependent and typically difÞcult to
model. In order to overcome modelling uncertainties to some
degree,wedesignacontrollerthatisrobustbothwithrespect
to small measurement noise and constant force disturbances.
Let (p
d
(t),R
d
(t)) ? SE(3) denote a reference position
and attitude trajectory which is deÞned for all t³ 0. In this
paper, we consider only reference trajectories that satisfy the
following assumption.
Assumption 1: A given reference trajectory is a function
t7? (p
d
(t),R
d
(t))?SE(3)deÞned forallt³ 0,satisfying:
the reference position trajectory p
d
(t) and its derivatives up
top
(4)
d
(t)arebounded,andp
(4)
d
(t)?M
p
BforsomeM
p
> 0;
the reference attitude trajectory is generated by the system
ú
R
d
=R
d
S(?
d
), ú ?
d
?M
?
B, (3)
for some M
?
> 0. 
Given Assumption 1 and (1), we say that
r(t) := [p
d
(t)
?
, p
(1)
d
(t)
?
, p
(2)
d
(t)
?
, p
(3)
d
(t)
?
,
vec(R
d
(t))
?
, ?
d
(t)
?
]
?
?R
is a solution to the differential inclusion
ú r? F
d
(r) :={p
(1)
d
}?{p
(2)
d
}?{p
(3)
d
}?MpB
?{??(R
d
)R
d
?
d
}?M?B,
and R :=R
12
?SO(3)?R
3
.
In this paper, our main goal is to design a controller
that tracks the desired position trajectory, while steering the
orientation q to q
0
, which is deÞned to be the closest unit
quaternion to one of the unit quaternions corresponding to
R
d
? SO(3). Moreover, it satisÞes the rotation kinematics
ú q
0
=q
0
?(?
0
)/2 for some function ?
0
:R
³0
?R
3
. To this
end, let us deÞne the error variables
p
0
:=p?p
d
, v
0
:=v? ú p
d
, q
1
:=qq
?1
0
.
Differentiating the error variables and using (3), (2c) and the
properties of quaternion algebra described in Section II, we
obtain
ú p
0
=v
0
,
ú v
0
=?R(q
1
)R(q
0
)e
3
T
m
+ge
3
+b?p
(2)
d
,
ú q
1
=
1
2
q
1
?(R(q
0
)(???
0
)).
With these deÞnitions, we are now able to precisely state the
problem to solve in this work.
Problem 1: Given a reference trajectory satisfying As-
sumption 1, and a desired orientationq
0
(t) which minimizes
trace
 
I
3
?R(q
0
(t))R
d
(t)
?

for each t³ 0, design a hybrid controller
ú x
c
?F
c
(r,p,v,q,x
c
) (r,p,v,q,x
c
)?C
c
, (4a)
x
+
c
?G
c
(r,p,v,q,x
c
) (r,p,v,q,x
c
)?D
c
, (4b)
and (T,?) = ?(r,p,v,q,x
c
) such that the set A ? X :=
R?R
3
?R
3
?S
3
?S
3
?X
c
, given by
A :=
n
(r,p
0
,v
0
,q
1
,q
0
,xc)?X|p
0
= v
0
= 0, q
1
=

±1 0
?

?
o
,
Section IV
Section V
?
T
ú q =
1
2
q?(?)
q
(p,v)
ú p =v
ú v =?R(q)e
3
T
m
+ge
3
+b
Fig. 1: Structure of system (2).
is globally asymptotically stable for the hybrid system given
by
ú r?F
d
(r), (5a)
ú p
0
=v
0
, (5b)
ú v
0
=?R(q
1
)R(q
0
)e
3
T
m
+ge
3
+b?p
(2)
d
, (5c)
ú q
1
=
1
2
q
1
?(R(q
0
)(???
0
)), (5d)
ú q
0
=
1
2
q
0
?(?
0
), (5e)
ú x
c
?F
c
(r,p,v,q,x
c
) (r,p,v,q,x
c
)?C
c
, (5f)
x
+
c
?G
c
(r,p,v,q,x
c
) (r,p,v,q,x
c
)?D
c
, (5g)
In Section IV, we design a controller for the position
subsystem and then, in Section V, we design a control law
for the whole system using backstepping techniques, taking
advantage of the structure of the system (5) depicted in
Figure 1.
IV. CONTROLLER DESIGN FOR THE POSITION
SUBSYSTEM
In this section, we address the problem of designing a
controller that solves Problem 1 when (T,q) are considered
as inputs. The results presented in this section are pivotal in
the design of the controller that solves Problem 1, which is
presented in Section V.
We start the controller design process by giving the
following assumption.
Assumption 2: ThereexistsalocallyLipschitzcontrollaw
u
0
: R
3
? R
3
? R
3
such that (p
0
,v
0
) = 0 is globally
asymptotically stable for the system
ú p
0
=v
0
, ú v
0
=u
0
(p
0
,v
0
). 
If Assumption 2 holds, then, by [18, Theorem 4.17], there
exists a smooth, positive deÞnite and radially unbounded
function V
0
and positive deÞnite function W
0
such that, for
each (p
0
,v
0
)?R
3
?R
3
,

?V
0
(p
0
,v
0
),

v
0
u
0
(p
0
,v
0
)

²?W
0
(p
0
,v
0
).
Notice that, in general, the control law (p
0
,v
0
)7?u
0
(p
0
,v
0
)
is not robust with respect to the unknown disturbance b. In
order to cancel out this disturbance, we redesignu
0
as a new
control law u
0
(p
0
,v
0
,z), given by
u
0
(p
0
,v
0
,z) :=u
0
(p
0
,v
0
)??
K
(z), (6)
where z ? R
3
is an integral state. Imposing bounds on the
inputs limits the perfomance of the controller, in the sense
that, there is a limit on the disturbances that it is able to
overcome. As a consequence, the controller that we devise
in this paper must also satisfy the following assumption.
6274
Assumption 3: Given K > 0, |b
i
| < K, for each i ?
{1,2,3}. 
In Lemma 1, we show that if the given assumptions are
satisÞed, then it is possible to redesign u
0
so as to achieve
global tracking of the position trajectory.
Lemma 1: For any k
z
> 0 and K > 0, if Assumptions 2
and 3 hold, then the control law (6) renders the set
A
0
:={(p
0
,v
0
,z)?R
3
?R
3
?R
3
|p
0
=v
0
= 0,z = ?
?1
K
(b)}
globally asymptotically stable for the system
ú p
0
=v
0
,
ú v
0
=u
0
(p
0
,v
0
,z)+b,
ú z =k
z
?
v0
V
0
(p
0
,v
0
).
Remark 1: Notice that u
0
(p
0
,v
0
,z)|
(p0,v0,z)?A0
= ?b,
thus the integrative state z modiÞes the control law for the
unperturbed system u
0
so as to cancel the unknown bias b.
From Lemma 1, we conclude that global asymptotic
stabilization of the set A
0
when (T,q) are used as inputs
depends on the existence of solutions to
R(q)e
3
T
m
:=?µ , (7)
where µ :=u
0
(p
0
,v
0
,z)?ge
3
+p
(2)
d
.
In the same spirit as [12], we deÞneT
0
:=mkµ k andq
0
as the solution to the optimization problem
minimize
1
2
trace
 
I
3
?R(q)R
?
d

subject to R(q)e
3
T0
m
=?µ q?S
3
(8)
which minimizes the angle ? between R(q) and R
d
. The
solution to this optimization problem is such that
R(q
0
) =
 
I
3
+S(?)+

1+e
?
3
R
?
d
µ kµ k

S

?
k?k

2
!
R
d
,
where ? := ?S(R
d
e
3
)
µ kµ k
. Notice that both q
0
and ?q
0
are solutions to this optimization problem, thus we must
resort to robust path-lifting techniques, such as the one
described in [24], in order to ensure that the sign of the
quaternion is consistently selected. Moreover, notice that
the optimization problem (8) is infeasible if kµ k = 0 or
e
?
3
R
?
d
µ/ kµ k = 1. To prevent these issues we will need
to make further assumptions on the reference trajectory and
control law.
Assumption 4: Given a reference trajectory that satisÞes
Assumption1,thefollowingholdsku
0
(p
0
,v
0
,z)+p
(2)
d
k<g,
for all (p
0
,v
0
,z)?R
3
?R
3
?R
3
and for all r? rge(F
d
).

Assumption 5: Given a reference trajectory that satisÞes
Assumption 1, the following holds: e
?
3
R
d
(t)e
3
³ 0, for all
t³ 0. 
Assumption 4 prevents the commanded thrust from be-
coming zero, i.e., the case kµ k = 0, and a combination
of Assumption 4 and Assumption 5 prevents the situation
e
?
3
R
?
d
µ/ kµ k = 1. An example of a controller that satisÞes
Assumption 4 for certain controller parameters is given
in [10, Appendix A].
Sinceweareconsideringq asaninput,settingq(t) =q
0
(t)
for all t ³ 0 guarantees that, under the given assumptions,
Problem 1 is solved. In the next section, we include the
rotation kinematics using backstepping techniques.
V. GLOBAL ASYMPTOTIC STABILIZATION OF THE
ATTITUDE KINEMATICS BY HYBRID QUATERNION
FEEDBACK
In this section, we develop a controller that solves Prob-
lem 1 when the thrust T and the angular velocity ? are
considered as inputs. To achieve this objective, we extend
the hybrid quaternion feedback strategy that was introduced
in [23] so as to deal with the presence of unknown distur-
bances and underactuation. To do so, we need to estimate
?
0
.
Notice that ?
0
can be computed from dR(q
0
)/dt =
R(q
0
)S(?
0
) using the relationship
D
t
(R(q
0
)) = vec(R(q
0
)S(?
0
)), (9)
and replacing (1) into (9), yielding D
t
(R(q
0
)) =
??(R(q
0
))R(q
0
)?
0
. Finally, it is easy to verify that
?(R(q
0
))
?
?(R(q
0
)) = 2I
3
, thus we obtain ?
0
=
?
1
2
R(q
0
)
?
?(R(q
0
))
?
D
t
(R(q
0
)).
However, ?
0
depends on the variables (r,p
0
,v
0
,z) and
their time derivatives, thus, in particular, it depends on b?
R
3
which is an unknown constant. To overcome this, we
use b
1
?R
3
which denotes the estimate of b. Also, let ?
0,1
denote the estimate of ?
0
that depends on b
1
rather than b,
i.e.,
?
0,1
:=?
1
2
R(q
0
)
?
?(R(q
0
))
?
D
t
(R(q
0
))|
b=b1
.
It is possible to verify that the difference between ?
0,1
and ?
0
is given by
?
0,1
??
0
=?
1
2
R(q
0
)
?
?(R(q
0
))
?
D
v0
(R(q
0
))
e
b
1
,
where we have used the deÞnition
e
b
1
:=b
1
?b.
Using the deÞnitionsH :={?1,1},X
c
:=R
3
?H?R
3
,
x
c
:= (z,h,
e
b
1
)?X
c
and
ú
b
1
:=
1
2
k
b1
khD
v0
(R(q
0
))
?
?(q
0
)?
1
,
the hybrid system H
1
:= (C
1
,F
1
,D
1
,G
1
) with x =
(r,p
0
,v
0
,q
1
,q
0
,z,h,
e
b
1
)?X as follows
F
1
(x) :=
?
?
?
?
?
?
?
?
?
?
?
?
F
d
(r)
v
0
?R(q
1
)R(q
0
)e
3
T
m
+ge
3
?f
ú p
d
(ú p
d
)+b
1
2
q
1
?(R(q
0
)(???
0
))
1
2
q
0
?(?
0
)
k
z
?
v0
V
0
(p
0
,v
0
)
0
1
2
k
b1
khD
v0
(R(q
0
))
?
?(q
0
)?
1
?
?
?
?
?
?
?
?
?
?
?
?
(10a)
x?C
1
:={x?X|h?
1
³??}, (10b)
G
1
(x) = (r,p
0
,v
0
,q
1
,q
0
,z,?h,
e
b
1
) (10c)
x?D
1
:={x?X|h?
1
²??}, (10d)
for some ?? (0,1), where (T,?) are given by
T :=mkµ k, (11a)
? :=?
0,1
+R(q
0
)
?
(??
?
1
?k
q
h?
1
), (11b)
6275
with ?
?
1
:=
2kzkV
0
kh
(?
1
S(µ )?S(µ )S(?
1
))?
v0
V
0
, µ given
in (7), andh?H ={?1,1} is a logic variable that enables
controller switching.
1
Theorem 1: Let Assumptions 1-4 hold. Then, for any
k
V0
,k
q
,k,k
z
,k
b1
> 0, the set
A
1
:=
n
x?X|p
0
= 0,v
0
= 0,q
1
=

h 0
?

?
o
,
is globally asymptotically stable for the hybrid system H
1
,
using the control law (11). 
At this stage it should be clear that the proposed
controller solves Problem 1 with x
c
= (z,h,
e
b
1
) and
?(r,p,v,q
1
,q
0
,x
c
) as given in (11) . Notice that the con-
troller is robust to constant forces disturbances and small
perturbations because the closed-loop hybrid system (10)
satisÞes the hybrid basic conditions (see [13] or [23]). In the
next section, we present both simulation and experimental
results.
VI. SIMULATION/EXPERIMENTAL RESULTS
To experimentally evaluate the performance of the con-
troller described in Section V, we make use of the following
components:1)BlademQXquadrotor [15],2)VICONBonita
motioncapturesystem[29],3)MATLAB/Simulinksoftware,
and4)custom-madeRFinterface.TheBlademQXquadrotor
weighs 80 g and has a radius of approximately 11 cm.
The overall control architecture is depicted in Figure 4. For
more details on the system architecture and identiÞcation,
the reader is referred to [9].
Fig. 4: Quadrotor control architecture.
Since the VICON motion capture system outputs the
rotation matrix of the vehicle we resort to the path lifting
strategy outlined in [24] so as to obtain consistent quaternion
representations of attitude.
To assess whether the hybrid controller was working as
intended, we carried out the following experiment: set the
desired position trajectory to a circular trajectory with a
radius of 1 m and an angular frequency of 20 deg/s; set the
initial yaw of the quadrotor to be approximately 180 degrees
away from the desired orientation; run the experiment for
h(0,0) = 1 and h(0,0) =?1.
In this experiment we test speciÞcally the hybrid nature
of the proposed controller since different values of the logic
variable produce different outcomes when the quadrotor is
near a rotation error of 180 degrees. The experimental results
were also compared with simulation results using the same
controller parameters, which are: k
p
= 3, k
v
= 5, k
V0
=
0.01, k
z
= 0.3, k
q
= 3, k
b1
= 1, K = 1 and ? = 0.5.
1
Recall that we are using the notation q = [? ?
?
]
?
to represent the unit
quaternion. See Section II for more details.
From the analysis of Figure 5, it is possible to verify that
thecontrollerisworkingasintended,sincethevehiclerotates
around opposite directions depending on the initial value of
thelogicvariable.Figure6depictsthetrackingerrorforeach
of the experiments/simulations. In both Þgures, it is notice-
able that the experiments have a small time delay before the
initialization of the controller. If we discard this small time
window, we argue that, even though the convergence time
in the simulations is smaller, the overall behavior is very
much alike in both simulations and experiments. Moreover,
in each experiment and simulation the disturbances were
small enough so as not to trigger any jump of the logic
variable, therefore it remains constant throughout. Figures 2
and 3 show what the rotation around opposite directions
looks like in the real-world. In these images, the direction
of rotation can be tracked by following some features of the
quadrotor, such as the white propellers.
 
 
Simulation: h(0,0) =?1
Simulation: h(0,0) = 1
Experiment: h(0,0) = 1
Experiment: h(0,0) =?1
Roll [deg]
t [s]
Pitch [deg] Yaw [deg]
0 1 2 3 4 5 6 7 8 9 10 11
?40
?20
0
20
40
?100
0
100
?40
?20
0
20
40
Fig.5:Euleranglesfortwoexperiments/simulations,roughly
with the same initial conditions but different values of the
logic variable.
 
 
Simulation: h(0,0) = 1
Simulation: h(0,0) =?1
Experiment: h(0,0) = 1
Experiment: h(0,0) =?1
kp
0
(t)k [m]
t [s]
0 1 2 3 4 5 6 7 8 9 10 11
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Fig. 6: Position error for two experiments/simulations with
initial yaw error of approximately 180
?
.
VII. CONCLUSION
In this paper, we described a controller for a class of
underactuated vechicles that globally performs the tracking
of a reference position trajectory while minimizing the
6276
(a) t=t0 (b) t=t1 >t0 (c) t=t2 >t1 (d) t=t3 >t2
Fig. 2: First few seconds of the experiment with initial condition h
0
= 1.
(a) t=t0 (b) t=t1 >t0 (c) t=t2 >t1 (d) t=t3 >t2
Fig. 3: First few seconds of the experiment with initial condition h
0
=?1.
orientation error to some desired attitude trajectory. The
class of vehicles that we consider are characterized by full
torque actuation and uni-directional thrust. This objective
was achieved by means of novel hybrid control techniques
and standard backstepping solutions. Experimental results
that demonstrate the performance of the controller and its
application to quadrotor vehicles were also provided.
REFERENCES
[1] A.P. Aguiar and J.P. Hespanha. Trajectory-tracking and path-following
of underactuated autonomous vehicles with parametric modeling un-
certainty. IEEETransactions onAutomatic Control,52(8):1362Ð1379,
Aug. 2007.
[2] J.S. Bellingham, M. Tillerson, M. Alighanbari, and J.P. How. Coop-
erative path planning for multiple UAVs in dynamic and uncertain
environments. In Proceedings of the 41st IEEE Conference on
Decision and Control, volume 3, pages 2816Ð2822 vol.3, 2002.
[3] Millard F. Betty. Principles of Engineering Mechanics, volume 1.
Plenum Press, 1986.
[4] S. P. Bhat and D. S. Bernstein. A topological obstruction to con-
tinuous global stabilization of rotational motion and the unwinding
phenomenon. Systems & Control Letters, 39(1):63 Ð 70, 2000.
[5] S.A.Bortoff. Pathplanningforuavs. InAmerican ControlConference,
volume 1, 2000.
[6] F. Bullo and R. M. Murray. Tracking for fully actuated mechanical
systems: a geometric framework. Automatica, 35(1):17 Ð 34, 1999.
[7] D. Cabecinhas, R. Cunha, and C. Silvestre. Almost global stabilization
of fully-actuated rigid bodies. Systems & Control Letters, 58(9):639
Ð 645, 2009.
[8] D. Cabecinhas, R. Cunha, and C. Silvestre. Saturated output feddback
control of a quadrotor aircraft. In American Control Conference, 2012.
[9] D. Cabecinhas, R. Cunha,and C. Silvestre. Experimental evaluation of
a globally stabilizing feedback controller for a quadrotor aircraft with
wind disturbance rejection. In American Control Conference (ACC),
2013.
[10] P. Casau, R. G. Sanfelice, R. Cunha, D. Cabecinhas, and C. Silvestre.
Global trajectory tracking for a class of underactuated vehicles. In
American Control Conference (ACC), pages 419Ð424, 2013.
[11] O.-E. Fjellstad and T.I. Fossen. Singularity-free tracking of unmanned
underwater vehicles in 6 DOF. In Proceedings of the 33rd IEEE
Conference on Decision and Control, volume 2, pages 1128 Ð1133,
Dec 1994.
[12] E. Frazzoli, M.A. Dahleh, and E. Feron. Trajectory tracking control
design for autonomous helicopters using a backstepping algorithm. In
Proceedings of the American Control Conference, volume 6, pages
4102 Ð4107, 2000.
[13] R. Goebel, R. G. Sanfelice, and A. R. Teel. Hybrid Dynamical
Systems: Modeling, Stability and Robustness. Princeton University
Press, 2012.
[14] Katrina Herrick. Development of the unmanned aerial vehicle market:
forecasts and trends. Air & Space Europe, 2(2):25 Ð 27, 2000.
[15] Horizon Hobby Inc. Blade mqx ultra micro quad-copter, 2012.
[16] M. Hua, T. Hamel, P. Morin, and C. Samson. A control approach
for thrust-propelled underactuated vehicles and its application to vtol
drones. IEEE Transactions on Automatic Control, 54(8):1837 Ð1853,
2009.
[17] R.N. Jazar. Theory of Applied Robotics: Kinematics, Dynamics, And
Control. Springer, 2007.
[18] H. K. Khalil. Nonlinear Systems. Prentice Hall, 2002.
[19] J. C. Kinsey, Ryan M. Eustice, and Louis L. Whitcomb. A survey of
underwater vehicle navigation: Recent advances and new challenges.
In IFAC Conference of Manoeuvering and Control of Marine Craft,
Lisbon, Portugal, September 2006. Invited paper.
[20] J. R. Magnus and H. Neudecker. Matrix differential calculus with
applications to simple, hadamard, and kronecker products. Journal of
Mathematical Psychology, 29(4):474 Ð 492, 1985.
[21] C. G. Mayhew and A. R. Teel. On the topological structure of
attraction basins for differential inclusions. Systems & Control Letters,
60(12):1045 Ð 1050, 2011.
[22] C.G. Mayhew, R.G. Sanfelice, and A.R. Teel. Robust global asymp-
totic stabilization of a 6-DOF rigid body by quaternion-based hybrid
feedback. In Proceedings of the 48th IEEE Conference on Decision
and Control, held jointly with the 28th Chinese Control Conference,
pages 1094 Ð1099, Dec. 2009.
[23] C.G.Mayhew,R.G.Sanfelice,andA.R.Teel. Quaternion-basedhybrid
control for robust global attitude tracking. IEEE Transactions on
Automatic Control, 56(11):2555Ð2566, 2011.
[24] C.G. Mayhew, R.G. Sanfelice, and A.R. Teel. On path-lifting mech-
anisms and unwinding in quaternion-based attitude control. IEEE
Transactions on Automatic Control, 58(5):1179Ð1191, 2013.
[25] D. Mellinger and V. Kumar. Minimum snap trajectory generation and
control for quadrotors. In IEEE International Conference on Robotics
and Automation (ICRA), pages 2520Ð2525, May.
[26] G.D. PadÞeld. Helicopter Flight Dynamics: The Theory and Ap-
plication of Flying Qualities and Simulation Modelling. Blackwell
Publishing, 2007.
[27] A.K. Sanyal and Monique Chyba. Robust feedback tracking of au-
tonomous underwater vehicles with disturbance rejection. In American
Control Conference, pages 3585Ð3590, 2009.
[28] C. Silvestre, P. Oliveira, A. Pascoal, D. Fryxell, and I. Kaminer.
Design and implementation of a trajectory tracking controller for
an autonomous underwater vehicle (auv). In American Control
Conference, Proceedings of the 1995, volume 5, pages 2975Ð2979
vol.5, Jun.
[29] VICON. Motion capture systems from vicon, 2012.
[30] J. R. Wertz. Spacecraft Attitude Determination and Control. Kluwer
Academic Publishers, 1978.
[31] Rong Xu and U. Ozguner. Sliding mode control of a quadrotor
helicopter. In 45th IEEE Conference on Decision and Control, pages
4957Ð4962, Dec 2006.
6277
